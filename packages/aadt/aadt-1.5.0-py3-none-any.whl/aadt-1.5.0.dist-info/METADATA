Metadata-Version: 2.3
Name: aadt
Version: 1.5.0
Summary: Anki Addon Dev ToolKit
Keywords: anki,development,build-tools
Author: Libukai
License: AGPL-3.0-or-later
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: Topic :: Software Development :: Build Tools
Classifier: License :: OSI Approved :: GNU Affero General Public License v3
Classifier: Programming Language :: Python :: 3.13
Classifier: Operating System :: POSIX
Classifier: Operating System :: MacOS
Requires-Dist: jsonschema>=4.4.0
Requires-Dist: whichcraft>=0.6.1
Requires-Dist: questionary>=2.1.0
Requires-Python: >=3.13
Project-URL: Homepage, https://github.com/libukai/Anki-Addon-Dev-ToolKit
Project-URL: Repository, https://github.com/libukai/Anki-Addon-Dev-ToolKit
Description-Content-Type: text/markdown

# Anki Add-on Dev ToolKit (AADT)

<a title="License: GNU AGPLv3" href="https://github.com/glutanimate/anki-addon-builder/blob/master/LICENSE"><img src="https://img.shields.io/badge/license-GNU AGPLv3-green.svg"></a>
<a href="https://pypi.org/project/aadt/"><img src="https://img.shields.io/pypi/v/aadt.svg"></a>
<img src="https://img.shields.io/pypi/status/aadt.svg">

**Modern, AI-driven, focused on Anki new versions (2025.06+) add-on development and build toolkit with complete type safety and modern Python practices.**

English | [ä¸­æ–‡](#ä¸­æ–‡ç‰ˆ)

## ğŸš€ Features

- **Python 3.13** Compatible with Anki 2025.06+
- **Qt6 Exclusive Support** Adapted for Anki 2025.06+ versions
- **Elegant Dependency Management** Fully based on uv for environment and dependency management
- **Code Quality Tools** Integrated ruff and ty for code quality enhancement
- **Comprehensive CLI Commands** Covering the entire workflow from initialization to release
- **Convenient Build and Distribution** Support for AnkiWeb and local distribution

## ğŸ“‹ Table of Contents

- [Prerequisites](#prerequisites)
- [Quick Start](#quick-start)
- [Command Details](#command-details)
- [CI/CD Support](#cicd-support)
- [UI Development](#ui-development)
- [Code Quality](#code-quality)
- [Unit Testing](#unit-testing)
- [Git Integration](#git-integration)
- [License](#license)

## ğŸ”§ Prerequisites

Install uv locally via `curl -LsSf https://astral.sh/uv/install.sh | sh`.

## âš¡ Quick Start

### 1. Initialize Add-on Project

Use `uvx` to run the latest version of the `init` command to quickly initialize your project:

```bash
# Create directory
mkdir my-addon
cd my-addon

# Interactive setup
uvx aadt init
```

The default initialization creates a basic but complete add-on project, including:

- Interactive collection of add-on information
- Application of template files and generation of project structure
- Development environment configuration and dependency installation via uv
- Git repository creation and initialization

After initialization, the project directory structure is as follows:

```
my_addon/
â”œâ”€â”€ addon.json          # Add-on configuration file
â”œâ”€â”€ src/                # Source code
â”‚   â””â”€â”€ my_addon/       # Main module
â”‚       â””â”€â”€ __init__.py # Main module initialization file
â”œâ”€â”€ ui/                 # UI design
â”‚   â”œâ”€â”€ designer/       # Qt Designer .ui files
â”‚   â””â”€â”€ resources/      # UI resources (icons, styles)
â”œâ”€â”€ README.md           # Project documentation
â”œâ”€â”€ ANKI.md             # Anki core library documentation
â”œâ”€â”€ pyproject.toml      # Project configuration
â”œâ”€â”€ uv.lock             # uv lock file
â”œâ”€â”€ .python-version     # Specify Python version
â”œâ”€â”€ .git/               # Git repository
â””â”€â”€ .gitignore          # Ignore files
```

**ğŸ’¡ Tip**: After initialization, it's recommended to immediately run `uv run aadt claude` to generate the AI assistant memory file, which will provide complete modern Anki development guidance and help Claude AI better assist your add-on development work.

### 2. Development

To improve Add-on development efficiency, it's strongly recommended to use AI-assisted programming during development. AADT provides the `claude` command to generate specialized Claude Code guidance files:

```bash
# Generate CLAUDE.md file
aadt claude
```

This command will generate a CLAUDE.md file in the root directory based on your project configuration, including core guidance for Anki 25.06+ Add-on development, helping Claude AI better understand your project and provide precise development suggestions.

Additionally, there's an ANKI.md file in the root directory containing detailed documentation of modern Anki 25.06+ source code analysis and best practices, helping human programmers better understand Anki's overall architecture and development approach.

### 3. Testing

For convenient testing in the development environment, AADT provides the `test` command for testing add-ons in Anki.

```bash
aadt test
```

Running the `test` command will first create a soft link from the `src/` directory's project folder to Anki's add-on directory, then automatically start Anki and load the add-on.

AADT also provides the `link` command to manage operations for soft linking the project source code folder to Anki's add-on directory.

```bash
# Create soft link
aadt link

# Remove soft link
aadt link --unlink
```

### 4. Build

AADT provides the `build` command for building add-ons.

```bash
aadt build
```

The build command depends on a git repository and will by default find the latest git tag and build the corresponding commit version, making it easy to distinguish between test versions and official versions.

The generated add-on package is stored in the `dist` directory and can be used for direct installation or upload to AnkiWeb for distribution.

## ğŸ”§ Command Details

### `init` - Initialize Add-on Project
```bash
# Initialize in current directory (interactive)
aadt init

# Initialize in specified directory
aadt init my-addon

# Use default values (non-interactive)
aadt init -y
```

**Features:**
- Interactive collection of add-on information (name, author, description, etc.)
- Generate complete project structure and apply template files
- Configure Python environment and dependency management using uv
- Initialize Git repository

### `ui` - Compile User Interface
```bash
# Compile all UI files
aadt ui
```

**Features:**
- Compile `.ui` files from `ui/designer/` to `src/module_name/gui/forms/qt6/`
- Automatically copy resource files from `ui/resources/` to `src/module_name/gui/resources/`
- Auto-generate `__init__.py` for resources package to support importlib.resources
- Support for icons, stylesheets, and various resource files

### `test` - Launch Testing
```bash
# Link add-on and start Anki testing
aadt test
```

**Features:**
- Automatically execute `aadt link` to create soft links
- Start Anki program to load add-on
- One-click testing workflow

### `link` - Development Environment Linking
```bash
# Create soft link to Anki add-on directory
aadt link

# Remove soft link
aadt link --unlink
```

**Features:**
- Soft link the add-on project folder under `src/` to Anki's add-on directory
- Convenient for launching Anki instances for real-time testing during development

### `claude` - Generate Claude AI Assistant Memory File
```bash
# Generate CLAUDE.md file
aadt claude

# Force overwrite existing file
aadt claude --force
```

**Features:**
- Automatically generate `CLAUDE.md` file based on project `addon.json` configuration
- Includes modern Anki 25.06+ development best practices and guidance
- Prevents accidental overwriting of existing CLAUDE.md files, supports `--force` for forced overwriting

### `build` - Build and Package Add-on
```bash
# Build latest tag version (default)
aadt build

# Build specific version
aadt build v1.2.0        # Specific git tag
aadt build dev           # Working directory (including uncommitted changes)
aadt build current       # Latest commit
aadt build release       # Latest tag (default)

# Specify distribution type
aadt build -d local      # Local development version
aadt build -d ankiweb    # AnkiWeb submission version
aadt build -d all        # Build both types simultaneously

# Combined usage
aadt build v1.2.0 -d local
```

**Distribution Type Description:**
- `local`: Suitable for local development, retains debug information
- `ankiweb`: Suitable for AnkiWeb submission, optimized file size
- `all`: Generate both versions simultaneously

**Features:**
- Generate `manifest.json` required by AnkiWeb based on `addon.json` configuration
- Include add-on metadata, dependencies, and other information

### `manifest` - Generate Manifest File
```bash
# Generate manifest.json
aadt manifest
```

### `clean` - Clean Build Files
```bash
# Clean all build artifacts
aadt clean
```

**Features:**
- Delete `dist/` directory and its contents
- Clean temporary files and cache

## ğŸš€ CI/CD Support

These commands provide finer build control, suitable for automated build pipelines:

### `create_dist` - Prepare Source Code Tree
```bash
aadt create_dist [version]
```

**Features:**
- Prepare source code tree to `dist/build` directory
- Handle version control and file archiving
- Prepare for subsequent build steps

#### `build_dist` - Build Source Code
```bash
aadt build_dist
```

**Features:**
- Process source code in `dist/build`
- Compile UI files, generate manifest files
- Execute all necessary code post-processing

#### `package_dist` - Package Distribution
```bash
aadt package_dist
```

**Features:**
- Package built files into `.ankiaddon` format
- Generate final distribution package

## ğŸ¨ UI Development

### Using Qt Designer

AADT provides seamless integration for Qt Designer UI development with **intelligent PyQt6 to aqt.qt conversion** functionality:

1. **Design UI**: Create `.ui` files in `ui/designer/`
2. **Add Resources**: Place images and icons in `ui/resources/`
3. **Reference Resources**: Reference files in `ui/resources/` in Qt Designer
4. **Build UI**: Run `aadt ui` to automatically compile and copy resources

```bash
# Your project structure
my-addon/
â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ designer/
â”‚   â”‚   â””â”€â”€ dialog.ui          # References ../resources/icon.png
â”‚   â””â”€â”€ resources/
â”‚       â””â”€â”€ icon.png           # Your resource file
â””â”€â”€ src/my_addon/

# After running 'aadt ui'
my-addon/
â”œâ”€â”€ src/my_addon/
â”‚   â”œâ”€â”€ gui/forms/qt6/
â”‚   â”‚   â””â”€â”€ dialog.py          # Compiled UI, using aqt.qt imports
â”‚   â””â”€â”€ gui/resources/
â”‚       â”œâ”€â”€ __init__.py        # Auto-generated, supports importlib.resources
â”‚       â””â”€â”€ icon.png           # Automatically copied resource
```

### ğŸ§  Intelligent PyQt6 to aqt.qt Conversion

During the conversion process, AADT automatically converts pyuic6 output to Anki-compatible format and provides precise type annotations:

**Original Conversion (pyuic6 output):**
```python
from PyQt6 import QtCore, QtGui, QtWidgets

class Ui_Dialog(object):
    def setupUi(self, Dialog):
        Dialog.setObjectName("Dialog")
        self.verticalLayout = QtWidgets.QVBoxLayout(Dialog)
        self.label = QtWidgets.QLabel(Dialog)
        # ...
```

**Specialized Conversion (AADT intelligent conversion):**
```python
from aqt.qt import QDialog, QVBoxLayout, QLabel, QMetaObject

class Ui_Dialog(object):
    def setupUi(self, Dialog: QDialog) -> None:
        Dialog.setObjectName("Dialog")
        self.verticalLayout = QVBoxLayout(Dialog)
        self.label = QLabel(Dialog)
        # ...
```

### ğŸ¯ Intelligent Type Inference

AADT analyzes your UI files and provides **precise type annotations** based on aqt.qt's actual type system:

- **`Ui_Dialog`** â†’ `QDialog` type annotation
- **`Ui_MainWindow`** â†’ `QMainWindow` type annotation
- **`Ui_CustomWidget`** â†’ `QWidget` type annotation
- **`Ui_SettingsFrame`** â†’ `QFrame` type annotation

### **Main Advantages:**
- âœ… **Anki Compatible Imports**: Use `from aqt.qt import ...` instead of `from PyQt6 import ...`
- âœ… **Intelligent Type Inference**: Automatically determine correct Qt widget types
- âœ… **Type Safe**: Generated code passes strict type checking
- âœ… **Minimized Imports**: Only import classes actually used in UI files
- âœ… **Automatic Resource Copying**: Resource files automatically copied to final package
- âœ… **Clean References**: No need for complex QRC compilation
- âœ… **Direct File Paths**: Use standard file paths in Python code
- âœ… **Development Friendly**: Resources immediately available for testing

## Code Quality

AADT includes modern development tools, strongly recommended for use during development to improve code quality and type safety, providing complete type annotations:

```bash
# Use ruff for code checking
uv run ruff check src/aadt/
uv run ruff format src/aadt/

# Use ty for type checking  
uv run ty check src/aadt/

# Run all checks
uv run ruff check src/aadt/ && uv run ty check src/aadt/
```

## Unit Testing

```bash
# Run tests
pytest

# Include coverage
pytest --cov=aadt
```

## ğŸš€ Git Integration

AADT is designed to work best in Git repositories, but **Git is not required**:

### When Git is Available (Recommended)
- **Version Detection**: Use Git tags and commits for version control
- **Source Archiving**: Use `git archive` for clean source extraction
- **Modification Time**: Use Git commit timestamps

### Non-Git Environment (Fallback Mode)
- **Version Detection**: Read from `pyproject.toml`, `VERSION` files, or generate timestamp-based versions
- **Source Archiving**: Copy current directory with intelligent exclusion (`.git`, `__pycache__`, etc.)
- **Modification Time**: Use current timestamp

### Usage Examples

```bash
# In Git repository (auto-detection)
aadt build -d local

# In non-Git directory (auto-fallback)
aadt build -d local  # Still works!

# Explicit version specification (works anywhere)
aadt build v1.2.0 -d local
```

The tool automatically detects your environment and chooses the appropriate method.

## ğŸ“š Examples

Check the `tests/` directory for example configurations and usage patterns.

## ğŸ¯ Design Philosophy

AADT follows these principles:

1. **Modern Python First**: Use latest language features (3.12+)
2. **Type Safety**: Complete type annotations and type checking validation
3. **Qt6 Focus**: No legacy Qt5 baggage, designed for current Anki
4. **Fast Build**: uv-based dependency management
5. **Developer Experience**: Clear CLI, good error messages, useful validation

## ğŸ“„ License

This project is licensed under the GNU AGPLv3 License. See the [LICENSE](LICENSE) file for details.

---

**Built with â¤ï¸ for the Anki Community**

> This project is inspired by the [aab](https://github.com/glutanimate/anki-addon-builder) project, focusing on providing the best development experience for new version Anki add-on developers who are about to officially launch.

---

# ä¸­æ–‡ç‰ˆ

**ç°ä»£åŒ–çš„ã€AI é©±åŠ¨çš„ã€ä¸“æ³¨äº Anki æ–°ç‰ˆæœ¬ï¼ˆ2025.06+ï¼‰çš„æ’ä»¶å¼€å‘å’Œæ„å»ºå·¥å…·åŒ…ï¼Œå…·å¤‡å®Œæ•´ç±»å‹å®‰å…¨å’Œç°ä»£ Python å®è·µã€‚**

[English](#anki-add-on-dev-toolkit-aadt) | ä¸­æ–‡

## ğŸš€ ç‰¹æ€§

- **Python 3.13** ä¸ Anki 2025.06+ ä¿æŒä¸€è‡´
- **Qt6 ä¸“ç”¨æ”¯æŒ** é€‚é… Anki 2025.06+ ç‰ˆæœ¬  
- **ä¼˜é›…ä¾èµ–ç®¡ç†** å®Œå…¨åŸºäº uv ç®¡ç†ç¯å¢ƒå’Œä¾èµ–
- **ä»£ç è´¨é‡å·¥å…·** é›†æˆ ruff å’Œ ty æå‡ä»£ç è´¨é‡
- **å…¨é¢çš„ CLI å‘½ä»¤** è¦†ç›–ä»åˆå§‹åŒ–åˆ°å‘å¸ƒçš„å…¨æµç¨‹
- **ä¾¿æ·æ„å»ºå’Œåˆ†å‘** æ”¯æŒ AnkiWeb å’Œæœ¬åœ°åˆ†å‘

## ğŸ“‹ ç›®å½•

- [å‰ç½®è¦æ±‚](#å‰ç½®è¦æ±‚)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [å‘½ä»¤è¯¦è§£](#å‘½ä»¤è¯¦è§£)
- [CI/CDæ”¯æŒ](#CI/CDæ”¯æŒ)
- [UIå¼€å‘](#UIå¼€å‘)
- [ä»£ç è´¨é‡](#ä»£ç è´¨é‡)
- [å•å…ƒæµ‹è¯•](#å•å…ƒæµ‹è¯•)
- [Git é›†æˆ](#Gité›†æˆ)
- [æ›´æ–°æ—¥å¿—](#æ›´æ–°æ—¥å¿—)
- [åè®®](#åè®®)

## ğŸ”§ å‰ç½®è¦æ±‚

é€šè¿‡ `curl -LsSf https://astral.sh/uv/install.sh | sh` åœ¨æœ¬åœ°å®‰è£… uvã€‚

## âš¡ å¿«é€Ÿå¼€å§‹

### 1. åˆå§‹åŒ–æ’ä»¶é¡¹ç›®

ä½¿ç”¨ `uvx` æ–¹å¼ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬è¿è¡Œ `init` å‘½ä»¤å¿«é€Ÿåˆå§‹åŒ–é¡¹ç›®ï¼š

```bash
# åˆ›å»ºç›®å½•
mkdir my-addon
cd my-addon

# äº¤äº’å¼è®¾ç½®
uvx aadt init
```

é»˜è®¤çš„åˆå§‹åŒ–ä¼šåˆ›å»ºä¸€ä¸ªåŸºç¡€ä½†å®Œæ•´çš„æ’ä»¶é¡¹ç›®ï¼ŒåŒ…æ‹¬ï¼š

- é€šè¿‡äº¤äº’æ–¹å¼æœé›†æ’ä»¶ä¿¡æ¯
- åº”ç”¨æ¨¡æ¿æ–‡ä»¶ï¼Œç”Ÿæˆé¡¹ç›®ç»“æ„
- é€šè¿‡ uv é…ç½®å¼€å‘ç¯å¢ƒå¹¶å®‰è£…ä¾èµ–
- åˆ›å»º git ä»“åº“å¹¶åˆå§‹åŒ–

åˆå§‹åŒ–å®Œæˆä¹‹åï¼Œé¡¹ç›®çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

```
my_addon/
â”œâ”€â”€ addon.json          # Addon é…ç½®æ–‡ä»¶
â”œâ”€â”€ src/                # æºä»£ç 
â”‚   â””â”€â”€ my_addon/       # ä¸»æ¨¡å—
â”‚       â””â”€â”€ __init__.py # ä¸»æ¨¡å—åˆå§‹åŒ–æ–‡ä»¶
â”œâ”€â”€ ui/                 # UI è®¾è®¡
â”‚   â”œâ”€â”€ designer/       # Qt Designer .ui æ–‡ä»¶
â”‚   â””â”€â”€ resources/      # UI èµ„æºï¼ˆå›¾æ ‡ã€æ ·å¼ï¼‰
â”œâ”€â”€ README.md           # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ ANKI.md             # Anki æ ¸å¿ƒåº“è¯¦è§£
â”œâ”€â”€ pyproject.toml      # é¡¹ç›®é…ç½®
â”œâ”€â”€ uv.lock             # uv é”å®šæ–‡ä»¶
â”œâ”€â”€ .python-version     # æŒ‡å®šPythonç‰ˆæœ¬
â”œâ”€â”€ .git/               # Gitä»“åº“
â””â”€â”€ .gitignore          # å¿½ç•¥æ–‡ä»¶

```

### 2. å¼€å‘

ä¸ºæå‡ Addon å¼€å‘æ•ˆç‡ï¼Œå¼ºçƒˆå»ºè®®åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨ AI è¾…åŠ©ç¼–ç¨‹ã€‚AADT æä¾›äº† `claude` å‘½ä»¤æ¥ç”Ÿæˆä¸“é—¨çš„ Claude Code æŒ‡å¼•æ–‡ä»¶ï¼š

```bash
# ç”Ÿæˆ CLAUDE.md æ–‡ä»¶
aadt claude
```

è¿™ä¸ªå‘½ä»¤ä¼šæ ¹æ®ä½ çš„é¡¹ç›®é…ç½®ï¼Œåœ¨æ ¹ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª CLAUDE.md æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬äº† Anki 25.06+ Addon å¼€å‘çš„æ ¸å¿ƒæŒ‡å¼•ï¼Œèƒ½å¸®åŠ© Claude AI æ›´å¥½åœ°ç†è§£ä½ çš„é¡¹ç›®å¹¶æä¾›ç²¾å‡†çš„å¼€å‘å»ºè®®ã€‚

æ­¤å¤–ï¼Œè¿˜ä¼šåœ¨æ ¹ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª ANKI.md æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ç°ä»£ Anki 25.06+ çš„æºä»£ç è¯¦ç»†åˆ†æå’Œæœ€ä½³å®è·µçš„è¯¦ç»†æ–‡æ¡£ï¼Œå¸®åŠ© AI å’Œäººç±»ç¨‹åºå‘˜æ›´å¥½åœ°ç†è§£ Anki çš„æ•´ä½“æ¶æ„å’Œå¼€å‘æ–¹å¼ã€‚

### 3. æµ‹è¯•

ä¸ºäº†æ–¹ä¾¿å¼€å‘ç¯å¢ƒä¸‹çš„æµ‹è¯•ï¼ŒAADT æä¾›äº† `test` å‘½ä»¤ï¼Œç”¨äºåœ¨ Anki ä¸­è¿›è¡Œæ’ä»¶çš„æµ‹è¯•ã€‚

```bash
aadt test
```

è¿è¡Œ `test` å‘½ä»¤ä¼šå…ˆå°† `src/` ç›®å½•ä¸‹çš„é¡¹ç›®æ–‡ä»¶å¤¹è½¯é“¾æ¥åˆ° Anki çš„æ’ä»¶ç›®å½•ï¼Œç„¶åè‡ªåŠ¨å¯åŠ¨ Anki å¹¶åŠ è½½æ’ä»¶ã€‚

åŒæ—¶ï¼ŒAADT è¿˜æä¾›äº† `link` å‘½ä»¤ï¼Œç”¨äºæ‰‹åŠ¨ç®¡ç†é¡¹ç›®æºä»£ç æ–‡ä»¶å¤¹è½¯é“¾æ¥åˆ° Anki æ’ä»¶ç›®å½•çš„æ“ä½œã€‚

```bash
# åˆ›å»ºè½¯é“¾æ¥
aadt link

# åˆ é™¤è½¯é“¾æ¥
aadt link --unlink
```

### 4. æ„å»º

AADT æä¾›äº† `build` å‘½ä»¤ï¼Œç”¨äºæ„å»ºæ’ä»¶ã€‚

```bash
aadt build
```

æ„å»ºå‘½ä»¤ä¾èµ–äº git ä»“åº“ï¼Œé»˜è®¤ä¼šæŸ¥æ‰¾æœ€æ–°çš„ git tag å¹¶æ„å»ºå¯¹åº”çš„ commit ç‰ˆæœ¬ï¼Œä¾¿äºå°†æµ‹è¯•ç‰ˆæœ¬å’Œæ­£å¼ç‰ˆæœ¬åŒºåˆ†ã€‚

ç”Ÿæˆçš„æ’ä»¶åŒ…ä¼šå­˜å‚¨åœ¨ `dist` ç›®å½•ä¸‹ï¼Œå¯ä»¥ç”¨äºç›´æ¥å®‰è£…æˆ–è€…ä¸Šä¼ åˆ° AnkiWeb è¿›è¡Œåˆ†å‘ã€‚

## ğŸ”§ å‘½ä»¤è¯¦è§£

### `init` - åˆå§‹åŒ–æ’ä»¶é¡¹ç›®
```bash
# åœ¨å½“å‰ç›®å½•åˆå§‹åŒ–ï¼ˆäº¤äº’å¼ï¼‰
aadt init

# åœ¨æŒ‡å®šç›®å½•åˆå§‹åŒ–
aadt init my-addon

# ä½¿ç”¨é»˜è®¤å€¼ï¼ˆéäº¤äº’å¼ï¼‰
aadt init -y
```

**åŠŸèƒ½ï¼š**
- äº¤äº’å¼æ”¶é›†æ’ä»¶ä¿¡æ¯ï¼ˆåç§°ã€ä½œè€…ã€æè¿°ç­‰ï¼‰
- ç”Ÿæˆå®Œæ•´çš„é¡¹ç›®ç»“æ„å’Œåº”ç”¨æ¨¡æ¿ç”Ÿæˆæ–‡ä»¶
- ä½¿ç”¨ uvé…ç½® Python ç¯å¢ƒå’Œä¾èµ–ç®¡ç†
- åˆå§‹åŒ– Git ä»“åº“

### `ui` - ç¼–è¯‘ç”¨æˆ·ç•Œé¢
```bash
# ç¼–è¯‘æ‰€æœ‰ UI æ–‡ä»¶
aadt ui
```

**åŠŸèƒ½ï¼š**
- ç¼–è¯‘ `ui/designer/` ä¸­çš„ `.ui` æ–‡ä»¶åˆ° `src/æ¨¡å—å/gui/forms/qt6/`
- å¤åˆ¶ `ui/resources/` ä¸­çš„èµ„æºæ–‡ä»¶åˆ° `src/æ¨¡å—å/gui/resources/`ï¼Œå¹¶è¿›è¡Œè·¯å¾„åˆå§‹åŒ–
- æ”¯æŒå›¾æ ‡ã€æ ·å¼è¡¨ç­‰å„ç§èµ„æºæ–‡ä»¶

### `test` - å¯åŠ¨æµ‹è¯•
```bash
# é“¾æ¥æ’ä»¶å¹¶å¯åŠ¨ Anki æµ‹è¯•
aadt test
```

**åŠŸèƒ½ï¼š**
- è‡ªåŠ¨æ‰§è¡Œ `aadt link` åˆ›å»ºè½¯é“¾æ¥
- å¯åŠ¨ Anki ç¨‹åºåŠ è½½æ’ä»¶
- ä¸€é”®æµ‹è¯•å·¥ä½œæµ

### `link` - å¼€å‘ç¯å¢ƒé“¾æ¥
```bash
# åˆ›å»ºè½¯é“¾æ¥åˆ° Anki æ’ä»¶ç›®å½•
aadt link

# åˆ é™¤è½¯é“¾æ¥
aadt link --unlink
```

**åŠŸèƒ½ï¼š**
- å°† `src/` ä¸‹çš„æ’ä»¶é¡¹ç›®æ–‡ä»¶å¤¹è½¯é“¾æ¥åˆ° Anki æ’ä»¶ç›®å½•
- æ–¹ä¾¿å¼€å‘æœŸé—´å¯åŠ¨ Anki å®ä¾‹è¿›è¡Œå®æ—¶æµ‹è¯•

### `claude` - ç”Ÿæˆ Claude AI åŠ©æ‰‹è®°å¿†æ–‡ä»¶
```bash
# ç”Ÿæˆ CLAUDE.md æ–‡ä»¶
aadt claude

# å¼ºåˆ¶è¦†ç›–ç°æœ‰ CLAUDE.md æ–‡ä»¶
aadt claude --force
```

**åŠŸèƒ½ï¼š**
- æ ¹æ®é¡¹ç›® `addon.json` é…ç½®è‡ªåŠ¨ç”Ÿæˆ `CLAUDE.md` æ–‡ä»¶
- åŒ…å«ç°ä»£ Anki 25.06+ å¼€å‘æœ€ä½³å®è·µå’ŒæŒ‡å¯¼
- é˜²æ­¢æ„å¤–è¦†ç›–ç°æœ‰æ–‡ä»¶ï¼Œæ”¯æŒ `--force` å¼ºåˆ¶è¦†ç›–

### `build` - æ„å»ºå’Œæ‰“åŒ…æ’ä»¶
```bash
# æ„å»ºæœ€æ–°æ ‡ç­¾ç‰ˆæœ¬ï¼ˆé»˜è®¤ï¼‰
aadt build

# æ„å»ºç‰¹å®šç‰ˆæœ¬
aadt build v1.2.0        # ç‰¹å®š git æ ‡ç­¾
aadt build dev           # å·¥ä½œç›®å½•ï¼ˆåŒ…å«æœªæäº¤æ›´æ”¹ï¼‰
aadt build current       # æœ€æ–°æäº¤
aadt build release       # æœ€æ–°æ ‡ç­¾ï¼ˆé»˜è®¤ï¼‰

# æŒ‡å®šåˆ†å‘ç±»å‹
aadt build -d local      # æœ¬åœ°å¼€å‘ç‰ˆæœ¬
aadt build -d ankiweb    # AnkiWeb æäº¤ç‰ˆæœ¬
aadt build -d all        # åŒæ—¶æ„å»ºä¸¤ç§ç±»å‹

# ç»„åˆä½¿ç”¨
aadt build v1.2.0 -d local
```

**åˆ†å‘ç±»å‹è¯´æ˜ï¼š**
- `local`: é€‚ç”¨äºæœ¬åœ°å¼€å‘ï¼Œä¿ç•™è°ƒè¯•ä¿¡æ¯
- `ankiweb`: é€‚ç”¨äº AnkiWeb æäº¤ï¼Œä¼˜åŒ–æ–‡ä»¶å¤§å°
- `all`: åŒæ—¶ç”Ÿæˆä¸¤ç§ç‰ˆæœ¬

**åŠŸèƒ½ï¼š**
- æ ¹æ® `addon.json` é…ç½®ç”Ÿæˆ AnkiWeb æ‰€éœ€çš„ `manifest.json`
- åŒ…å«æ’ä»¶å…ƒæ•°æ®ã€ä¾èµ–å…³ç³»ç­‰ä¿¡æ¯

### `manifest` - ç”Ÿæˆæ¸…å•æ–‡ä»¶
```bash
# ç”Ÿæˆ manifest.json
aadt manifest
```

### `clean` - æ¸…ç†æ„å»ºæ–‡ä»¶
```bash
# æ¸…ç†æ‰€æœ‰æ„å»ºäº§ç‰©
aadt clean
```

**åŠŸèƒ½ï¼š**
- åˆ é™¤ `dist/` ç›®å½•åŠå…¶å†…å®¹
- æ¸…ç†ä¸´æ—¶æ–‡ä»¶å’Œç¼“å­˜

## ğŸš€ CI/CD æ”¯æŒ

è¿™äº›å‘½ä»¤æä¾›æ›´ç²¾ç»†çš„æ„å»ºæ§åˆ¶ï¼Œé€‚ç”¨äºè‡ªåŠ¨åŒ–æ„å»ºæµæ°´çº¿ï¼š

### `create_dist` - å‡†å¤‡æºä»£ç æ ‘
```bash
aadt create_dist [version]
```

**åŠŸèƒ½ï¼š**
- å‡†å¤‡æºä»£ç æ ‘åˆ° `dist/build` ç›®å½•
- å¤„ç†ç‰ˆæœ¬æ§åˆ¶å’Œæ–‡ä»¶å½’æ¡£
- ä¸ºåç»­æ„å»ºæ­¥éª¤åšå‡†å¤‡

#### `build_dist` - æ„å»ºæºä»£ç 
```bash
aadt build_dist
```

**åŠŸèƒ½ï¼š**
- å¤„ç† `dist/build` ä¸­çš„æºä»£ç 
- ç¼–è¯‘ UI æ–‡ä»¶ï¼Œç”Ÿæˆæ¸…å•æ–‡ä»¶
- æ‰§è¡Œæ‰€æœ‰å¿…è¦çš„ä»£ç åå¤„ç†

#### `package_dist` - æ‰“åŒ…åˆ†å‘
```bash
aadt package_dist
```

**åŠŸèƒ½ï¼š**
- å°†æ„å»ºå¥½çš„æ–‡ä»¶æ‰“åŒ…æˆ `.ankiaddon` æ ¼å¼
- ç”Ÿæˆæœ€ç»ˆçš„åˆ†å‘åŒ…

## ğŸ¨ UI å¼€å‘

### ä½¿ç”¨ Qt Designer

AADT ä¸º Qt Designer UI å¼€å‘æä¾›æ— ç¼é›†æˆï¼Œå…·å¤‡**æ™ºèƒ½ PyQt6 åˆ° aqt.qt è½¬æ¢**åŠŸèƒ½ï¼š

1. **è®¾è®¡UI**: åœ¨ `ui/designer/` ä¸­åˆ›å»º `.ui` æ–‡ä»¶
2. **æ·»åŠ èµ„æº**: å°†å›¾ç‰‡ã€å›¾æ ‡æ”¾åœ¨ `ui/resources/` ä¸­
3. **å¼•ç”¨èµ„æº**: åœ¨ Qt Designer ä¸­å¼•ç”¨ `ui/resources/` ä¸­çš„æ–‡ä»¶
4. **æ„å»ºUI**: è¿è¡Œ `aadt ui` è‡ªåŠ¨ç¼–è¯‘å¹¶å¤åˆ¶èµ„æº

```bash
# ä½ çš„é¡¹ç›®ç»“æ„
my-addon/
â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ designer/
â”‚   â”‚   â””â”€â”€ dialog.ui          # å¼•ç”¨ ../resources/icon.png
â”‚   â””â”€â”€ resources/
â”‚       â””â”€â”€ icon.png           # ä½ çš„èµ„æºæ–‡ä»¶
â””â”€â”€ src/my_addon/

# è¿è¡Œ 'aadt ui' å
my-addon/
â”œâ”€â”€ src/my_addon/
â”‚   â”œâ”€â”€ gui/forms/qt6/
â”‚   â”‚   â””â”€â”€ dialog.py          # ç¼–è¯‘åçš„UIï¼Œä½¿ç”¨aqt.qtå¯¼å…¥
â”‚   â””â”€â”€ gui/resources/
â”‚       â”œâ”€â”€ __init__.py        # è‡ªåŠ¨ç”Ÿæˆï¼Œæ”¯æŒimportlib.resources
â”‚       â””â”€â”€ icon.png           # è‡ªåŠ¨å¤åˆ¶çš„èµ„æº
```

### ğŸ§  æ™ºèƒ½ PyQt6 åˆ° aqt.qt è½¬æ¢

åœ¨è½¬åŒ–çš„è¿‡ç¨‹ä¸­ï¼ŒAADT ä½¿ç”¨ pyuic6 å°† ui æ–‡ä»¶è¾“å‡ºè½¬æ¢ä¸º Anki å…¼å®¹æ ¼å¼ï¼Œå¹¶æä¾›ç²¾ç¡®çš„ç±»å‹æ³¨è§£ï¼š

**åŸå§‹è½¬åŒ– (pyuic6 è¾“å‡º):**
```python
from PyQt6 import QtCore, QtGui, QtWidgets

class Ui_Dialog(object):
    def setupUi(self, Dialog):
        Dialog.setObjectName("Dialog")
        self.verticalLayout = QtWidgets.QVBoxLayout(Dialog)
        self.label = QtWidgets.QLabel(Dialog)
        # ...
```

**ä¸“ç”¨è½¬åŒ– (AADT æ™ºèƒ½è½¬æ¢):**
```python
from aqt.qt import QDialog, QVBoxLayout, QLabel, QMetaObject

class Ui_Dialog(object):
    def setupUi(self, Dialog: QDialog) -> None:
        Dialog.setObjectName("Dialog")
        self.verticalLayout = QVBoxLayout(Dialog)
        self.label = QLabel(Dialog)
        # ...
```

### ğŸ¯ æ™ºèƒ½ç±»å‹æ¨æ–­

AADT åˆ†æä½ çš„ UI æ–‡ä»¶ï¼ŒåŸºäº aqt.qt çš„å®é™…ç±»å‹ç³»ç»Ÿæä¾›**ç²¾ç¡®çš„ç±»å‹æ³¨è§£**ï¼š

- **`Ui_Dialog`** â†’ `QDialog` ç±»å‹æ³¨è§£
- **`Ui_MainWindow`** â†’ `QMainWindow` ç±»å‹æ³¨è§£  
- **`Ui_CustomWidget`** â†’ `QWidget` ç±»å‹æ³¨è§£
- **`Ui_SettingsFrame`** â†’ `QFrame` ç±»å‹æ³¨è§£

### **ä¸»è¦ä¼˜åŠ¿ï¼š**
- âœ… **Anki å…¼å®¹å¯¼å…¥**: ä½¿ç”¨ `from aqt.qt import ...` æ›¿ä»£ `from PyQt6 import ...`
- âœ… **æ™ºèƒ½ç±»å‹æ¨æ–­**: è‡ªåŠ¨ç¡®å®šæ­£ç¡®çš„ Qt æ§ä»¶ç±»å‹
- âœ… **mypy å…¼å®¹**: ç”Ÿæˆçš„ä»£ç é€šè¿‡ä¸¥æ ¼ç±»å‹æ£€æŸ¥
- âœ… **æœ€å°åŒ–å¯¼å…¥**: åªå¯¼å…¥ UI æ–‡ä»¶ä¸­å®é™…ä½¿ç”¨çš„ç±»
- âœ… **è‡ªåŠ¨èµ„æºå¤åˆ¶**: èµ„æºæ–‡ä»¶è‡ªåŠ¨å¤åˆ¶åˆ°æœ€ç»ˆåŒ…ä¸­
- âœ… **æ¸…æ´å¼•ç”¨**: æ— éœ€å¤æ‚çš„QRCç¼–è¯‘
- âœ… **ç›´æ¥æ–‡ä»¶è·¯å¾„**: åœ¨Pythonä»£ç ä¸­ä½¿ç”¨æ ‡å‡†æ–‡ä»¶è·¯å¾„
- âœ… **å¼€å‘å‹å¥½**: èµ„æºç«‹å³å¯ç”¨äºæµ‹è¯•

## ä»£ç è´¨é‡

AADT åŒ…å«ç°ä»£å¼€å‘å·¥å…·ï¼Œå¼ºçƒˆå»ºè®®åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨ï¼Œæå‡ä»£ç è´¨é‡å’Œç±»å‹å®‰å…¨ï¼Œå¹¶æä¾›å®Œæ•´çš„ç±»å‹æ³¨è§£ï¼š

```bash
# ä½¿ç”¨ruffè¿›è¡Œä»£ç æ£€æŸ¥
uv run ruff check src/aadt/
uv run ruff format src/aadt/

# ä½¿ç”¨tyè¿›è¡Œç±»å‹æ£€æŸ¥  
uv run ty check src/aadt/

# è¿è¡Œæ‰€æœ‰æ£€æŸ¥
uv run ruff check src/aadt/ && uv run ty check src/aadt/
```

## å•å…ƒæµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•
pytest

# åŒ…å«è¦†ç›–ç‡
pytest --cov=aadt
```

## ğŸš€ Git é›†æˆ

AADT è®¾è®¡ä¸ºåœ¨ Git ä»“åº“ä¸­å·¥ä½œæœ€ä½³ï¼Œä½†**ä¸éœ€è¦ Git**ï¼š

### Git å¯ç”¨æ—¶ï¼ˆæ¨èï¼‰
- **ç‰ˆæœ¬æ£€æµ‹**: ä½¿ç”¨ Git æ ‡ç­¾å’Œæäº¤è¿›è¡Œç‰ˆæœ¬æ§åˆ¶
- **æºç å½’æ¡£**: ä½¿ç”¨ `git archive` è¿›è¡Œå¹²å‡€çš„æºç æå–
- **ä¿®æ”¹æ—¶é—´**: ä½¿ç”¨ Git æäº¤æ—¶é—´æˆ³

### éGitç¯å¢ƒï¼ˆé™çº§æ¨¡å¼ï¼‰
- **ç‰ˆæœ¬æ£€æµ‹**: ä» `pyproject.toml`ã€`VERSION` æ–‡ä»¶è¯»å–ï¼Œæˆ–ç”ŸæˆåŸºäºæ—¶é—´æˆ³çš„ç‰ˆæœ¬
- **æºç å½’æ¡£**: å¤åˆ¶å½“å‰ç›®å½•å¹¶æ™ºèƒ½æ’é™¤ï¼ˆ`.git`ã€`__pycache__` ç­‰ï¼‰
- **ä¿®æ”¹æ—¶é—´**: ä½¿ç”¨å½“å‰æ—¶é—´æˆ³

### ä½¿ç”¨ç¤ºä¾‹

```bash
# è‡ªåŠ¨æ£€æµ‹ç¯å¢ƒå¹¶æ„å»º
aadt build

# åœ¨ Git ä»“åº“ä¸­ï¼ˆè‡ªåŠ¨æ£€æµ‹ï¼‰
aadt build -d local

# åœ¨é Git ç›®å½•ä¸­ï¼ˆè‡ªåŠ¨é™çº§ï¼‰
aadt build -d local  # ä»ç„¶å¯ä»¥å·¥ä½œï¼

# æ˜¾å¼ç‰ˆæœ¬æŒ‡å®šï¼ˆä»»ä½•åœ°æ–¹éƒ½å¯ä»¥å·¥ä½œï¼‰
aadt build v1.2.0 -d local
```

å·¥å…·ä¼šè‡ªåŠ¨æ£€æµ‹ä½ çš„ç¯å¢ƒå¹¶é€‰æ‹©é€‚å½“çš„æ–¹æ³•ã€‚

## ğŸ“š ç¤ºä¾‹

æŸ¥çœ‹ `tests/` ç›®å½•è·å–ç¤ºä¾‹é…ç½®å’Œä½¿ç”¨æ¨¡å¼ã€‚

## ğŸ“„ åè®®

æœ¬é¡¹ç›®åŸºäºGNU AGPLv3åè®®ã€‚è¯¦è§[LICENSE](LICENSE)æ–‡ä»¶ã€‚

---

**ä¸ºAnkiç¤¾åŒºç”¨â¤ï¸æ„å»º**

> æœ¬é¡¹ç›®å— [aab](https://github.com/glutanimate/anki-addon-builder) é¡¹ç›®å¯å‘ï¼Œä¸“æ³¨äºä¸ºå³å°†æ­£å¼ä¸Šçº¿çš„æ–°ç‰ˆ  Anki æ’ä»¶å¼€å‘è€…æä¾›æœ€ä½³çš„å¼€å‘ä½“éªŒã€‚
