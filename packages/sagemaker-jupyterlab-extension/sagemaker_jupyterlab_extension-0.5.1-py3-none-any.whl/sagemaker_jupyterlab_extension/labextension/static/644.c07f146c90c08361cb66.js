"use strict";(self.webpackChunk_amzn_sagemaker_jupyterlab_extensions=self.webpackChunk_amzn_sagemaker_jupyterlab_extensions||[]).push([[644],{60644:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Wt});var a=n(80211);const s="@amzn/sagemaker-jupyterlab-extensions:gitclone",i="@amzn/sagemaker-jupyterlab-extensions:performance-metering",o="@amzn/sagemaker-jupyterlab-extension-common:projects-clonerepository",r="@amzn/sagemaker-jupyterlab-extensions:spacemenu",l="@amzn/sagemaker-jupyterlab-extensions:libmanagement",c={shutdown:"filemenu:shutdown"},d="Sso",p=3e5,u=500,g=100,m=12e4,h={SignInSession:{closeButton:"Close",signInButton:"Sign In",saveButton:"Save",saveAndRenewButton:"Save and renew session",signinDialog:{title:"Please sign in again",restartSessionBody:"You were logged out of your account. You are not able to perform actions in your workplace at this time. Please start a new session.",loggedOutBody:"You were logged out of your account. Choose 'Sign In' to continue using this workplace."},sessionExpiredDialog:{title:"Session Expired please signin"},renewSessionDialog:{title:"Session expiring soon",defaultBodyText:"If your session expires, you could lose unsaved changes.",renewSessionBody:'To renew the session, log out from Studio App via "File" -> "Log Out" and then "Sign out" from AWS IAM Identity Center (successor to AWS SSO) user portal.',saveAllChanges:"Do you want to save all changes now?",renewSessionNow:"Do you want to renew your session now?",remindText:"Remind me in 5 minutes",soonExpiringSessionBody:"This session will expire soon.",contDownTimerMessage:"This session will expire ",fromNow:"from now.",loseUnsavedChanges:"If your session expires, you could lose unsaved changes."}},ResourceUsage:{cpuMetricTitle:"CPU:",memoryMetricTitle:"MEM:",storageMetricTitle:"Storage:",instanceMemoryProgressBarTitle:"Instance MEM",instanceMetricsTitle:"Instance",stoargeSpaceLimitDialog:{title:"Free up storage space"}},GitClone:{dialogTitle:"Clone Git Repository",repoTitle:"Git repositories URL(.git):",pathTitle:"Project directory to clone into:",afterCloningTitle:"After cloning",openReadMeFilesLabel:"Open README files.",cancelButton:"Cancel",cloneButton:"Clone",errors:{directoryNotExistTitle:"Destination directory doesn’t exist.",directoryNotExistBody:"The destination directory doesn’t exist. Create this directory and then try cloning the repository again. directory: ",localGitCloneExistTitle:"Repository clone already exists in project.",localGitCloneExistBody:"It looks like the Git repository has already been cloned into the given directory. Click Dismiss to navigate to your existing clone. repositoy: ",noURLErrorTitle:"Missing valid URL.",noURLErrorBody:'No URL listed to clone the repository. Please input a valid URL ending with ".git".',generalCloneErrorTitle:"Unable to clone repository to project.",generalCloneErrorBody:"Something went wrong when trying to clone the repository to your project. Please try again later. ",failedOptions:"Failed to handle additional options.",failedOptionsBody:"Something went wrong when trying to open README file within the repo.",invalidCloneUrlTitle:"Invalid URL provided",invalidCloneUrlBody:"The URL provided is not valid. Please input a valid URL to clone."}},Space:{privateSpaceHeader:"Personal Studio",unknownUser:"Unknown User",unknownSpace:"Unknown Space"},ProjectsCloneRepo:{errorDialog:{errorTitle:"Unable to clone repository",defaultErrorMessage:"Something went wrong when cloning the repository.",invalidRequestErrorMessage:"A request to clone the reposioty is invalid.",invalidProjectName:"Invalid project name: Project does not exist.",invalidCloneUrlBody:"The URL provided is not valid. Please input a valid URL to clone."}},LibManagement:{installing:"Installing packages and extensions from saved configuration...",allInstalled:"All packages and extensions already installed",installSuccess:"Installation completed. Restart the kernel for updated libraries. Restart the server for updated extensions.",installFailed:"Failed to install packages/extensions. Check error logs in terminal.",terminalDisposed:"Terminal is disposed",terminalWarning:"Closing the terminal will terminate the installation process. This terminal will automatically close once installation complete.",environmentManagement:"Environment management",libraryConfiguration:"Library Configuration",failedToOpenConfig:"Failed to open Environment Management config",successfullyLoaded:"Successfully loaded Extension Management plugin",unableToFetchEnvironment:"Unable to fetch environment",condaTitle:"Python - Conda Packages/Extensions",condaDescription1:"Use this interface to manage automatic Conda package installations for your environment. Packages specified here will be installed each time your space runs.",condaDescription2:"Enter package names and optional version constraints (e.g., pandas or pandas>=1.0.0)",condaDescription3:"For more information on package specification, see",condaLinkText:"Conda package specification",importantNotes:"Important Notes:",note1:"• Closing the background terminal cancels ongoing installations",note2:"• After package installation, Jupyter server automatically restarts. This restart clears all in-memory variables and active sessions",note3:"• Removing packages from this interface only prevents future installations. Package uninstallation must be done separately",note4:"• Channel priorities set here apply only to this interface. Packages installed via notebook or terminal are not tracked here",note5:"• Installation requires internet access (except for custom channels)",corruptedConfigTitle:"The configuration file {path} is corrupted or invalid.",corruptedConfigBody:"To resolve this issue: • Remove the corrupted file and restart the UI (you will need to reconfigure preferences), OR • Fix the file format back to how it was originally",corruptedConfigNote:"Note: Removing the file will reset all saved extension and package configurations. Please exit and reopen this widget after making changes.",installInCurrentSession:"Install in current session",saveAllChanges:"Save all changes",saving:"Saving...",resolveErrors:"You must resolve all errors to save",invalidInput:"Invalid input",savedPackageConfigurations:"Saved package configurations",packageChannelsTitle:"Package Channels",packageSpecsTitle:"Package Specifications",condaPackagesTitle:"Conda Packages/Extensions",libraryManagementConfiguration:"Library management configuration",successfullyInstalledPackages:"Successfully installed packages and extensions",failedToInstallPackages:"Failed to install packages and extensions"}},y="GitCloneDialogError",v="ValidRepoPathError",f="spaceMenuHeader";var C,w;!function(e){e.EDIT_LIBRARY_CONFIG="edit-library-config"}(C||(C={})),function(e){e.IAM="iam"}(w||(w={}));const b={fileType:{name:"libs-config",pattern:".libs.json",mimeTypes:["application/json"]},factory:{name:"library-config-editor"},launcher:{category:"Other",rank:1}},E={ApplyChangeToSpace:!1,Python:{CondaPackages:{Channels:[],PackageSpecs:[]}}};var S;!function(e){e[e.RUNNING=0]="RUNNING",e[e.SUCCESS=1]="SUCCESS",e[e.FAILURE=2]="FAILURE"}(S||(S={}));const M='echo "EXIT_CODE: $?"',x="^[a-zA-Z0-9._:/=<>!~^*,|-]+$",L=/\x1B\[[?0-9;]*[a-zA-Z]|\r/g,k={id:"@amzn/sagemaker-jupyterlab-extensions:hideshutdown",requires:[a.IMainMenu],autoStart:!0,activate:(e,t)=>{e.commands._commands.get(c.shutdown).isVisible=()=>!1}};var T=n(29801),j=n.n(T),_=n(66029),N=n.n(_),R=n(71342),I=n(35238);class D{constructor(){this._dismissTime=0,this._count=0}setDismissTime(e){e&&(this._dismissTime=e,this._count=1)}getDismissTime(){return this._dismissTime}}const P=()=>{const e=U("authMode");return e&&e[1]&&e[1]===d},U=e=>document.cookie.match("\\b"+e+'="?([^;]*)"?\\b'),A=()=>{const e=U("expiryTime"),t=U("ssoExpiryTimestamp");return P()&&t?Number(t[1]):e?Number(e[1]):null},B=(e,t)=>{var n,a;t?null===(n=e.serviceManager)||void 0===n||n.connectionFailure.disconnect(R.ConnectionLost):null===(a=e.serviceManager)||void 0===a||a.connectionFailure.connect(R.ConnectionLost)},O=()=>{const e=U("redirectURL");let t;try{if(t=new URL(e?e[1]:void 0),"http:"===t.protocol||"https:"===t.protocol)return t.toString()}catch(e){return}},F=(e,t)=>{const n=A(),a=window.open(e,"signin window","width=800, height=600");let s=!1;const i=window.setInterval((()=>{if(a&&a.closed&&!s)return void window.clearInterval(i);const e=A();if(null!==e&&null!==n&&(e>n||isNaN(e))){window.clearInterval(i),a&&a.close(),s=!0;for(const e of t)e.kernel.reconnect();I.Dialog.tracker.forEach((e=>e.reject()))}}),g)},$=async()=>{const{SignInSession:e}=h,{signinDialog:t}=e,n=O(),a=n?[I.Dialog.okButton({label:e.signInButton})]:[I.Dialog.cancelButton({label:e.closeButton})],s=n?N().createElement("div",{"data-testid":"session-signin-log-out"},t.loggedOutBody):N().createElement("div",{"data-testid":"session-signin-restart"},t.restartSessionBody),i=new I.Dialog({title:t.title,body:s,buttons:a,hasClose:!1});return{sigInDialogResult:await i.launch(),confirmDialog:i}};var z=n(76797),G=n(96697),V=n(26027),Z=n(23776),W=n(70346);const H=(e,t,n,a,s,i,o)=>{const r=A(),l=o(),c=l&&l+p;if(null===r)B(e,!1);else{const o=j().unix(r/1e3).diff(j()()),d=Date.now();((e,t,n)=>((e,t)=>-1===e&&t)(t,e)||((e,t)=>e<=0&&!t)(n,e))(P(),r,o)?(a(),(async(e,t,n)=>{const{SignInSession:a}=h,s=O();I.Dialog.tracker.forEach((e=>e.reject())),B(e,!0);const{sigInDialogResult:i,confirmDialog:o}=await $();if(i&&i.button)if(n(),s)F(O(),t);else if(i&&i.button.label===a.closeButton){const e=A(),t=e&&e/1e3,n=t&&j().unix(t).diff(j()());null!==n&&n&&n>p&&(o.dispose(),setTimeout((async()=>{await $()}),p))}else o.dispose(),F(O(),t)})(e,t,s)):o<=9e5&&(void 0===l||c&&d>c)?(a(),(async(e,t,n,a,s)=>{const{SignInSession:i}=h,{renewSessionDialog:o}=h.SignInSession,{renewSessionDialogResult:r,confirmDialog:l}=await(async()=>{const{SignInSession:e}=h,{renewSessionDialog:t}=h.SignInSession,n=O(),a=A(),s=a&&j().unix(a/1e3).fromNow(),i=`${t.contDownTimerMessage}${s}.`,o=`${P()?t.soonExpiringSessionBody:i}`,r=t.renewSessionBody,l=P()?N().createElement(N().Fragment,null,N().createElement("div",{"data-testid":"session-renew-lose-unsaved-changes"},o," ",t.loseUnsavedChanges," ",t.saveAllChanges),N().createElement("div",null,r)):N().createElement("div",{"data-testid":"session-renew-now"},N().createElement("p",null,o),N().createElement("p",null,t.renewSessionNow)),c=[I.Dialog.okButton({label:t.remindText}),n&&I.Dialog.okButton({label:e.saveAndRenewButton})],d=new I.Dialog({title:t.title,body:l,buttons:c,hasClose:!1});return{renewSessionDialogResult:await d.launch(),confirmDialog:d}})();if(r&&r.button.label===o.remindText){const e=new D;0===e._count?(e.setDismissTime(Date.now()),s(e._dismissTime)):e.getDismissTime(),l.dispose(),a()}else r&&r.button.label===i.saveAndRenewButton&&(l.dispose(),n(),a(),P()||F(O(),t))})(0,t._sessions,n,s,i),B(e,!1)):B(e,!1)}},J={id:"@amzn/sagemaker-jupyterlab-extensions:sessionmanagement",requires:[],autoStart:!0,activate:async e=>{let t;const n=e.serviceManager.sessions,a=()=>{s.start()},s=((e,t,n,a,s,i,o)=>new z.Poll({auto:!0,factory:async()=>H(e,t,n,a,s,i,o),frequency:{interval:u,backoff:!0,max:m}}))(e,n,(()=>{const t=new V.TextModelFactory,n=new V.DocumentRegistry({textModelFactory:t}),a=new Z.ServiceManager({}),s=new W.DocumentManager({registry:n,manager:a,opener:{open:e=>{},get opened(){return{connect:()=>!1,disconnect:()=>!1}}}});(0,G.each)(e.shell.widgets("main"),(e=>{const t=s.contextForWidget(e);void 0!==t&&t.save().then((()=>t.createCheckpoint())).catch((e=>{if("Cancel"!==e.message)throw e}))}))}),(()=>{s.stop()}),a,(e=>{t=e}),(()=>t));a()}};var q=n(52446);const Y="aws/sagemaker/api/create-marker-file",Q=[200,201];var X,K=n(40082);!function(e){e.POST="POST",e.GET="GET"}(X||(X={}));const ee=async(e,t)=>{const n=Z.ServerConnection.makeSettings(),a=K.URLExt.join(n.baseUrl,e);try{const e=await Z.ServerConnection.makeRequest(a,{method:t},n);if(!Q.includes(e.status))throw new Error("Unable to fetch data");return e}catch(e){throw Error(e)}};var te=n(95933);const ne="8px",ae="12px",se=te.css`
  border-bottom: solid 1px var(--sm-border-color2);
`,ie=te.css`
  background-color: var(--jp-layout-color2);
  border: solid 1px var(--jp-border-color2);
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  position: fixed;
  bottom: 25px;
`,oe=te.css`
  margin: 0 ${ae} ${ne};
`,re=te.css`
  font-weight: bold;
  margin: ${ne} 0 0 ${ne};
`,le=(te.css`
  margin: 0 ${ae} 0 ${"16px"};
`,te.css`
  border-radius: 10px;
  height: 100%;
  width: 30px;
`),ce=te.css`
  line-height: 24px;
  padding: 0 5px;

  &:hover {
    background-color: var(--jp-layout-color2);
  }
`,de=(te.css`
  padding-left: 4px;
`,te.css`
  display: flex;
  justify-content: flex-start;
  align-items: center;
  margin: 6px 12px;
`),pe=te.css`
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  padding-right: 5px;
`,ue=te.css`
  border-radius: 10px;
  width: 40px;
  margin: 0 0 2px 4px;
  height: 6px !important;
`,ge=(te.css`
  border-radius: 10px;
  display: inline-block;
  width: 40px;
  height: 8px;
`,te.css`
  display: flex;
  align-items: center;
`);var me=n(3221);const he=({value:e,singleProgressBarStyle:t,displayValue:n,label:a,labelClassName:s,conatinerClassName:i})=>N().createElement("div",{role:"container","data-testid":"linear-progress-bar-container"},N().createElement("div",{className:i},a&&N().createElement("span",{className:s},a," ",n,"%"),N().createElement(me.Z,{"data-testid":"linear-progress-bar",className:t,variant:"determinate",value:e}))),ye="jlStudio-",ve=`${ye}ResourceUsageWidgetContainer`,fe=`${ye}MetricsWidgetContainer`,Ce=({onClickHandler:e,instanceMetricsResponse:t,instanceMetricsDisplayValue:n})=>{const[a,s]=(0,_.useState)(!1),[i,o]=(0,_.useState)(0),[r,l]=(0,_.useState)(0),[c,d]=(0,_.useState)(0),[p,u]=(0,_.useState)(!1),g=e=>e&&void 0!==e?Math.round(e):0,m=e=>0===e?"0.0":e&&void 0!==e?e.toFixed(2).toString():"--";(0,_.useEffect)((()=>{if(void 0!==t&&(null==t?void 0:t.metrics)){const{metrics:e}=t,n=e.cpu.cpu_percentage,a=e.memory.memory_percentage,s=e.storage.used_space_in_bytes,i=e.storage.total_space_in_bytes,r=s&&i&&s/i*100;o(n),l(a),d(r)}}),[t]),(0,_.useEffect)((()=>{if(c&&c>95&&!1===p){const{stoargeSpaceLimitDialog:e}=h.ResourceUsage;I.Notification.info(e.title),u(!0)}}),[p,c]);const{instanceMemoryProgressBarTitle:y,instanceMetricsTitle:v,cpuMetricTitle:f,memoryMetricTitle:C,storageMetricTitle:w}=h.ResourceUsage;return N().createElement("div",{"data-testid":"resource-usage-widget","data-analytics-type":"eventContext","data-analytics":"JupyterLab",className:`${ve} ${ce}`},N().createElement("div",{className:ge,onClick:()=>(t=>{s(!t),e()})(a),"data-testid":"resource-usage-widget-click-handler","data-analytics-type":"eventDetail","data-analytics":"ResourceUsage-Widget-Click"},y," ",void 0===n?N().createElement(me.Z,{"data-testid":"resource-usage-linear-progress-spinner",className:ue}):N().createElement("div",{className:ge,"data-testid":"resource-usage-status-bar-container"},N().createElement(me.Z,{className:ue,variant:"determinate",value:0|n}),n?Math.round(n):0,"%")),a&&N().createElement("div",{className:`${fe} ${ie}`,"data-testid":"resource-usage-data-container"},N().createElement("div",{className:se},N().createElement("div",{className:re},v),N().createElement("div",{className:oe},N().createElement("div",null,N().createElement(he,{value:g(i),displayValue:m(i),label:f,labelClassName:pe,singleProgressBarStyle:le,conatinerClassName:de,"data-testid":"resource-usage-data-container-cpu"}),N().createElement(he,{value:g(r),displayValue:m(r),label:C,labelClassName:pe,singleProgressBarStyle:le,conatinerClassName:de,"data-testid":"resource-usage-data-container-memory"}),N().createElement(he,{value:g(c),displayValue:m(c),label:w,labelClassName:pe,singleProgressBarStyle:le,conatinerClassName:de,"data-testid":"resource-usage-data-container-storage"}))))))};class we extends I.ReactWidget{constructor(){super(),this.clickHandler=()=>{this.update()},this.getInstanceMetrics=async()=>{await ee("aws/sagemaker/api/instance/metrics",X.GET).then((e=>{e&&e.json().then((e=>{var t,n;this._instanceMetricsResponse=e||null,(null===(t=this._instanceMetricsResponse)||void 0===t?void 0:t.metrics.memory)?this._instanceMetricsDisplayValue=null===(n=this._instanceMetricsResponse)||void 0===n?void 0:n.metrics.memory.memory_percentage:this._instanceMetricsDisplayValue=void 0}))})),this.update()},this._getInstanceMetricsLoop=setInterval(this.getInstanceMetrics,5e3),this._instanceMetricsResponse=null,this._instanceMetricsDisplayValue=void 0}getInstanceMetricsResponse(){return this._instanceMetricsResponse}render(){return N().createElement(Ce,{onClickHandler:this.clickHandler,instanceMetricsResponse:this._instanceMetricsResponse,instanceMetricsDisplayValue:this._instanceMetricsDisplayValue})}}const be={id:"@amzn/sagemaker-jupyterlab-extensions:resourceusage",requires:[q.IStatusBar],autoStart:!0,activate:async(e,t)=>{const n=new we;t.registerStatusItem("@amzn/sagemaker-jupyterlab-extensions:resourceusage:resource-usage-widget",{item:n,align:"left",isActive:()=>!0,rank:100})}};var Ee=n(39746),Se=n(81031);const Me=te.css`
  .MuiInputBase-input MuiInput-input {
    width: 400px;
    margin-bottom: 20px;
  }
`,xe=({label:e,id:t,helperText:n,error:a,handleChange:s,regEx:i,...o})=>{const[r,l]=(0,_.useState)(""),[c,d]=(0,_.useState)(!0);return N().createElement(Se.Z,{variant:"standard",className:Me,"data-testid":"text-field-container",error:!c,id:t,label:e,helperText:n,value:r,onChange:e=>(e=>{l(e.target.value);const t=new RegExp(i);d(t.test(e.target.value)),s(e.target.value)})(e),...o})},Le=te.css`
  &.jp-ThemedContainer {
    z-index: 2;
  }
`,ke=te.css`
  width: 460px;
  input {
    width: 460px;
  }
  .MuiFormControl-root.MuiTextField-root {
    margin-bottom: 20px;
  }
`;te.css`
  margin-bottom: 20px;
`;var Te=n(14459);const je=(e=!1)=>te.css`
  color: var(--jp-color-root-light-800);
  font-weight: 400;
  font-size: var(--jp-ui-font-size1);
  line-height: var(--jp-ui-font-size1);
  margin-bottom: var(--jp-ui-font-size1);
  ${e&&"\n    &:after {\n      content: '*';\n      color: var(--jp-error-color1);\n    }\n  "}
`,_e=te.css`
  margin-top: 20px;
`,Ne=({options:e,handleChange:t,label:n,freeSolo:a})=>{const s=(e,n)=>{t(n)};return _.createElement("div",{className:_e},_.createElement("label",{className:je(!0)},n),_.createElement(Te.Z,{id:"autocomplete",freeSolo:a,autoSelect:!0,onChange:(e,t)=>s(0,t),onInputChange:(e,t)=>s(0,t),options:e.map((e=>e.label)),renderInput:e=>_.createElement(Se.Z,{...e,variant:"outlined",size:"small",margin:"dense"})}))};var Re=n(3283),Ie=n(98920);const De=({label:e,id:t,handleChange:n,...a})=>{const[s,i]=(0,_.useState)(!0);return N().createElement(N().Fragment,null,N().createElement(Ie.Z,{control:N().createElement(Re.Z,{"data-testid":"checkbox-field",inputProps:{"aria-label":"controlled"},checked:s,onChange:e=>{i(e.target.checked),n(e.target.checked)},id:t,...a}),label:e}))},Pe=({gitRepositories:e,setGitURL:t,setPath:n,setOpenREADME:a})=>{const[s,i]=(0,_.useState)(""),[o,r]=(0,_.useState)(""),[l,c]=(0,_.useState)(!0),[d,p]=(0,_.useState)([]),{repoTitle:u,pathTitle:g,openReadMeFilesLabel:m}=h.GitClone;return(0,_.useEffect)((()=>{if(e&&e.GitCodeRepositories.length>=0){const t=[];e.GitCodeRepositories.length>0&&e.GitCodeRepositories.forEach((e=>t.push({value:e,label:e}))),p(t)}}),[e]),N().createElement("div",{className:ke,"data-testid":"git-clone-container","data-analytics-type":"eventContext","data-analytics":"JupyterLab"},N().createElement(Ne,{"data-testid":"autocomplete-field-container","data-analytics-type":"eventDetail","data-analytics":"GitClone-Repo-AutoComplete",label:u,options:d,value:o,handleChange:e=>{r(e),t(e)},freeSolo:!0}),N().createElement(xe,{"data-testid":"text-field-container","data-analytics-type":"eventDetail","data-analytics":"GitClone-Path-TextField",error:!1,id:"path",label:g,helperText:"",valuePassed:s,handleChange:e=>{i(e),n(e)},regEx:"^([A-Za-z]*|[0-9]*|[/]*|[.]*|[A-Za-z0-9/.]*)$"}),N().createElement(De,{"data-testid":"read-me-field","data-analytics-type":"eventDetail","data-analytics":"GitClone-OpenReadMeCheckbox",label:m,id:"openReadMe",handleChange:e=>{c(e),a(e)},checked:l}))};class Ue extends I.ReactWidget{constructor(){super(),this.setGitURL=e=>{this.URL=e},this.setPath=e=>{this.path=e},this.setOpenREADME=e=>{this.openREADME=e},this.getGitRepositories=async()=>{await ee("aws/sagemaker/api/git/list-repositories",X.GET).then((e=>{e&&e.json().then((e=>{this._gitCloneRepositories=e||null,this.update()}))}))},this.URL="",this.path="",this.openREADME=!0,this._gitCloneRepositories=null,this.getGitRepositories()}getValue(){return{URL:this.URL,path:this.path,openREADME:this.openREADME}}render(){return N().createElement(Pe,{gitRepositories:this._gitCloneRepositories,setGitURL:this.setGitURL,setPath:this.setPath,setOpenREADME:this.setOpenREADME})}}var Ae=n(92916),Be=n(44593);const{name:Oe,version:Fe}=n(4147),$e=(e,t,n)=>e.child({ExtensionName:Oe,ExtensionVersion:Fe,PluginId:t},n);var ze;!function(e){e[e.CanClone=0]="CanClone",e[e.NotExist=1]="NotExist",e[e.AlreadyCloned=2]="AlreadyCloned"}(ze||(ze={}));const Ge=[{name:"README.ipynb",factory:"Notebook"},{name:"README.md",factory:"Markdown Preview"}],Ve=async(e,t,n)=>{const{repoPath:a,openREADME:s}=n;if(await e.execute("filebrowser:go-to-path",{path:a}),!0===s)try{await(async(e,t,n)=>{const a=await t.get(e);if("directory"===a.type){const t=Ge.find((e=>a.content.some((t=>t.name===e.name))));t&&await n.execute("docmanager:open",{path:K.PathExt.join(e,t.name),factory:t.factory})}})(a,t,e)}catch(e){}},Ze=async(e,t)=>{let n;try{n=await t.get(e)}catch(e){return!1}return"directory"===n.type};var We=n(71775),He=n(16017),Je=n(24337),qe=n(79510);const{dialogTitle:Ye,cancelButton:Qe,cloneButton:Xe,errors:Ke}=h.GitClone,et={id:s,requires:[Ee.IFileBrowserFactory,Ee.IDefaultFileBrowser,Be.IGitExtension,I.IToolbarWidgetRegistry,He.ILogger,Ae.ITranslator],autoStart:!0,activate:async(e,t,n,a,i,o,r)=>{const{commands:l,serviceManager:c}=e,d=c.contents,p=$e(o,s),u=(r=r||Ae.nullTranslator).load("sagemaker_studio");l.addCommand(Je.TQ.gitClone,{label:"Git Clone Repo",caption:"",execute:()=>(async(e,t,n,a,s)=>{var i,o;const r=t.model;let l="";const c=null===(o=null===(i=null==e?void 0:e.tracker)||void 0===i?void 0:i.currentWidget)||void 0===o?void 0:o.model.path;let d,p=null!=c?c:"",u=!0,g=!0;const m=new I.Dialog({title:Ye,body:new Ue,focusNodeSelector:"input",buttons:[I.Dialog.cancelButton({label:Qe}),I.Dialog.okButton({label:Xe})],hasClose:!1});m.addClass(Le);try{d=await m.launch()}catch(e){return void s.error({Message:y,Error:e})}if(!d.button.accept||!d.value)return;var f;if(({URL:l,path:p,openREADME:u,findEnvironment:g}=d.value),"string"==typeof(f=p)&&f.length>0||(p="./"),!(e=>/^(https:\/\/|git)([:/@.~\-_a-zA-Z0-9])+$/.test(e))(l))return void await(0,I.showErrorMessage)(Ke.invalidCloneUrlTitle,{message:Ke.invalidCloneUrlBody});const C=(e=>{const t=K.URLExt.parse(e);return K.PathExt.basename(t.pathname,".git")})(l),w=K.PathExt.join(p,C);let b;try{b=await(async(e,t,n,a)=>{const{errors:s}=h.GitClone;return await Ze(t,e)?await Ze(a,e)?(await(0,I.showErrorMessage)(s.localGitCloneExistTitle,{message:s.localGitCloneExistBody+n}),ze.AlreadyCloned):ze.CanClone:(await(0,I.showErrorMessage)(s.directoryNotExistTitle,{message:s.directoryNotExistBody+t}),ze.NotExist)})(n,p,l,w)}catch(e){s.error({Message:v,Error:new Error(JSON.stringify(e))})}const E={repoPath:w,openREADME:u,findEnvironment:g};b===ze.CanClone?(async(e,t,n,a,s,i)=>{const{errors:o}=h.GitClone,r=await e.execute("terminal:create-new");let l="";s&&(l+=`cd ${s} && `),l+=`git clone ${i} && exit\r`;try{const s=r.content;s.session.send({type:"stdin",content:[l]}),s.session.connectionStatusChanged.connect((async a=>{if("disconnected"===a.connectionStatus)try{await Ve(e,t,n)}catch(e){await(0,I.showErrorMessage)(o.failedOptions,o.failedOptionsBody,[I.Dialog.warnButton({label:"DISMISS"})])}})),await a.refresh()}catch(e){r.dispose(),await(0,I.showErrorMessage)(o.generalCloneErrorTitle,{message:o.generalCloneErrorBody+e})}})(a,n,E,r,p,l):b===ze.AlreadyCloned&&Ve(a,n,E)})(t,n,d,l,p),isEnabled:()=>e.serviceManager.terminals.isAvailable()}),i.addFactory("FileBrowser","gitClone",(()=>I.ReactWidget.create(N().createElement(I.UseSignal,{signal:a.repositoryChanged,initialArgs:{name:"pathRepository",oldValue:null,newValue:a.pathRepository}},((t,n)=>N().createElement(I.ToolbarButtonComponent,{enabled:null===(null==n?void 0:n.newValue),icon:qe.W6,onClick:()=>{e.commands.execute(Je.TQ.gitClone)},tooltip:u.__("Git Clone")})))))),(0,We.ZM)(a,n,e.serviceManager.contents,e.contextMenu,u),p.info({Message:"Successfully loaded Git extension"})}},tt=e=>{var t,n;const a=`${e}.AWSSageMakerUI`;return performance.mark(a),performance.measure(a,void 0,a),null!==(n=null===(t=performance.getEntriesByName(a,"measure")[0])||void 0===t?void 0:t.duration)&&void 0!==n?n:0},nt={id:i,requires:[He.ILogger],autoStart:!0,activate:(e,t)=>{((e,t)=>{const n=null===window||void 0===window?void 0:window.performance.getEntriesByType("resource");let a={};Array.isArray(n)&&n.length>0&&n.forEach((e=>{const{duration:t,requestStart:n,responseStart:s,startTime:i}=e;n&&t&&(a={...a,TimeToFirstByteMS:Math.round(s-i)})}));let s=null,i=null,o=null,r=null,l=null;const c=performance.getEntriesByType("navigation")[0];if(c)s=c.redirectCount,i=c.redirectEnd-c.redirectStart,o=Math.round(c.domContentLoadedEventEnd),r=Math.round(c.responseStart),l=Math.round(c.loadEventEnd);else{const e=performance.timing;s=performance.navigation.redirectCount,i=e.redirectEnd-e.redirectStart,o=e.domContentLoadedEventEnd-e.navigationStart,r=e.responseStart-e.navigationStart,l=e.loadEventEnd-e.navigationStart}a={...a,RedirectCount:s,RedirectTimeMS:i,TimeToDOMContentLoadedMS:o,TimeToFirstByteMS:r,TimeToOnLoadMS:l},e.info(a),t.started.then((()=>{e.info({TimeToAppStartedMS:Math.round(tt("timeToAppStarted"))})})),t.restored.then((()=>{const t=(n=Math.round(tt("timeToAppRestored")))>0?n:null;var n;e.info({TimeToAppRestoredMS:t||void 0})}))})($e(t,i,He.logSchemas.performance),e)}};var at=n(80087),st=n(28201);const it={SpaceMenuHeader:te.css`
  margin: -6px 0;
  padding: 0 var(--jp-size-2);
  height: 10;
  border-radius: var(--jp-radius-small);
  font-size: var(--jp-size-3);
  display: flex;
  justify-content: center;
  align-items: center;

  & > p {
    display: inline-block;
    user-select: none;
    color: var(--jp-color-root-light-800);
  }

  & > svg {
    padding: 0 var(--jp-size-2);
  }
`},{unknownSpace:ot,unknownUser:rt}=h.Space,lt=({spaceName:e})=>{const t=!!e,n=U("studioUserProfileName");return N().createElement("div",{className:it.SpaceMenuHeader,"data-testid":f},t?N().createElement(at.Z,{fontSize:"small"}):N().createElement(st.Z,{fontSize:"small"}),N().createElement("p",null,`${n&&n[1]||rt} / ${t?e:ot}`))};class ct extends I.ReactWidget{constructor(){super(),this.getSpaceName=async()=>{await ee("aws/sagemaker/api/context",X.GET).then((e=>{e&&e.json().then((e=>{this.spaceName=e?null==e?void 0:e.spaceName:null,this.update()}))}))},this.spaceName="",this.getSpaceName()}render(){return N().createElement(lt,{spaceName:this.spaceName})}}const dt={id:r,requires:[He.ILogger],autoStart:!0,activate:async(e,t)=>{const n=new ct;n.id=I.DOMUtils.createDomID();const a=$e(t,r);e.shell.add(n,"top",{rank:1e3}),window&&window.panorama&&window.panorama("trackCustomEvent",{eventType:"render",eventDetail:"Space-Plugin",eventContext:"JupyterLab",timestamp:Date.now()}),a.info({Message:"Successfully loaded Space plugin"})}};var pt=n(91973),ut=n.n(pt);const gt=h.ProjectsCloneRepo.errorDialog,mt=[{name:"README.ipynb",factory:"Notebook"},{name:"README.md",factory:"Markdown Preview"}],ht=async(e,t,n,a)=>{let s=K.PathExt.join(e,t);s=s.replace("$HOME","."),n.commands.execute("filebrowser:go-to-path",{path:s});const i=await a.get(s);if("directory"===i.type){const e=mt.find((e=>i.content.some((t=>t.name===e.name))));e&&await n.commands.execute("docmanager:open",{path:K.PathExt.join(s,e.name),factory:e.factory})}},yt=async e=>(0,I.showErrorMessage)(gt.errorTitle,{message:e}),vt={id:o,requires:[R.IRouter,He.ILogger,Ee.IDefaultFileBrowser],autoStart:!0,activate:async(e,t,n,a)=>{const{commands:s,serviceManager:i}=e,r=i.contents,l="projects:clone-repository",c=$e(n,o);s.addCommand(l,{execute:()=>(async(e,t,n,a,s)=>{const{search:i}=e.current;if(!i)return await yt(gt.invalidRequestErrorMessage),void n.error({Error:new Error("Invalid cloning parameters: Query params must be specified")});const o=s.model,{is_efs:r,project_name:l="",repo_name:c="",clone_url:d="",code_commit:p}=K.URLExt.queryStringToObject(i),u=await(async()=>{let e;try{e=await ee("aws/sagemaker/api/projects/list-projects",X.GET)}catch(e){throw await yt(gt.defaultErrorMessage),e}const t=await e.json(),{projectsList:n}=t;return n})();if(!(e=>""!==e&&/^https:\/\/[-\w.]+\.[A-Za-z]+\/[-\w@/.]+(?:\.git)?\/?(?:#.*)?$/.test(e))(d))return await yt(gt.invalidCloneUrlBody),void n.error({Message:"Invalid cloning parameters: Clone URL is not valid"});if(!u.includes(l))return await yt(gt.invalidProjectName),void n.error({Message:"Invalid project name: Project does not exist"});const g="$HOME",m=K.PathExt.join(g,"user-default-efs"),h=K.PathExt.join("true"===r?m:g,l),y=ut()([h.replace("$HOME",".")]);let v=`if ! [[ -d ${y} ]]; then mkdir ${y}; fi && cd ${y} && `;p&&(v+="git config --global credential.https://git-codecommit.*.amazonaws.com.helper '!aws codecommit credential-helper $@' && git config --global credential.https://git-codecommit.*.amazonaws.com.usehttppath true &&"),v+="git config --global credential.helper 'cache --timeout=3600' && git config --global credential.usehttppath true &&";const f=ut()([d]);v+=`git clone ${f} && exit\r`,t.restored.then((async()=>{try{let e=K.PathExt.join(h,c);if(e=e.replace("$HOME","."),"directory"===(await a.get(e)).type)return ht(h,c,t,a),void await o.refresh()}catch(e){n.info({Message:"Directory does not exist, creating directory."})}const e=await t.commands.execute("terminal:create-new");try{const n=e.content;n.session.send({type:"stdin",content:[v]}),t.commands.execute("launcher:create"),n.session.connectionStatusChanged.connect((async e=>{"disconnected"===e.connectionStatus&&(ht(h,c,t,a),n.session.shutdown())})),await o.refresh()}catch(t){try{const e=K.PathExt.join(h,c);await a.delete(e)}catch(e){n.error({Message:"Failed to cleanup partial clone"})}e.dispose();const s=t instanceof Error?t.message:String(t);await yt(s)}}))})(t,e,c,r,a)}),t.register({command:l,pattern:new RegExp("[?]command=clone-repository"),rank:10})}};var ft=n(40104),Ct=n(96399);const wt={errorText:{color:"var(--jp-error-color0)"},linkColor:{color:"var(--jp-content-link-color)"},importantNote:{marginTop:"10px",fontWeight:"bold"},pluginListEntry:{paddingTop:"8px",marginTop:"10px"}},bt=({children:e})=>N().createElement("span",{style:wt.errorText,className:"jp-PluginList-entry-label-text"},e),Et=new Ct.LabIcon({name:"libmgmt:library-management-icon",svgstr:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n    <path class="jp-icon3 jp-icon-selectable" fill="#616161" d="M4 3C3.44772 3 3 3.44772 3 4V20C3 20.5523 3.44772 21 4 21H14C14.5523 21 15 20.5523 15 20V15.2973L15.9995 19.9996C16.1143 20.5398 16.6454 20.8847 17.1856 20.7699L21.0982 19.9382C21.6384 19.8234 21.9832 19.2924 21.8684 18.7522L18.9576 5.0581C18.8428 4.51788 18.3118 4.17304 17.7716 4.28786L14.9927 4.87853C14.9328 4.38353 14.5112 4 14 4H10C10 3.44772 9.55228 3 9 3H4ZM10 6H13V14H10V6ZM10 19V16H13V19H10ZM8 5V15H5V5H8ZM8 17V19H5V17H8ZM17.3321 16.6496L19.2884 16.2338L19.7042 18.1898L17.7479 18.6057L17.3321 16.6496ZM16.9163 14.6933L15.253 6.86789L17.2092 6.45207L18.8726 14.2775L16.9163 14.6933Z"/>\n</svg>'}),St=new Ct.LabIcon({name:"libmgmt:conda-icon",svgstr:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path class="jp-icon3 jp-icon-selectable"  d="M3.54174 11.7007C3.01586 11.6481 2.48998 11.5487 1.97579 11.4085L1.92905 11.3968L1.94073 11.3501C2.09265 10.8534 2.28548 10.3684 2.51336 9.90684L2.53673 9.8601L2.57763 9.88347C2.92237 10.0763 3.29048 10.2516 3.6586 10.4035L3.69366 10.4152L3.68781 10.4503C3.62938 10.8417 3.60017 11.2449 3.58848 11.6481V11.7007H3.54174ZM4.67529 4.62471V4.61302C4.37145 4.61886 4.06761 4.63639 3.76962 4.67145C3.80467 4.98113 3.86311 5.28497 3.92738 5.58297C4.13773 5.23239 4.38898 4.91102 4.67529 4.62471ZM3.59432 12.0571V12.0162L3.55342 12.0104C3.10935 11.9694 2.65943 11.8935 2.21536 11.7883L2.0985 11.7591L2.16277 11.8643C2.56594 12.472 3.05676 13.0095 3.62354 13.4653L3.71703 13.5412L3.6995 13.4244C3.63523 12.9569 3.60017 12.4953 3.59432 12.0571ZM5.7621 1.39349C5.2187 1.58047 4.70451 1.83172 4.23122 2.1414C4.58765 2.20567 4.94407 2.28748 5.28881 2.39265C5.42905 2.04791 5.58681 1.7207 5.7621 1.39349ZM8.02337 1.01953C7.75459 1.01953 7.49165 1.03706 7.22871 1.06628C7.59683 1.32337 7.95326 1.60384 8.28631 1.91352L8.56678 2.17062L8.29215 2.43355C8.06427 2.64975 7.84808 2.88347 7.63773 3.13472L7.62604 3.14641C7.62604 3.14641 7.58514 3.19315 7.52087 3.26911C7.68447 3.25158 7.85392 3.2399 8.02337 3.2399C10.6469 3.2399 12.7796 5.36678 12.7796 7.99616C12.7796 10.6197 10.6528 12.7524 8.02337 12.7524C7.11185 12.7524 6.25876 12.4953 5.54007 12.0513C5.18364 12.0922 4.82721 12.1097 4.46494 12.1097C4.29549 12.1097 4.13189 12.1038 3.96244 12.098C3.97412 12.6414 4.02671 13.1965 4.11436 13.7808C5.23038 14.5346 6.57429 14.9786 8.02337 14.9786C11.8798 14.9786 15 11.8526 15 8.002C15 4.14558 11.8798 1.01953 8.02337 1.01953ZM7.10017 2.66728C7.2404 2.50367 7.38063 2.34591 7.52671 2.18815C7.1995 1.90768 6.85476 1.65643 6.49249 1.42855C6.27045 1.8025 6.07763 2.19399 5.91402 2.59132C6.22955 2.70818 6.53339 2.84257 6.83723 2.98865C6.97162 2.80751 7.07095 2.70234 7.10017 2.66728ZM2.36144 6.65225L2.39065 6.69315L2.43155 6.66394C2.75292 6.43022 3.09182 6.21402 3.4424 6.0212L3.47746 6.00952L3.46578 5.96861C3.3606 5.57713 3.2788 5.16811 3.22621 4.75325L3.22037 4.70651L3.17362 4.7182C2.65943 4.81169 2.14524 4.95192 1.65442 5.12721L1.60768 5.14474L1.62521 5.19148C1.82972 5.69399 2.07513 6.18481 2.36144 6.65225ZM2.27963 7.32421L2.23873 7.35342C1.86477 7.65726 1.50835 7.99616 1.18114 8.35843L1.14608 8.39349L1.18114 8.4227C1.54341 8.73823 1.93489 9.03038 2.34391 9.28748L2.38481 9.31669L2.40818 9.27579C2.58932 8.94858 2.79967 8.62721 3.0217 8.31753L3.04508 8.28831L3.0217 8.2591C2.76461 7.97279 2.52504 7.67479 2.30301 7.35926L2.27963 7.32421ZM5.02003 11.724L5.14274 11.7182L5.04925 11.6422C4.67529 11.3384 4.35392 10.982 4.09099 10.573V10.5613L4.01502 10.5262L4.00334 10.5905C3.95659 10.9411 3.92738 11.3033 3.92154 11.6773V11.724H3.96828C4.13189 11.7357 4.30134 11.7357 4.46494 11.7357C4.64608 11.7416 4.83306 11.7357 5.02003 11.724ZM4.78631 4.01703C4.86227 3.67229 4.95576 3.33339 5.06678 3.00033C4.62855 2.87763 4.17863 2.78414 3.72871 2.71987C3.68781 3.17562 3.68197 3.63138 3.71119 4.0813C4.06761 4.0404 4.42988 4.02287 4.78631 4.01703ZM5.45826 3.99366C5.7621 3.80083 6.08932 3.63723 6.43406 3.51452C6.18865 3.4035 5.94324 3.29833 5.68614 3.20484C5.5985 3.46194 5.52254 3.73072 5.45826 3.99366ZM2.21536 9.66144L2.1803 9.63806C1.81803 9.41018 1.47329 9.15893 1.14608 8.89015L1.05259 8.81419L1.07012 8.93689C1.15776 9.60885 1.34474 10.2574 1.61937 10.8768L1.66611 10.9878L1.70701 10.8768C1.8414 10.4795 2.01085 10.088 2.19783 9.71402L2.21536 9.66144ZM3.10935 3.04123C2.69449 3.45609 2.32638 3.9177 2.02838 4.42604C2.39065 4.32087 2.75292 4.23322 3.12104 4.16895C3.09766 3.79499 3.09182 3.42103 3.10935 3.04123ZM3.3197 7.93773L3.32554 7.81502C3.34307 7.38848 3.41319 6.97362 3.54174 6.57045L3.57679 6.45359L3.47162 6.51202C3.197 6.66978 2.92821 6.84507 2.67112 7.03205L2.63022 7.06127L2.65943 7.10217C2.84057 7.35926 3.03339 7.61052 3.2379 7.85008L3.3197 7.93773ZM3.36644 8.65058L3.34891 8.53372L3.2788 8.6389C3.08598 8.91352 2.90484 9.19399 2.74124 9.48614L2.71786 9.52704L2.75876 9.55042C3.05092 9.71402 3.3606 9.86594 3.67028 10.0003L3.7813 10.0471L3.72871 9.93606C3.54758 9.52704 3.42488 9.09466 3.36644 8.65058ZM2.00501 6.98531L2.04007 6.95609L2.01669 6.92103C1.8005 6.57045 1.60184 6.20234 1.42654 5.82838L1.37396 5.7232L1.3389 5.84007C1.13439 6.47112 1.02337 7.13138 1.00584 7.7975L1 7.9202L1.08765 7.83255C1.37396 7.52871 1.68364 7.23656 2.00501 6.98531Z" fill="white"/>\n</svg>\n'}),Mt={Python:{CondaPackages:{title:h.LibManagement.condaTitle,icon:St,supportedConnectionType:[w.IAM],additionalDescription:[N().createElement("div",{key:"conda-desc-1"},h.LibManagement.condaDescription1),N().createElement("div",{key:"conda-desc-2"},h.LibManagement.condaDescription2),N().createElement("div",{key:"conda-desc-3"},h.LibManagement.condaDescription3," ",(xt=h.LibManagement.condaLinkText,"https://docs.conda.io/projects/conda-build/en/latest/resources/package-spec.html",N().createElement((({href:e,children:t})=>N().createElement("a",{target:"_blank",style:wt.linkColor,rel:"noopener noreferrer",href:e},t)),{href:"https://docs.conda.io/projects/conda-build/en/latest/resources/package-spec.html"},xt))),N().createElement((({children:e})=>N().createElement("div",{style:wt.importantNote},e)),{key:"conda-desc-4"},h.LibManagement.importantNotes),N().createElement("div",{key:"conda-desc-5"},h.LibManagement.note1),N().createElement("div",{key:"conda-desc-6"},h.LibManagement.note2),N().createElement("div",{key:"conda-desc-7"},h.LibManagement.note3),N().createElement("div",{key:"conda-desc-8"},h.LibManagement.note4),N().createElement("div",{key:"conda-desc-9"},h.LibManagement.note5)]}}};var xt;class Lt extends W.DocumentManager{constructor(e){super(e),this.autosave=!1}async exist(e){try{return await this.services.contents.get(e),!0}catch(e){if(e&&"object"==typeof e&&"response"in e&&e.response&&"object"==typeof e.response&&"status"in e.response&&404===e.response.status)return!1;throw e}}async _openOrReveal(e,t){return super.openOrReveal(e,t)}async openOrCreate(e,t="default"){try{await this.services.contents.get(e)}catch(t){if(!(t&&"object"==typeof t&&"response"in t&&t.response&&"object"==typeof t.response&&"status"in t.response&&404===t.response.status))throw t;{const t=(new Date).toISOString(),n={created:t,last_modified:t,mimetype:"application/json",writable:!0,type:"file",format:"text",name:e,path:e,content:JSON.stringify(E)};await this.services.contents.save(e,n)}}return this._openOrReveal(e,t)}}var kt=n(34882),Tt=n(74901);class jt extends Ct.ReactWidget{constructor(e){super(),this._selectedType="Python",this._selectedSource="CondaPackages",this._handleSelectTypeSignal=new Tt.Signal(this),this._handleSelectSourceSignal=new Tt.Signal(this),this._isSaving=!1,this.addClass("jp-PluginList"),this._updateSpace=e.updateSpace,this._onCheckUpdateSpace=t=>{this._updateSpace=t,e.onCheckUpdateSpace(t),this.update()},this._onSave=e.onSave,this._schema=e.schema,this._evtMousedown=this._evtMousedown.bind(this),this._onSave=this._onSave.bind(this),this.setError=this.setError.bind(this),this._errors={}}get handleSelectTypeSignal(){return this._handleSelectTypeSignal}get handleSelectSourceSignal(){return this._handleSelectSourceSignal}mapConfig(e,t,n){const a=n.title,s=Mt[e][t];return N().createElement("div",{onClick:this._evtMousedown,className:`${e===this._selectedType&&t===this._selectedSource?"jp-mod-selected jp-PluginList-entry":"jp-PluginList-entry"} ${this.hasError(e,t)?"jp-ErrorPlugin":""}`,"data-selected-type":e,"data-selected-source":t},N().createElement("div",{className:"jp-PluginList-entry-label",role:"tab"},N().createElement("div",{className:"jp-SelectedIndicator"}),N().createElement(Ct.LabIcon.resolveReact,{icon:s.icon,iconClass:"jp-Icon",tag:"span",stylesheet:"settingsEditor"}),N().createElement("span",{className:"jp-PluginList-entry-label-text"},a)))}render(){let e=[];if(this._schema.properties){const t=this._schema.properties;e=Object.keys(t).map((e=>{const n=t[e].properties,a=n?Object.keys(n).map((t=>this.mapConfig(e,t,n[t]))):[];return N().createElement("div",{key:e},N().createElement("h1",{className:"jp-PluginList-header"},e),N().createElement("ul",null,a))}))}return N().createElement("div",{className:"jp-PluginList-wrapper"},N().createElement("div",{className:"jp-SettingsHeader"},N().createElement("h3",null,h.LibManagement.environmentManagement)),e,N().createElement("div",{className:"jp-PluginList-entry",style:wt.pluginListEntry},N().createElement("div",{className:"jp-PluginList-entry"},N().createElement("div",{className:"jp-PluginList-entry-label"},N().createElement("input",{type:"checkbox",className:"jp-mod-styled jp-pluginmanager-Disclaimer-checkbox",checked:this._updateSpace,onChange:e=>this._onCheckUpdateSpace(e.target.checked)}),N().createElement("span",null,h.LibManagement.installInCurrentSession))),N().createElement("div",{className:"jp-PluginList-entry"},N().createElement(Ct.Button,{className:"jp-mod-styled jp-mod-reject jp-ArrayOperationsButton",disabled:this._isSaving||this.hasErrors,onClick:()=>this.onSave()},this._isSaving?h.LibManagement.saving:h.LibManagement.saveAllChanges)),this.hasErrors&&N().createElement("div",{className:"jp-PluginList-entry"},N().createElement("div",{className:"jp-PluginList-entry-label"},N().createElement(Ct.LabIcon.resolveReact,{icon:Ct.errorIcon,iconClass:"jp-Icon",tag:"span",stylesheet:"settingsEditor"}),N().createElement(bt,null,h.LibManagement.resolveErrors)))))}_evtMousedown(e){const t=e.currentTarget,n=t.getAttribute("data-selected-type"),a=t.getAttribute("data-selected-source");n&&a&&(this._selectedType=n,this._handleSelectTypeSignal.emit(n),this._selectedSource=a,this._handleSelectSourceSignal.emit(a),this.update())}async onSave(){if(this.hasErrors||this._isSaving)this.update();else{this._isSaving=!0,this.update();try{await this._onSave()}finally{this._isSaving=!1,this.update()}}}hasError(e,t){return!!this._errors[e]&&this._errors[e][t]}get hasErrors(){for(const e in this._errors)for(const t in this._errors[e])if(this._errors[e][t])return!0;return!1}setError(e,t,n){this._errors[e]||(this._errors[e]={}),this._errors[e][t]!==n?(this._errors[e][t]=n,this.update()):this._errors[e][t]=n}}var _t=n(21761),Nt=n.n(_t);const Rt=e=>e.map((e=>"pattern"===e.name?{...e,message:h.LibManagement.invalidInput}:e)),It=({schema:e,config:t,onChange:n,hasError:a,selectedType:s,selectedSource:i})=>N().createElement(N().Fragment,null,N().createElement("div",{className:"jp-SettingsHeader"},N().createElement("h2",{className:"jp-SettingsHeader-title"},Mt[s][i].title),(()=>{const e=Mt[s][i];return N().createElement("div",{className:"jp-SettingsHeader-description"},e.additionalDescription&&e.additionalDescription.length>0&&N().createElement("div",null,e.additionalDescription))})()),Array.isArray(e.type)&&e.type.includes("object")&&e.properties?N().createElement(Dt,{properties:e.properties,config:t,onChange:n,hasError:a}):N().createElement(Ct.FormComponent,{schema:e,validator:Nt(),formData:t,onChange:e=>{a(0!==e.errors.length),n(e.formData)},liveValidate:!0,tagName:"div",translator:Ae.nullTranslator,showErrorList:!1,transformErrors:Rt})),Dt=({properties:e,config:t,onChange:n,hasError:a})=>{const[s,i]=(0,_.useState)(null!=t?t:{}),[o,r]=(0,_.useState)({}),l=(0,_.useRef)(!1);(0,_.useEffect)((()=>{l.current=!0}),[]),(0,_.useEffect)((()=>{l.current?l.current=!1:n(s)}),[s]),(0,_.useEffect)((()=>{let e=!1;Object.keys(o).forEach((t=>e=e||o[t])),a(e)}),[o]);const c=(0,_.useMemo)((()=>{const n=[];return Object.keys(e).map((a=>{n.push(N().createElement(Ct.FormComponent,{schema:e[a],validator:Nt(),formData:t?t[a]:{},onChange:e=>{r((t=>({...t,[a]:0!==e.errors.length}))),i((t=>{const n=JSON.parse(JSON.stringify(t));return n[a]=e.formData,n}))},liveValidate:!0,tagName:"div",translator:Ae.nullTranslator,showErrorList:!1,transformErrors:Rt}))})),n}),[]);return N().createElement(N().Fragment,null,c)},Pt=({schema:e,configs:t,handleSelectTypeSignal:n,handleSelectSourceSignal:a,onConfigsChange:s,setError:i})=>{const[o,r]=(0,_.useState)("Python"),[l,c]=(0,_.useState)("CondaPackages");(0,_.useEffect)((()=>{var e,t;const s=(e,t)=>{r(t)};null===(e=null==n?void 0:n.connect)||void 0===e||e.call(n,s);const i=(e,t)=>{c(t)};return null===(t=null==a?void 0:a.connect)||void 0===t||t.call(a,i),()=>{var e,t;null===(e=null==n?void 0:n.disconnect)||void 0===e||e.call(n,s),null===(t=null==a?void 0:a.disconnect)||void 0===t||t.call(a,i)}}),[]);const d=(0,_.useMemo)((()=>o&&l?e.properties[o].properties[l]:{}),[o,l,e]),p=(0,_.useMemo)((()=>o&&l?t[o][l]:{}),[o,l,t]),u=(0,_.useCallback)((e=>{i(o,l,e)}),[i,o,l]);return N().createElement("div",{className:"jp-SettingsPanel"},N().createElement("div",{className:"jp-SettingsForm"},N().createElement(It,{schema:d,config:p,onChange:e=>{const n=JSON.parse(JSON.stringify(t));n[o][l]=e,s(n)},hasError:u,selectedType:o,selectedSource:l})))},Ut={type:"string",pattern:x},At={type:"string",pattern:x},Bt={title:h.LibManagement.libraryManagementConfiguration,description:h.LibManagement.libraryManagementConfiguration,type:["object","null"],properties:{Python:{type:"object",title:"Python",properties:{CondaPackages:{title:h.LibManagement.condaPackagesTitle,type:["object","null"],properties:{Channels:{title:h.LibManagement.packageChannelsTitle,type:["array","null"],items:At},PackageSpecs:{title:h.LibManagement.packageSpecsTitle,type:["array","null"],items:Ut}}}}}}};var Ot=n(95366);const Ft=new class{constructor(){this.baseUrl=K.PageConfig.getBaseUrl(),this.settings=Z.ServerConnection.makeSettings({baseUrl:this.baseUrl})}async sendMetric(e,t){const n=`${this.baseUrl}aws/sagemaker/api/add-metrics`,a={metric:e,...t&&{output:t}},s={method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}},i=await Z.ServerConnection.makeRequest(n,s,this.settings);if(!i.ok)throw new Error(`Failed to send metric: ${i.statusText}`)}};class $t{constructor(e,t,n){this.createTerminal=e,this.openTerminal=t,this.logger=n,this.startTime=Date.now()}extractPackageConfig(e){const t=e.Python;if(!(null==t?void 0:t.CondaPackages))return null;const n=t.CondaPackages,a=n.PackageSpecs||[],s=n.Channels||[];return a.length>0?{packages:a,channels:s}:null}buildInstallCommand({packages:e,channels:t}){return`micromamba install --freeze-installed -y ${t.map((e=>`-c "${e}"`)).join(" ")} ${e.map((e=>`"${e}"`)).join(" ")}`}createTerminalWidget(e,t){const n=new Ot.Terminal(e);return n.id=`${t}${Date.now()}`,n.title.closable=!0,n}async restartServer(){const e=await this.createTerminal(),t=this.createTerminalWidget(e,"restartServer");this.openTerminal(t),e.send({type:"stdin",content:["restart-jupyter-server\n"]})}recordInstallationMetric(e,t){!function(e,t,n="Extension Management"){const a={_aws:{Timestamp:Date.now(),CloudWatchMetrics:[{Namespace:n,Dimensions:[["Operation"]],Metrics:[]}]},Operation:e};void 0!==t.latency&&(a._aws.CloudWatchMetrics[0].Metrics.push({Name:"Latency",Unit:"Milliseconds"}),a.Latency=t.latency),void 0!==t.success&&(a._aws.CloudWatchMetrics[0].Metrics.push({Name:"Success",Unit:"Count"}),a.Success=t.success),void 0!==t.error&&(a._aws.CloudWatchMetrics[0].Metrics.push({Name:"Error",Unit:"Count"}),a.Error=t.error),Object.keys(t).forEach((e=>{["latency","success","error","output"].includes(e.toLowerCase())||(a._aws.CloudWatchMetrics[0].Metrics.push({Name:e,Unit:"None"}),a[e]=t[e])})),async function(e,t){const n=JSON.parse(e);await Ft.sendMetric(n,t)}(JSON.stringify(a),t.output)}("Package Installation",{latency:Date.now()-this.startTime,success:e?1:0,error:e?0:1,output:t})}handleTerminalView(e,t=!0){e.terminal.isDisposed?I.Notification.error(h.LibManagement.terminalDisposed):(e.opened=!0,this.openTerminal(e.widget),t&&(e.warningNotificationId=I.Notification.warning(h.LibManagement.terminalWarning,{autoClose:!1,actions:[]})))}getSuccessMessage(e){return e.alreadyInstalled?h.LibManagement.allInstalled:h.LibManagement.installSuccess}createRestartAction(){return{label:"Restart Server",callback:()=>this.restartServer()}}createViewTerminalAction(e,t=!0){return{label:"View in terminal",callback:()=>this.handleTerminalView(e,t)}}handleInstallationSuccess(e,t){if(t.opened){const t=this.getSuccessMessage(e),n=e.alreadyInstalled?[]:[this.createRestartAction()];I.Notification.success(t,{actions:n,autoClose:!1})}else{const t=e.alreadyInstalled?[]:[this.createRestartAction()];I.Notification.success(this.getSuccessMessage(e),{actions:t,autoClose:!1})}}handleInstallationError(e,t){this.recordInstallationMetric(!1,e.message),t.opened&&I.Notification.error(h.LibManagement.installFailed,{autoClose:!1,actions:[]})}setupNotificationHandlers(e,t){I.Notification.promise(e,{pending:{message:h.LibManagement.installing,options:{actions:[this.createViewTerminalAction(t)],autoClose:!1}},success:{message:e=>{const n=e;return this.recordInstallationMetric(!0,n.output),t.warningNotificationId&&I.Notification.dismiss(t.warningNotificationId),this.getSuccessMessage(n)},options:{actions:[],autoClose:1}},error:{message:e=>{const n=e instanceof Error?e.message:String(e);return this.recordInstallationMetric(!1,n),t.warningNotificationId&&I.Notification.dismiss(t.warningNotificationId),h.LibManagement.installFailed},options:{actions:[this.createViewTerminalAction(t,!1)],autoClose:!1}}}),e.then((e=>this.handleInstallationSuccess(e,t))).catch((e=>this.handleInstallationError(e,t))).finally((()=>{t.warningNotificationId&&I.Notification.dismiss(t.warningNotificationId)}))}async install(e){var t;if(!e.Python)return;const n=this.extractPackageConfig(e);if(!n)return;null===(t=this.logger)||void 0===t||t.info({Message:"Installing packages and extensions from config"});const a=await this.createTerminal(),s={terminal:a,widget:this.createTerminalWidget(a,"installLab"),opened:!1},i=function(e,t,n){let a,s=S.RUNNING,i=t.length,o=!1,r="";function l(e,t){"stdout"===t.type&&t.content&&t.content.forEach((t=>{if(s===S.RUNNING&&"string"==typeof t){const a=t.replace(L,"").trim();a&&(r+=a+"\n"),t.includes("All requested packages already installed")&&(o=!0),!t.includes(M)&&t.includes("EXIT_CODE:")&&(t.includes("EXIT_CODE: 0")?(i--,i||(s=S.SUCCESS,null==n||n.info({Message:h.LibManagement.successfullyInstalledPackages}))):(s=S.FAILURE,e.messageReceived.disconnect(l),null==n||n.error({Message:h.LibManagement.failedToInstallPackages})))}else s===S.RUNNING&&(s=S.FAILURE,e.messageReceived.disconnect(l))}))}e.messageReceived.connect(l);let c=t.join(`;${M};`);return c+=`;${M}\n;`,e.send({type:"stdin",content:[c]}),new Promise(((t,n)=>{a=window.setInterval((()=>{if(s===S.SUCCESS){clearInterval(a),e.messageReceived.disconnect(l);try{e.shutdown().catch((()=>{}))}catch{}t({alreadyInstalled:o,output:r})}else s===S.FAILURE&&(clearInterval(a),e.messageReceived.disconnect(l),n(new Error(r)))}),1e3)}))}(a,[this.buildInstallCommand(n)],this.logger);return this.setupNotificationHandlers(i,s),i}}async function zt(e,t,n,a){return new $t(t,n,a).install(e)}class Gt extends kt.SplitPanel{constructor(e,t,n,a){super({orientation:"horizontal",renderer:kt.SplitPanel.defaultRenderer,spacing:1}),this._config={},this._updateSpace=!1,this._context=e,this._createTerminal=t,this._openTerminal=n,this._logger=a,this.onCheckUpdateSpace=this.onCheckUpdateSpace.bind(this),this.onChange=this.onChange.bind(this),this.onSave=this.onSave.bind(this),this._initialize().then((()=>{this.addClass("jp-SettingsPanel");const e=new jt({schema:Bt,updateSpace:this._updateSpace,onCheckUpdateSpace:this.onCheckUpdateSpace,onSave:this.onSave});e.handleSelectSourceSignal.connect((()=>{this.update()})),this.addWidget(e);const t=I.ReactWidget.create(N().createElement(Ct.UseSignal,{signal:e.handleSelectSourceSignal},(()=>N().createElement(Pt,{schema:Bt,configs:this._config,handleSelectTypeSignal:e.handleSelectTypeSignal,handleSelectSourceSignal:e.handleSelectSourceSignal,onConfigsChange:this.onChange,setError:e.setError}))));this.addWidget(t)})).catch((e=>{var t,n;null===(t=this._logger)||void 0===t||t.error({Message:"Error loading widget due to corrupt configuration file",Error:e}),this.addWidget(I.ReactWidget.create(N().createElement("div",{className:"jp-PluginList-entry-label"},N().createElement(Ct.LabIcon.resolveReact,{icon:Ct.errorIcon,iconClass:"jp-Icon",tag:"span",stylesheet:"settingsEditor"}),(n=this._context.path,N().createElement(N().Fragment,null,N().createElement(bt,null,h.LibManagement.corruptedConfigTitle.replace("{path}",n),N().createElement("br",null),N().createElement("br",null),h.LibManagement.corruptedConfigBody,N().createElement("br",null),N().createElement("br",null),h.LibManagement.corruptedConfigNote))))))}))}onCheckUpdateSpace(e){this._updateSpace=e;const t=JSON.parse(JSON.stringify(this._config));t.ApplyChangeToSpace=e,this._context.model.fromJSON(t)}onChange(e){this._context.model.fromJSON(e),this._config=e,this.update()}async onSave(){var e;try{await this._context.save(),null===(e=this._logger)||void 0===e||e.info({Message:h.LibManagement.savedPackageConfigurations}),this._updateSpace&&this._config.Python&&await zt(this._config,this._createTerminal,this._openTerminal,this._logger)}catch(e){}}async _initialize(){var e;await this._context.ready,this._context.model.contentChanged.connect(this.onContentChange,this),this._config=this._context.model.toJSON(),this._updateSpace=null!==(e=this._config.ApplyChangeToSpace)&&void 0!==e&&e}onContentChange(){this._config=this._context.model.toJSON()}}class Vt extends V.DocumentWidget{constructor(e,t,n,a){super({content:new Gt(e,t,n,a),context:e}),this.title.icon=Et}}class Zt extends V.ABCWidgetFactory{constructor(e,t,n,a){super(e),this._createTerminal=t,this._openTerminal=n,this._logger=a}createNewWidget(e){return new Vt(e,this._createTerminal,this._openTerminal,this._logger)}}const Wt=[k,J,be,et,nt,dt,vt,{id:l,autoStart:!0,requires:[He.ILogger],optional:[ft.ILauncher,W.IDocumentWidgetOpener],activate:async(e,t,n,a)=>{const s=$e(t,l);try{const e=await ee("aws/sagemaker/api/is-md-environment",X.GET);if((await e.json()).isMaxDomeEnvironment)return}catch(e){return void s.error({Message:h.LibManagement.unableToFetchEnvironment})}const{commands:i,docRegistry:o}=e,r=async()=>await e.serviceManager.terminals.startNew(),c=t=>{e.shell.add(t,"main",{activate:!0})};o.addFileType({name:b.fileType.name,pattern:b.fileType.pattern,mimeTypes:b.fileType.mimeTypes,displayName:h.LibManagement.libraryConfiguration,icon:Et});const d=new Zt({name:b.factory.name,fileTypes:[b.fileType.name],defaultFor:[b.fileType.name]},r,c,s);o.addWidgetFactory(d);const p=new Lt({registry:o,manager:e.serviceManager,opener:a});e.restored.then((async()=>{try{const t=await ee(Y,X.GET);if(!(await t.json()).exists)try{const t=await e.serviceManager.contents.get(b.fileType.pattern,{content:!0});if(t.content){const e=JSON.parse(t.content);try{await zt(e,r,c,s)}catch(e){}await ee(Y,X.POST)}}catch(e){await ee(Y,X.POST)}}catch(e){}}));const u=C.EDIT_LIBRARY_CONFIG;i.addCommand(u,{label:h.LibManagement.environmentManagement,icon:e=>e.isPalette?void 0:Et,execute:async()=>{try{await p.openOrCreate(b.fileType.pattern,b.factory.name)}catch(e){(0,I.showErrorMessage)(h.LibManagement.failedToOpenConfig,e.message)}}}),n&&(n.add({command:u,category:b.launcher.category,rank:b.launcher.rank}),s.info({Message:h.LibManagement.successfullyLoaded}))}}]},4147:e=>{e.exports=JSON.parse('{"name":"@amzn/sagemaker-jupyterlab-extensions","description":"SageMaker JupyterLab workspace primary extension module","version":"0.5.1","author":"Amazon","homepage":"https://aws.amazon.com/sagemaker/","license":"Amazon Software License","licenses":[{"type":"Amazon Software License","url":"http://aws.amazon.com/asl"}],"directories":{"test":"__tests__"},"files":["lib/**/*.{d.ts,eot,gif,html,jpg,js,js.map,json,png,svg,woff2,ttf}","style/**/*.{css,js,eot,gif,html,jpg,json,png,svg,woff2,ttf}","schema/*.json"],"scripts":{"copy-assets":"mkdir -p lib/plugins/LibManagementPlugin/icons && cp -r src/plugins/LibManagementPlugin/icons/* lib/plugins/LibManagementPlugin/icons/","build":"tsc && npm run copy-assets","build:labextension":"tsc && jupyter labextension build .","build:labextension:dev":"jupyter labextension build --development True --source-map True .","lint:check":"eslint . --ext .js,.ts,.tsx","lint:fix":"eslint --fix . --ext .js,.ts,.tsx","release":"run-s build","install:extension":"jlpm run build","watch:src":"tsc -w","watch:labextension":"jupyter labextension watch .","watch":"run-p watch:src watch:labextension","dev:setup":"run-s -n dev:docker:build dev:docker:reset dev:docker:create","dev:docker:build":"(cd devSetup ; sh pull-jupyterlab-base-image.sh && docker build . --tag jupyterlab_ext_dev_image --build-arg CONTAINER_USER_ID=$(id -u) --build-arg CONTAINER_GROUP_ID=$(id -g))","dev:docker:reset":"docker stop jupyterlab_ext_dev_container || true && docker rm jupyterlab_ext_dev_container || true","dev:docker:create":"docker create --name jupyterlab_ext_dev_container --publish 8888:8888 --volume $(pwd):/sagemaker-studio-extension jupyterlab_ext_dev_image","dev:start":"docker start jupyterlab_ext_dev_container --attach","test":"jest","test:watch":"jest --watch"},"main":"lib/index.js","dependencies":{"@amzn/sagemaker-jupyterlab-extension-common":"^0.2.0","@emotion/css":"^11.1.3","@emotion/styled":"^11.11.0","@jupyterlab/application":"^4.0.5","@jupyterlab/apputils":"^4.0.5","@jupyterlab/coreutils":"^6.0.5","@jupyterlab/docmanager":"^4.0.5","@jupyterlab/docregistry":"^4.0.5","@jupyterlab/filebrowser":"^4.0.5","@jupyterlab/git":"^0.51.1","@jupyterlab/launcher":"^4.0.5","@jupyterlab/mainmenu":"^4.0.5","@jupyterlab/services":"^7.0.0","@jupyterlab/statusbar":"^4.0.5","@jupyterlab/terminal":"^4.0.5","@jupyterlab/translation":"^4.0.5","@jupyterlab/ui-components":"^4.0.5","@lumino/algorithm":"^2.0.0","@lumino/commands":"^2.0.0","@lumino/coreutils":"^2.2.0","@lumino/polling":"^2.1.2","@lumino/signaling":"^2.1.2","@lumino/widgets":"^2.0.0","@mui/icons-material":"5.14","@mui/material":"^5.14.4","@rjsf/core":"^5.24.10","@rjsf/utils":"^5.24.10","@rjsf/validator-ajv8":"^5.24.10","cookie":"0.6.0","isomorphic-fetch":"^3.0.0","json-schema":"^0.4.0","moment":"^2.29.4","p-retry":"^5.1.2","react":"^18.2.0","react-dom":"^18.2.0","shell-escape":"^0.2.0"},"jupyterlab":{"extension":true,"outputDir":"sagemaker_jupyterlab_extension/labextension","disabledExtensions":["@jupyterlab/git:clone"],"sharedPackages":{"@amzn/sagemaker-jupyterlab-extension-common":{"bundled":false,"singleton":true,"strictVersion":false}}},"style":"src/style/index.css","devDependencies":{"@babel/preset-env":"^7.22.7","@babel/preset-react":"^7.22.5","@jupyterlab/builder":"^4.0.5","@types/jest":"^27.5.2","@types/lodash":"^4.14.172","@types/react":"^18.2.21","@types/react-dom":"^18.2.7","@types/shell-escape":"^0.2.3","@typescript-eslint/eslint-plugin":"^5.61.0","eslint-config-prettier":"^8.8.0","eslint-plugin-import":"^2.27.5","eslint-plugin-json":"^3.1.0","eslint-plugin-prettier":"^4.2.1","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","jest":"^27.2.4","npm-run-all":"^4.1.5","prettier":"^2.4.1","ts-jest":"^27.0.5","typescript":"^4.3.5","@testing-library/jest-dom":"^6.6.3","@testing-library/react":"^13.0.0"}}')}}]);