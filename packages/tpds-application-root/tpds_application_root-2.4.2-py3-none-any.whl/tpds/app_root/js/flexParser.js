ws=new WebSocket("ws://localhost:1302/websocket");var formNameMain=slotdataform,keyLoadConfig={0:"noLoad",1:"noLoad",2:"noLoad",3:"noLoad",4:"noLoad",5:"load",6:"load",7:"noLoad",8:"load",9:"load",10:"cert",11:"noLoad",12:"cert",13:"load",14:"load",15:"load"},slotsize={0:"32",1:"32",2:"32",3:"32",4:"32",5:"32",6:"32",7:"32",8:"416",9:"64",10:"64",11:"64",12:"64",13:"64",14:"64",15:"64",16:"64"},tflexSlotType={0:"private",1:"private",2:"private",3:"private",4:"private",5:"secret",6:"secret",7:"general",8:"general",9:"secret",10:"cert",11:"cert",12:"cert",13:"public",14:"public",15:"public"};function verify_slot_data_bytes(e,t){var a=e.replaceAll(" ","").replaceAll("\n","").replaceAll("\r","").replaceAll("\t","").replaceAll("0x","").replaceAll(",","").toUpperCase(),o=!1;return 2*slotsize[t]==a.length?is_hex(a)?(prettyPrintHex(a,32),o=!0):(alert("Error: Data contains non-hex characters"),o=!1):(16!=t?alert("The slot"+t+"expects: "+slotsize[t]+"bytes\nYou have entered: "+a.length/2+"bytes"):alert("The custom root expects: "+slotsize[t]+"bytes\nYou have entered: "+a.length/2+"bytes"),o=!1),o}function get_clean_slot_data_bytes(e){return e.replaceAll(" ","").replaceAll("\n","").replaceAll("\r","").replaceAll("\t","").replaceAll("0x","").replaceAll(",","").toUpperCase()}function gererateXML(e){var t,a=[5,6,9];let o={base_xml:"ECC608B_TFLXTLS.xml"};Object.assign(o,{xml_type:e}),devIface=getFormRadioValue(formNameMain,"devIface"),Object.assign(o,{interface:devIface}),otp_data="i2c"==devIface?"4D4B4D7779685031":"4B5170325A6B4438";for(var l=[],r=0;r<16;r++){let e={slot_id:r};Object.assign(e,{slot_type:tflexSlotType[r]}),Object.assign(e,{key_load_config:keyLoadConfig[r]});var n=document.getElementById("slotlock"+r.toString()),s=null!=n?n.checked?"enabled":"disabled":null;if(Object.assign(e,{slot_lock:s}),"load"==keyLoadConfig[r]&&(slot_data_bytes=getFormDataSlot(formNameMain,r),null!=slot_data_bytes)){if(!verify_slot_data_bytes(slot_data_bytes,r))return;slot_data_bytes=get_clean_slot_data_bytes(slot_data_bytes),slotValidateDict[r]="valid"}if("noLoad"==keyLoadConfig[r]);else if("load"==keyLoadConfig[r])Object.assign(e,{data:slot_data_bytes});else if("cert"==keyLoadConfig[r]){var c=getFormRadioValue(formNameMain,"slot"+r+"certopt");if("custCert"==c){if(""==document.getElementById(r+"certname").value||""==document.getElementById(r+"certcommonname").value||""==document.getElementById(r+"certyear").value)return void alert("For Custom Certificates, all certificate fields to be populated!. Please verify fields in Slot"+r+".");if(12==r){if(""==document.getElementById("16certname").value||""==document.getElementById("16certcommonname").value)return void alert("For Custom Certificates, all certificate fields to be populated!. Please verify Custom root Information.");if(slot16_data_bytes=getFormDataSlot(formNameMain,16),null==slot16_data_bytes)return void alert("Custom root public key data is not complete... Please check and try again.");if(!verify_slot_data_bytes(slot16_data_bytes,16))return;slot16_data_bytes=get_clean_slot_data_bytes(slot16_data_bytes)}}Object.assign(e,{cert_type:c}),"custCert"==c&&(Object.assign(e,{cert_org:document.getElementById(r+"certname").value}),Object.assign(e,{cert_cn:"sn0123030405060708EE"}),10==r&&is_custom_pr_selected()?Object.assign(e,{cert_cn:document.getElementById(r+"certcommonname").value+"-0123030405060708EE"}):Object.assign(e,{cert_cn:document.getElementById(r+"certcommonname").value}),12==r&&Object.assign(e,{cert_cn:document.getElementById(r+"certcommonname").value}),Object.assign(e,{cert_expiry_years:document.getElementById(r+"certyear").value}),12==r&&(Object.assign(e,{signer_ca_org:document.getElementById("16certname").value}),Object.assign(e,{signer_ca_cn:document.getElementById("16certcommonname").value}),Object.assign(e,{signer_ca_pubkey:slot16_data_bytes})))}else console.error("Config Error");a.includes(r)&&null!=(status=getFormRadioValue(formNameMain,"slot"+r+"dataopt"))&&status,l.push(e)}Object.assign(o,{slot_info:l}),Object.assign(o,{sboot_latch:getFormRadioValue(formNameMain,"sbootLatchName")});var d=validateManIdText();t=d.status,Object.assign(o,{man_id:d.manId}),partNumberString=document.getElementById("partNumberId").value.toUpperCase(),""==partNumberString&&(partNumberString="ATECC608B-MAHAA-T"),Object.assign(o,{part_number:partNumberString}),Object.assign(o,{otp_zone:otp_data.padEnd(128,"0")});var i=validateUseCaseSlots(),u=validateSlotOpt();"proto_xml"==e&&getFormDataSlot(formNameMain,5)&&null==getFormDataSlot(formNameMain,6)&&(u=!1,alert("For Prototyping package, Slot5 has dependency on Slot6 as Encryption Key. \r\n\nIf Slot5 to be used, data for Slot6 also to be provided.\r\n")),0==i&&1==u&&1==t&&json_obj(JSON.stringify(o))}function setRadioValue(e,t,a){for(var o=e.elements[t],l=0;l<o.length;l++)o[l].value==a?o[l].checked=!0:o[l].checked=!1;return null}function getFormRadioValue(e,t){for(var a=e.elements[t],o=0;o<a.length;o++)if(1==a[o].checked)return a[o].value;return null}function getFormDataSlot(e,t){var a,o="slot"+t+"dataopt",l=null;return null!=(a=getFormRadioValue(e,o))?"unused"==a?l=null:"hexdata"==a||"pemdata"==a?l=document.getElementById(o+"id").value:(console.error("Unknown radio value"),l=null):console.error("Radio Value fetch error"),l}function getDataFromSlot(e){var t,a=null;return null!=(t=getFormRadioValue(formNameMain,e))?"unused"==t?a=null:"hexdata"==t?a=document.getElementById(e+"id").value:("pemdata"==t||console.error("Unknown radio value"),a=null):console.error("Radio Value fetch error"),a}String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)};