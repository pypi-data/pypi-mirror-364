Metadata-Version: 2.4
Name: docx-mcp
Version: 0.1.0
Summary: A MCP (Model Context Protocol) service for Word document processing, providing document structure extraction, content modification and file management capabilities.
Project-URL: Homepage, https://github.com/yourusername/docx_mcp
Project-URL: Repository, https://github.com/yourusername/docx_mcp
Project-URL: Issues, https://github.com/yourusername/docx_mcp/issues
Project-URL: Documentation, https://github.com/yourusername/docx_mcp#readme
Author-email: Your Name <your.email@example.com>
Maintainer-email: Your Name <your.email@example.com>
License: MIT
License-File: LICENSE
Keywords: document,docx,mcp,microsoft,office,processing,word
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.13
Classifier: Topic :: Office/Business :: Office Suites
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Text Processing :: General
Requires-Python: >=3.13
Requires-Dist: fastapi>=0.104.0
Requires-Dist: fastmcp>=0.2.0
Requires-Dist: mcp[cli]>=1.12.0
Requires-Dist: oss2>=2.19.1
Requires-Dist: python-docx>=1.1.0
Requires-Dist: requests>=2.31.0
Requires-Dist: uvicorn[standard]>=0.24.0
Description-Content-Type: text/markdown

# DOCX MCP æœåŠ¡

ä¸€ä¸ªåŸºäº MCP (Model Context Protocol) çš„ Word æ–‡æ¡£å¤„ç†æœåŠ¡ï¼Œæä¾›æ–‡æ¡£ç»“æ„æå–ã€å†…å®¹ä¿®æ”¹å’Œæ–‡ä»¶ç®¡ç†åŠŸèƒ½ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ“„ **æ–‡æ¡£ç»“æ„æå–**: ä» .docx æ–‡ä»¶ä¸­æå–æ®µè½ã€è¡¨æ ¼ç­‰ç»“æ„åŒ–å†…å®¹
- âœï¸ **å†…å®¹ä¿®æ”¹**: æ”¯æŒæ‰¹é‡ä¿®æ”¹æ–‡æ¡£ä¸­çš„æ–‡æœ¬å†…å®¹
- â˜ï¸ **äº‘å­˜å‚¨é›†æˆ**: è‡ªåŠ¨ä¸Šä¼ ä¿®æ”¹åçš„æ–‡æ¡£åˆ°é˜¿é‡Œäº‘ OSS
- ğŸ”— **URL æ”¯æŒ**: æ”¯æŒä» URL ç›´æ¥ä¸‹è½½å’Œå¤„ç†æ–‡æ¡£
- ğŸ› ï¸ **MCP å…¼å®¹**: å®Œå…¨å…¼å®¹ MCP åè®®ï¼Œå¯é›†æˆåˆ°æ”¯æŒ MCP çš„ AI åŠ©æ‰‹ä¸­

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- Python 3.13+
- uvx (æ¨è) æˆ– uv (Python åŒ…ç®¡ç†å™¨)

### ä¸ºä»€ä¹ˆé€‰æ‹© uvxï¼Ÿ

- ğŸš€ **å³å¼€å³ç”¨**: æ— éœ€æœ¬åœ°å®‰è£…ï¼Œç›´æ¥è¿è¡Œ
- ğŸ”’ **ç¯å¢ƒéš”ç¦»**: è‡ªåŠ¨ç®¡ç†ä¾èµ–ç¯å¢ƒï¼Œé¿å…å†²çª
- ğŸ“¦ **è½»é‡éƒ¨ç½²**: ç±»ä¼¼ npxï¼Œé€‚åˆå·¥å…·å‹åº”ç”¨
- ğŸ”„ **è‡ªåŠ¨æ›´æ–°**: æ¯æ¬¡è¿è¡Œä½¿ç”¨æœ€æ–°ç‰ˆæœ¬

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…æ–¹å¼

#### æ–¹å¼ä¸€ï¼šä»æœ¬åœ°è¿è¡Œ uvxï¼ˆå½“å‰æ¨èï¼‰

```bash
# åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ
uvx --from . docx-mcp

# æˆ–ä½¿ç”¨ uv tool run
uv tool run --from . docx-mcp
```

#### æ–¹å¼äºŒï¼šå‘å¸ƒåä½¿ç”¨ uvxï¼ˆæœªæ¥æ¨èï¼‰

```bash
# å‘å¸ƒåˆ° PyPI åå¯ä»¥ç›´æ¥è¿è¡Œ
uvx docx-mcp
```

#### æ–¹å¼ä¸‰ï¼šæœ¬åœ°å¼€å‘å®‰è£…

```bash
# ä½¿ç”¨ uv å®‰è£…ä¾èµ–
uv sync

# æˆ–ä½¿ç”¨ pip ä» pyproject.toml å®‰è£…
pip install -e .
```

### é…ç½® MCP æœåŠ¡

#### ä½¿ç”¨ uvx ä»æœ¬åœ°è¿è¡Œï¼ˆå½“å‰æ¨èé…ç½®ï¼‰

åœ¨ Cursor çš„ `mcp.json` é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

```json
{
  "mcpServers": {
    "docx_filler_service": {
      "command": "cmd",
      "args": [
        "/c",
        "uvx",
        "--from",
        "C:\\Users\\ä½ çš„ç”¨æˆ·å\\Desktop\\docx_mcp",
        "docx-mcp"
      ]
    }
  }
}
```

#### ä½¿ç”¨ uvx ä» PyPIï¼ˆå‘å¸ƒåï¼‰

```json
{
  "mcpServers": {
    "docx_filler_service": {
      "command": "cmd",
      "args": [
        "/c",
        "uvx",
        "docx-mcp"
      ]
    }
  }
}
```

#### ä½¿ç”¨æœ¬åœ° uvï¼ˆå¼€å‘æ¨¡å¼ï¼‰

```json
{
  "mcpServers": {
    "docx_filler_service": {
      "command": "cmd",
      "args": [
        "/c",
        "uv",
        "--directory",
        "C:\\Users\\ä½ çš„ç”¨æˆ·å\\Desktop\\docx_mcp",
        "run",
        "main.py"
      ]
    }
  }
}
```

### å¯åŠ¨æœåŠ¡

```bash
# ä½¿ç”¨ uvx ä»æœ¬åœ°è¿è¡Œï¼ˆå½“å‰æ¨èï¼‰
uvx --from . docx-mcp

# ä½¿ç”¨ uvx ä» PyPIï¼ˆå‘å¸ƒåï¼‰
uvx docx-mcp

# ä½¿ç”¨ uv è¿è¡Œï¼ˆå¼€å‘æ¨¡å¼ï¼‰
uv run main.py

# æˆ–ç›´æ¥è¿è¡Œ
python main.py
```

## ğŸ“¦ å‘å¸ƒåˆ° PyPI

å¦‚æœæ‚¨æƒ³è¦å‘å¸ƒåŒ…ä»¥ä¾¿å…¨å±€ä½¿ç”¨ uvxï¼š

### å¿«é€Ÿé…ç½®ï¼ˆæ¨èï¼‰

```bash
# 1. è¿è¡Œå‡­è¯é…ç½®è„šæœ¬
python setup_pypi_credentials.py

# 2. è¿è¡Œå‘å¸ƒè„šæœ¬
python publish.py
```

### æ‰‹åŠ¨é…ç½®

```bash
# 1. è®¾ç½® PyPI å‡­è¯
$env:TWINE_USERNAME = "your-pypi-username"
$env:TWINE_PASSWORD = "your-pypi-password"

# 2. æ„å»ºåŒ…
uv build

# 3. å‘å¸ƒåˆ° PyPI
pip install twine
twine upload dist/*
```

å‘å¸ƒåï¼Œä»»ä½•äººéƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š
```bash
uvx docx-mcp
```

## ğŸ”§ API åŠŸèƒ½

### 1. æå–æ–‡æ¡£ç»“æ„

```python
extract_document_structure(document_url: str) -> Dict
```

ä» URL ä¸‹è½½ .docx æ–‡ä»¶å¹¶æå–å…¶ç»“æ„ï¼Œä¸ºæ¯ä¸ªå…ƒç´ åˆ†é…å”¯ä¸€ IDã€‚

**å‚æ•°:**
- `document_url`: .docx æ–‡ä»¶çš„ URL é“¾æ¥

**è¿”å›:** åŒ…å«æ–‡æ¡£ç»“æ„çš„å­—å…¸ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰å”¯ä¸€çš„ ID

### 2. åº”ç”¨æ–‡æ¡£ä¿®æ”¹

```python
apply_modifications_to_document(
    original_file_content_base64: str, 
    patches_json: str
) -> str
```

å°†ä¸€ç³»åˆ—ä¿®æ”¹åº”ç”¨åˆ° .docx æ–‡ä»¶ï¼Œè¿”å›ä¿®æ”¹åçš„æ–‡ä»¶å†…å®¹ã€‚

**å‚æ•°:**
- `original_file_content_base64`: åŸå§‹ .docx æ–‡ä»¶çš„ Base64 ç¼–ç 
- `patches_json`: JSON æ ¼å¼çš„ä¿®æ”¹æŒ‡ä»¤åˆ—è¡¨

**ç¤ºä¾‹ä¿®æ”¹æŒ‡ä»¤:**
```json
[
  {
    "element_id": "p_0",
    "new_content": "æ–°çš„æ®µè½å†…å®¹"
  },
  {
    "element_id": "table_0_cell_0_0",
    "new_content": "æ–°çš„è¡¨æ ¼å•å…ƒæ ¼å†…å®¹"
  }
]
```

### 3. è·å–ä¿®æ”¹åçš„æ–‡æ¡£

```python
get_modified_document(
    original_file_content_base64: str, 
    patches_json: str
) -> str
```

`apply_modifications_to_document` çš„åˆ«åï¼Œç”¨äºæ›´æ¸…æ™°åœ°è¡¨è¾¾è·å–æœ€ç»ˆç»“æœçš„æ„å›¾ã€‚

### 4. å‡†å¤‡æ–‡æ¡£ä¸‹è½½

```python
prepare_document_for_download(
    original_file_content_base64: str, 
    patches_json: str
) -> Dict
```

å°†ä¿®æ”¹åçš„æ–‡æ¡£ä¸Šä¼ åˆ°é˜¿é‡Œäº‘ OSSï¼Œè¿”å›ä¸‹è½½é“¾æ¥ã€‚

**è¿”å›ç¤ºä¾‹:**
```json
{
  "success": true,
  "download_url": "https://ggb-lzt.oss-cn-shenzhen.aliyuncs.com/modified_document_xxx.docx",
  "file_name": "modified_document_xxx.docx"
}
```

### 5. ä» URL å¤„ç†æ–‡æ¡£

```python
process_document_from_url(
    document_url: str, 
    patches_json: str
) -> Dict
```

ç›´æ¥ä» URL ä¸‹è½½æ–‡æ¡£ï¼Œåº”ç”¨ä¿®æ”¹ï¼Œç„¶åä¸Šä¼ åˆ° OSSã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
docx_mcp/
â”œâ”€â”€ core/                    # æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ docx_processor.py   # æ–‡æ¡£å¤„ç†å™¨
â”‚   â””â”€â”€ models.py           # æ•°æ®æ¨¡å‹å®šä¹‰
â”œâ”€â”€ dist/                   # æ„å»ºè¾“å‡ºç›®å½•
â”‚   â”œâ”€â”€ docx_mcp-0.1.0-py3-none-any.whl
â”‚   â””â”€â”€ docx_mcp-0.1.0.tar.gz
â”œâ”€â”€ main.py                 # MCP æœåŠ¡ä¸»å…¥å£
â”œâ”€â”€ pyproject.toml         # é¡¹ç›®é…ç½®å’Œä¾èµ–å®šä¹‰
â”œâ”€â”€ requirements.txt       # å¤‡ç”¨ä¾èµ–æ–‡ä»¶ï¼ˆå…¼å®¹æ€§ï¼‰
â”œâ”€â”€ uv.lock               # uv é”å®šæ–‡ä»¶
â”œâ”€â”€ LICENSE               # MIT è®¸å¯è¯
â”œâ”€â”€ PUBLISH.md            # å‘å¸ƒæŒ‡å—
â”œâ”€â”€ PRE_PUBLISH_CHECKLIST.md  # å‘å¸ƒå‰æ£€æŸ¥æ¸…å•
â”œâ”€â”€ READY_TO_PUBLISH.md   # å‘å¸ƒå‡†å¤‡è¯´æ˜
â”œâ”€â”€ setup_pypi_credentials.py # PyPI å‡­è¯é…ç½®è„šæœ¬
â”œâ”€â”€ publish.py            # è‡ªåŠ¨åŒ–å‘å¸ƒè„šæœ¬
â”œâ”€â”€ env.example           # ç¯å¢ƒå˜é‡é…ç½®æ¨¡æ¿
â””â”€â”€ README.md             # é¡¹ç›®æ–‡æ¡£
```

## ğŸ” é…ç½®è¯´æ˜

### é˜¿é‡Œäº‘ OSS é…ç½®

æ¨èä½¿ç”¨ç¯å¢ƒå˜é‡é…ç½® OSS è®¿é—®ä¿¡æ¯ã€‚å¤åˆ¶ `env.example` æ–‡ä»¶å¹¶é‡å‘½åä¸º `.env`ï¼Œç„¶åå¡«å…¥æ‚¨çš„å®é™…é…ç½®ï¼š

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp env.example .env
```

åœ¨ `.env` æ–‡ä»¶ä¸­è®¾ç½®ï¼š

```bash
OSS_ACCESS_KEY=your_access_key_here
OSS_SECRET_KEY=your_secret_key_here
OSS_BUCKET_NAME=your_bucket_name
OSS_DOMAIN=https://your-bucket.oss-cn-shenzhen.aliyuncs.com/
```

æˆ–è€…åœ¨ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­è®¾ç½®ï¼š

```bash
# Windows PowerShell
$env:OSS_ACCESS_KEY = "your_access_key_here"
$env:OSS_SECRET_KEY = "your_secret_key_here"
$env:OSS_BUCKET_NAME = "your_bucket_name"
$env:OSS_DOMAIN = "https://your-bucket.oss-cn-shenzhen.aliyuncs.com/"

# PyPI å‘å¸ƒå‡­è¯ï¼ˆå¯é€‰ï¼‰
$env:TWINE_USERNAME = "your-pypi-username"
$env:TWINE_PASSWORD = "your-pypi-password"

# Linux/macOS
export OSS_ACCESS_KEY="your_access_key_here"
export OSS_SECRET_KEY="your_secret_key_here"
export OSS_BUCKET_NAME="your_bucket_name"
export OSS_DOMAIN="https://your-bucket.oss-cn-shenzhen.aliyuncs.com/"

# PyPI å‘å¸ƒå‡­è¯ï¼ˆå¯é€‰ï¼‰
export TWINE_USERNAME="your-pypi-username"
export TWINE_PASSWORD="your-pypi-password"
```

âš ï¸ **å®‰å…¨æç¤º**: 
- è¯·ä¸è¦å°†æ•æ„Ÿä¿¡æ¯æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
- `.env` æ–‡ä»¶å·²æ·»åŠ åˆ° `.gitignore` ä¸­
- ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨æ›´å®‰å…¨çš„å¯†é’¥ç®¡ç†æ–¹æ¡ˆ

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ•°æ®æ¨¡å‹

é¡¹ç›®ä½¿ç”¨ Pydantic å®šä¹‰æ•°æ®æ¨¡å‹ï¼š

```python
class DocumentPatch(BaseModel):
    element_id: str      # å…ƒç´ å”¯ä¸€æ ‡è¯†ç¬¦
    new_content: Any     # æ–°å†…å®¹ï¼ˆæ”¯æŒå¤šç§ç±»å‹ï¼‰
```

### æ‰©å±•åŠŸèƒ½

è¦æ·»åŠ æ–°çš„æ–‡æ¡£å¤„ç†åŠŸèƒ½ï¼š

1. åœ¨ `core/docx_processor.py` ä¸­å®ç°å¤„ç†é€»è¾‘
2. åœ¨ `main.py` ä¸­ä½¿ç”¨ `@mcp.tool()` è£…é¥°å™¨æ³¨å†Œæ–°çš„ MCP å·¥å…·
3. æ›´æ–°ç›¸å…³çš„æ•°æ®æ¨¡å‹

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MIT è®¸å¯è¯å¼€æº - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ”— ç›¸å…³é“¾æ¥

- [MCP å®˜æ–¹æ–‡æ¡£](https://modelcontextprotocol.io/)
- [FastMCP æ¡†æ¶](https://github.com/pydantic/fastmcp)
- [python-docx æ–‡æ¡£](https://python-docx.readthedocs.io/)
- [é˜¿é‡Œäº‘ OSS Python SDK](https://help.aliyun.com/document_detail/32026.html)

## â“ å¸¸è§é—®é¢˜

### Q: uvx å’Œ uv æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
A: uvx æ˜¯ç”¨äºè¿è¡Œç‹¬ç«‹ Python å·¥å…·çš„å·¥å…·ï¼Œç±»ä¼¼ npxã€‚å®ƒä¼šè‡ªåŠ¨å¤„ç†ä¾èµ–å’Œç¯å¢ƒéš”ç¦»ï¼Œæ›´é€‚åˆå·¥å…·å‹åº”ç”¨ã€‚uv ä¸»è¦ç”¨äºé¡¹ç›®ä¾èµ–ç®¡ç†å’Œå¼€å‘ã€‚

### Q: å¦‚ä½•å¤„ç†å¤§æ–‡ä»¶ï¼Ÿ
A: æœåŠ¡æ”¯æŒé€šè¿‡ Base64 ç¼–ç å¤„ç†å¤§æ–‡ä»¶ï¼Œä½†å»ºè®®æ–‡ä»¶å¤§å°ä¸è¶…è¿‡ 50MBã€‚

### Q: æ”¯æŒå“ªäº›æ–‡æ¡£æ ¼å¼ï¼Ÿ
A: ç›®å‰ä»…æ”¯æŒ .docx æ ¼å¼ï¼ˆOffice 2007+ æ ¼å¼ï¼‰ã€‚

### Q: å¦‚ä½•è‡ªå®šä¹‰ OSS é…ç½®ï¼Ÿ
A: ä¿®æ”¹ `main.py` ä¸­çš„ `OSS_CONFIG` å­—å…¸ï¼Œæˆ–è€ƒè™‘ä½¿ç”¨ç¯å¢ƒå˜é‡ã€‚

### Q: uvx æ‰¾ä¸åˆ°å‘½ä»¤æ€ä¹ˆåŠï¼Ÿ
A: ç¡®ä¿å·²å®‰è£… uvï¼Œç„¶å uvx ä¼šè‡ªåŠ¨å¯ç”¨ã€‚å¦‚æœä»æœ‰é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ `uv tool run docx-mcp` æ›¿ä»£ã€‚

---

ğŸ’¡ **æç¤º**: å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æäº¤ Issue æˆ– Pull Requestï¼
