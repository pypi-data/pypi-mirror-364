

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Singularity Analysis User Guide" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://manipulapy.readthedocs.io/user_guide/Singularity_Analysis.html" />
<meta property="og:site_name" content="ManipulaPy Documentation" />
<meta property="og:description" content="The Singularity Analysis module provides comprehensive tools for analyzing and visualizing robot manipulator singularities, workspace boundaries, and manipulability characteristics. Understanding s..." />
<meta name="description" content="The Singularity Analysis module provides comprehensive tools for analyzing and visualizing robot manipulator singularities, workspace boundaries, and manipulability characteristics. Understanding s..." />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Singularity Analysis User Guide &mdash; ManipulaPy 1.1.0 Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=b4417981" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=b4417981" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=fc837d61"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=fd10adb8"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Collision Checker Module User Guide" href="Collision_Checker.html" />
    <link rel="prev" title="Simulation Module User Guide" href="Simulation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../index.html" class="icon icon-home">
            ManipulaPy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">🚀 Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started with ManipulaPy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">🛠️ API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">🔧 API Reference Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">📚 User Guides</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#complete-guide-overview">📚 Complete Guide Overview</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Kinematics.html">Kinematics User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="Dynamics.html">Dynamics User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="Control.html">Control Module User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="URDF_Processor.html">URDF Processor User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="Trajectory_Planning.html">Trajectory Planning User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="Simulation.html">Simulation Module User Guide</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Singularity Analysis User Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#theoretical-background">Theoretical Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installation-and-setup">Installation and Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#quick-start">Quick Start</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-api-reference">Module API Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="#advanced-analysis-examples">Advanced Analysis Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#troubleshooting-guide">Troubleshooting Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="#validation-and-testing">Validation and Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#best-practices">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Collision_Checker.html">Collision Checker Module User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="Potential_Field.html">Potential Field Module User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="Perception.html">Perception User Guide</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Singularity Analysis User Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#theoretical-background">Theoretical Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installation-and-setup">Installation and Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#quick-start">Quick Start</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-api-reference">Module API Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="#advanced-analysis-examples">Advanced Analysis Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#troubleshooting-guide">Troubleshooting Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="#validation-and-testing">Validation and Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#best-practices">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="CUDA_Kernels.html">CUDA Kernels User Guide</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#learning-pathways">🗺️ Learning Pathways</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#guide-categories">📖 Guide Categories</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#quick-reference">🎯 Quick Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#study-tips">💡 Study Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#need-help">🆘 Need Help?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Kinematics.html">Kinematics User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dynamics.html">Dynamics User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Control.html">Control Module User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Trajectory_Planning.html">Trajectory Planning User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Simulation.html">Simulation Module User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="URDF_Processor.html">URDF Processor User Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Singularity Analysis User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#theoretical-background">Theoretical Background</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-are-singularities">What are Singularities?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mathematical-foundations">Mathematical Foundations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#installation-and-setup">Installation and Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#verification">Verification</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#quick-start">Quick Start</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-singularity-analysis">Basic Singularity Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manipulability-ellipsoid-visualization">Manipulability Ellipsoid Visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-api-reference">Module API Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#singularity-class">Singularity Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#core-analysis-methods">Core Analysis Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#singularity_analysis"><code class="docutils literal notranslate"><span class="pre">singularity_analysis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#condition_number"><code class="docutils literal notranslate"><span class="pre">condition_number()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#near_singularity_detection"><code class="docutils literal notranslate"><span class="pre">near_singularity_detection()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#visualization-methods">Visualization Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#manipulability_ellipsoid"><code class="docutils literal notranslate"><span class="pre">manipulability_ellipsoid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#plot_workspace_monte_carlo"><code class="docutils literal notranslate"><span class="pre">plot_workspace_monte_carlo()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-analysis-examples">Advanced Analysis Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#comprehensive-singularity-mapping">Comprehensive Singularity Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#trajectory-singularity-analysis">Trajectory Singularity Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#real-time-singularity-monitoring">Real-Time Singularity Monitoring</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#performance-optimization">Performance Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#computational-efficiency-tips">Computational Efficiency Tips</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting-guide">Troubleshooting Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#common-issues-and-solutions">Common Issues and Solutions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#validation-and-testing">Validation and Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#unit-testing-framework">Unit Testing Framework</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#best-practices">Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#singularity-aware-robot-programming">Singularity-Aware Robot Programming</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integration-guidelines">Integration Guidelines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Perception.html">Perception User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="vision.html">Vision User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Potential_Field.html">Potential Field Module User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Collision_Checker.html">Collision Checker Module User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="CUDA_Kernels.html">CUDA Kernels User Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ManipulaPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">User Guide</a></li>
      <li class="breadcrumb-item active">Singularity Analysis User Guide</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user_guide/Singularity_Analysis.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="singularity-analysis-user-guide">
<h1>Singularity Analysis User Guide<a class="headerlink" href="#singularity-analysis-user-guide" title="Link to this heading"></a></h1>
<p>The Singularity Analysis module provides comprehensive tools for analyzing and visualizing
robot manipulator singularities, workspace boundaries, and manipulability characteristics.
Understanding singularities is crucial for robust robot control, trajectory planning,
and workspace optimization.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This guide assumes familiarity with robotics fundamentals, linear algebra, and
Python 3.10+ with NumPy, SciPy, Matplotlib, and optionally CUDA/Numba for acceleration.</p>
</div>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#theoretical-background" id="id1">Theoretical Background</a></p>
<ul>
<li><p><a class="reference internal" href="#what-are-singularities" id="id2">What are Singularities?</a></p></li>
<li><p><a class="reference internal" href="#mathematical-foundations" id="id3">Mathematical Foundations</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#installation-and-setup" id="id4">Installation and Setup</a></p>
<ul>
<li><p><a class="reference internal" href="#prerequisites" id="id5">Prerequisites</a></p></li>
<li><p><a class="reference internal" href="#verification" id="id6">Verification</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#quick-start" id="id7">Quick Start</a></p>
<ul>
<li><p><a class="reference internal" href="#basic-singularity-analysis" id="id8">Basic Singularity Analysis</a></p></li>
<li><p><a class="reference internal" href="#manipulability-ellipsoid-visualization" id="id9">Manipulability Ellipsoid Visualization</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#module-api-reference" id="id10">Module API Reference</a></p>
<ul>
<li><p><a class="reference internal" href="#singularity-class" id="id11">Singularity Class</a></p></li>
<li><p><a class="reference internal" href="#core-analysis-methods" id="id12">Core Analysis Methods</a></p></li>
<li><p><a class="reference internal" href="#visualization-methods" id="id13">Visualization Methods</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#advanced-analysis-examples" id="id14">Advanced Analysis Examples</a></p>
<ul>
<li><p><a class="reference internal" href="#comprehensive-singularity-mapping" id="id15">Comprehensive Singularity Mapping</a></p></li>
<li><p><a class="reference internal" href="#trajectory-singularity-analysis" id="id16">Trajectory Singularity Analysis</a></p></li>
<li><p><a class="reference internal" href="#real-time-singularity-monitoring" id="id17">Real-Time Singularity Monitoring</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#performance-optimization" id="id18">Performance Optimization</a></p>
<ul>
<li><p><a class="reference internal" href="#computational-efficiency-tips" id="id19">Computational Efficiency Tips</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#troubleshooting-guide" id="id20">Troubleshooting Guide</a></p>
<ul>
<li><p><a class="reference internal" href="#common-issues-and-solutions" id="id21">Common Issues and Solutions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#validation-and-testing" id="id22">Validation and Testing</a></p>
<ul>
<li><p><a class="reference internal" href="#unit-testing-framework" id="id23">Unit Testing Framework</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#best-practices" id="id24">Best Practices</a></p>
<ul>
<li><p><a class="reference internal" href="#singularity-aware-robot-programming" id="id25">Singularity-Aware Robot Programming</a></p></li>
<li><p><a class="reference internal" href="#integration-guidelines" id="id26">Integration Guidelines</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#see-also" id="id27">See Also</a></p></li>
</ul>
</nav>
<section id="theoretical-background">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Theoretical Background</a><a class="headerlink" href="#theoretical-background" title="Link to this heading"></a></h2>
<section id="what-are-singularities">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">What are Singularities?</a><a class="headerlink" href="#what-are-singularities" title="Link to this heading"></a></h3>
<p>A <strong>singularity</strong> occurs when a robot manipulator loses one or more degrees of freedom,
meaning the end-effector cannot move in certain directions regardless of joint velocities.
Mathematically, this happens when the Jacobian matrix becomes rank-deficient (determinant ≈ 0).</p>
<p><strong>Types of Singularities:</strong></p>
<ol class="arabic simple">
<li><p><strong>Boundary Singularities</strong>: Occur at workspace boundaries when the arm is fully extended</p></li>
<li><p><strong>Interior Singularities</strong>: Occur within the workspace when joints align in specific configurations</p></li>
<li><p><strong>Wrist Singularities</strong>: Occur when wrist axes align, losing rotational degrees of freedom</p></li>
</ol>
<p><strong>Physical Consequences:</strong></p>
<ul class="simple">
<li><p>Infinite joint velocities required for certain end-effector motions</p></li>
<li><p>Loss of controllability in specific directions</p></li>
<li><p>Numerical instability in inverse kinematics</p></li>
<li><p>Reduced manipulability and dexterity</p></li>
</ul>
</section>
<section id="mathematical-foundations">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Mathematical Foundations</a><a class="headerlink" href="#mathematical-foundations" title="Link to this heading"></a></h3>
<p><strong>Jacobian Matrix</strong></p>
<p>The velocity relationship between joint space and Cartesian space:</p>
<div class="math notranslate nohighlight">
\[\dot{\mathbf{x}} = \mathbf{J}(\mathbf{q}) \dot{\mathbf{q}}\]</div>
<p>where:
- <span class="math notranslate nohighlight">\(\dot{\mathbf{x}} \in \mathbb{R}^6\)</span> is the end-effector twist (linear + angular velocity)
- <span class="math notranslate nohighlight">\(\mathbf{J}(\mathbf{q}) \in \mathbb{R}^{6 \times n}\)</span> is the Jacobian matrix
- <span class="math notranslate nohighlight">\(\dot{\mathbf{q}} \in \mathbb{R}^n\)</span> is the joint velocity vector</p>
<p><strong>Singularity Detection</strong></p>
<p>A configuration is singular when:</p>
<div class="math notranslate nohighlight">
\[\det(\mathbf{J}) = 0 \quad \text{or} \quad \sigma_{\min}(\mathbf{J}) &lt; \epsilon\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_{\min}\)</span> is the smallest singular value and <span class="math notranslate nohighlight">\(\epsilon\)</span> is a small threshold.</p>
<p><strong>Manipulability Measure</strong></p>
<p>The manipulability ellipsoid describes the robot’s velocity capabilities:</p>
<div class="math notranslate nohighlight">
\[w(\mathbf{q}) = \sqrt{\det(\mathbf{J}\mathbf{J}^T)}\]</div>
<p><strong>Condition Number</strong></p>
<p>Measures how close a configuration is to singularity:</p>
<div class="math notranslate nohighlight">
\[\kappa(\mathbf{J}) = \frac{\sigma_{\max}(\mathbf{J})}{\sigma_{\min}(\mathbf{J})}\]</div>
</section>
</section>
<section id="installation-and-setup">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Installation and Setup</a><a class="headerlink" href="#installation-and-setup" title="Link to this heading"></a></h2>
<section id="prerequisites">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Prerequisites</a><a class="headerlink" href="#prerequisites" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Core dependencies</span>
pip<span class="w"> </span>install<span class="w"> </span>ManipulaPy<span class="w"> </span>numpy<span class="w"> </span>scipy<span class="w"> </span>matplotlib

<span class="c1"># Optional GPU acceleration</span>
pip<span class="w"> </span>install<span class="w"> </span>numba<span class="w"> </span>cupy-cuda11x<span class="w">  </span><span class="c1"># or cupy-cuda12x</span>

<span class="c1"># 3D visualization enhancements</span>
pip<span class="w"> </span>install<span class="w"> </span>plotly<span class="w"> </span>vtk<span class="w"> </span>mayavi
</pre></div>
</div>
</section>
<section id="verification">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Verification</a><a class="headerlink" href="#verification" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">ManipulaPy.singularity</span> <span class="kn">import</span> <span class="n">Singularity</span>
<span class="kn">from</span> <span class="nn">ManipulaPy.kinematics</span> <span class="kn">import</span> <span class="n">SerialManipulator</span>

<span class="c1"># Test CUDA availability</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">cuda</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CUDA available: </span><span class="si">{</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GPU devices: </span><span class="si">{</span><span class="n">cuda</span><span class="o">.</span><span class="n">gpus</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Numba/CUDA not available - using CPU only&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="quick-start">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Quick Start</a><a class="headerlink" href="#quick-start" title="Link to this heading"></a></h2>
<section id="basic-singularity-analysis">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Basic Singularity Analysis</a><a class="headerlink" href="#basic-singularity-analysis" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ManipulaPy.singularity</span> <span class="kn">import</span> <span class="n">Singularity</span>
<span class="kn">from</span> <span class="nn">ManipulaPy.urdf_processor</span> <span class="kn">import</span> <span class="n">URDFToSerialManipulator</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Load robot model</span>
<span class="n">urdf_processor</span> <span class="o">=</span> <span class="n">URDFToSerialManipulator</span><span class="p">(</span><span class="s2">&quot;robot.urdf&quot;</span><span class="p">)</span>
<span class="n">robot</span> <span class="o">=</span> <span class="n">urdf_processor</span><span class="o">.</span><span class="n">serial_manipulator</span>

<span class="c1"># Create singularity analyzer</span>
<span class="n">singularity_analyzer</span> <span class="o">=</span> <span class="n">Singularity</span><span class="p">(</span><span class="n">robot</span><span class="p">)</span>

<span class="c1"># Test configuration</span>
<span class="n">joint_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1"># Check for singularity</span>
<span class="n">is_singular</span> <span class="o">=</span> <span class="n">singularity_analyzer</span><span class="o">.</span><span class="n">singularity_analysis</span><span class="p">(</span><span class="n">joint_angles</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuration is singular: </span><span class="si">{</span><span class="n">is_singular</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Calculate condition number</span>
<span class="n">condition_num</span> <span class="o">=</span> <span class="n">singularity_analyzer</span><span class="o">.</span><span class="n">condition_number</span><span class="p">(</span><span class="n">joint_angles</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Condition number: </span><span class="si">{</span><span class="n">condition_num</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Check proximity to singularity</span>
<span class="n">near_singular</span> <span class="o">=</span> <span class="n">singularity_analyzer</span><span class="o">.</span><span class="n">near_singularity_detection</span><span class="p">(</span>
    <span class="n">joint_angles</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">100</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Near singularity: </span><span class="si">{</span><span class="n">near_singular</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="manipulability-ellipsoid-visualization">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Manipulability Ellipsoid Visualization</a><a class="headerlink" href="#manipulability-ellipsoid-visualization" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Create 3D visualization</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Compare different configurations</span>
<span class="n">configs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>           <span class="c1"># Home position</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>        <span class="c1"># Extended arm</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.57</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.57</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>    <span class="c1"># Folded configuration</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">configs</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">singularity_analyzer</span><span class="o">.</span><span class="n">manipulability_ellipsoid</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuration </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="module-api-reference">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Module API Reference</a><a class="headerlink" href="#module-api-reference" title="Link to this heading"></a></h2>
<section id="singularity-class">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Singularity Class</a><a class="headerlink" href="#singularity-class" title="Link to this heading"></a></h3>
</section>
<section id="core-analysis-methods">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Core Analysis Methods</a><a class="headerlink" href="#core-analysis-methods" title="Link to this heading"></a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serial_manipulator</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#init__" title="Link to this definition"></a></dt>
<dd><p>Initialize singularity analysis for a given robot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>serial_manipulator</strong> (<em>SerialManipulator</em>) – Robot model from ManipulaPy.kinematics</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If serial_manipulator is not a valid SerialManipulator instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="singularity_analysis">
<span class="sig-name descname"><span class="pre">singularity_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thetalist</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><a class="headerlink" href="#singularity_analysis" title="Link to this definition"></a></dt>
<dd><p>Detect exact singularities using Jacobian determinant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>thetalist</strong> (<em>np.ndarray</em>) – Joint angles in radians (shape: n_joints,)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if configuration is singular</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
<p>Uses threshold of 1e-4 for determinant comparison. For more nuanced analysis,
use <a class="reference internal" href="#condition_number" title="condition_number"><code class="xref py py-meth docutils literal notranslate"><span class="pre">condition_number()</span></code></a> or <a class="reference internal" href="#near_singularity_detection" title="near_singularity_detection"><code class="xref py py-meth docutils literal notranslate"><span class="pre">near_singularity_detection()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example: Check multiple configurations</span>
<span class="n">test_configs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>                    <span class="c1"># Home</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>  <span class="c1"># Shoulder singularity</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>   <span class="c1"># Wrist singularity</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test_configs</span><span class="p">):</span>
    <span class="n">singular</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">singularity_analysis</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Config </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> singular: </span><span class="si">{</span><span class="n">singular</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="condition_number">
<span class="sig-name descname"><span class="pre">condition_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thetalist</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></span><a class="headerlink" href="#condition_number" title="Link to this definition"></a></dt>
<dd><p>Calculate Jacobian condition number for singularity proximity assessment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>thetalist</strong> (<em>np.ndarray</em>) – Joint angles in radians</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Condition number (≥1, higher values indicate closer to singularity)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
<p>Condition numbers interpretation:
- κ ≈ 1: Well-conditioned, far from singularity
- κ = 10-100: Moderately conditioned
- κ &gt; 100: Ill-conditioned, approaching singularity
- κ → ∞: At singularity</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="near_singularity_detection">
<span class="sig-name descname"><span class="pre">near_singularity_detection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thetalist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><a class="headerlink" href="#near_singularity_detection" title="Link to this definition"></a></dt>
<dd><p>Detect proximity to singularities using condition number threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thetalist</strong> (<em>np.ndarray</em>) – Joint angles in radians</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Condition number threshold (default: 100)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if near singularity</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Typical thresholds:
- 100: Close to singularity
- 1000: Very close to singularity
- 10000: Extremely close to singularity</p>
</div>
</dd></dl>

</section>
<section id="visualization-methods">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Visualization Methods</a><a class="headerlink" href="#visualization-methods" title="Link to this heading"></a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="manipulability_ellipsoid">
<span class="sig-name descname"><span class="pre">manipulability_ellipsoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thetalist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#manipulability_ellipsoid" title="Link to this definition"></a></dt>
<dd><p>Visualize manipulability ellipsoids for linear and angular velocities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thetalist</strong> (<em>np.ndarray</em>) – Joint angles in radians</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes3D</em>) – Optional 3D axis for plotting</p></li>
</ul>
</dd>
</dl>
<p>Creates two ellipsoids:
- <strong>Blue ellipsoid</strong>: Linear velocity capabilities
- <strong>Red ellipsoid</strong>: Angular velocity capabilities</p>
<p>Ellipsoid properties:
- <strong>Volume</strong>: Overall manipulability measure
- <strong>Shape</strong>: Directional velocity capabilities
- <strong>Orientation</strong>: Principal motion directions</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plot_workspace_monte_carlo">
<span class="sig-name descname"><span class="pre">plot_workspace_monte_carlo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">joint_limits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plot_workspace_monte_carlo" title="Link to this definition"></a></dt>
<dd><p>Generate workspace boundary using Monte Carlo sampling with optional GPU acceleration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>joint_limits</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of (min, max) tuples for each joint</p></li>
<li><p><strong>num_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of random samples (default: 10000)</p></li>
</ul>
</dd>
</dl>
<p>Creates 3D convex hull visualization of reachable workspace. Uses CUDA acceleration
when available for faster sampling of large point clouds.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># High-resolution workspace analysis</span>
<span class="n">joint_limits</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)]</span> <span class="o">*</span> <span class="mi">6</span>
<span class="n">analyzer</span><span class="o">.</span><span class="n">plot_workspace_monte_carlo</span><span class="p">(</span>
    <span class="n">joint_limits</span><span class="p">,</span>
    <span class="n">num_samples</span><span class="o">=</span><span class="mi">100000</span>  <span class="c1"># High resolution</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="advanced-analysis-examples">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Advanced Analysis Examples</a><a class="headerlink" href="#advanced-analysis-examples" title="Link to this heading"></a></h2>
<section id="comprehensive-singularity-mapping">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Comprehensive Singularity Mapping</a><a class="headerlink" href="#comprehensive-singularity-mapping" title="Link to this heading"></a></h3>
<p>Create detailed singularity maps across the workspace:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LogNorm</span>

<span class="k">def</span> <span class="nf">create_singularity_map</span><span class="p">(</span><span class="n">analyzer</span><span class="p">,</span> <span class="n">joint_ranges</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create 2D singularity map varying two joints.&quot;&quot;&quot;</span>

    <span class="c1"># Define sweep ranges for first two joints</span>
    <span class="n">q1_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">joint_ranges</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">joint_ranges</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">resolution</span><span class="p">)</span>
    <span class="n">q2_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">joint_ranges</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">joint_ranges</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">resolution</span><span class="p">)</span>

    <span class="c1"># Initialize condition number grid</span>
    <span class="n">condition_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">resolution</span><span class="p">,</span> <span class="n">resolution</span><span class="p">))</span>

    <span class="c1"># Fixed values for other joints</span>
    <span class="n">q_fixed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">q1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">q1_range</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">q2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">q2_range</span><span class="p">):</span>
            <span class="n">q_test</span> <span class="o">=</span> <span class="n">q_fixed</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">q_test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">q1</span>
            <span class="n">q_test</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">q2</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">condition_map</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">condition_number</span><span class="p">(</span><span class="n">q_test</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">LinAlgError</span><span class="p">:</span>
                <span class="n">condition_map</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e6</span>  <span class="c1"># Singular configuration</span>

    <span class="k">return</span> <span class="n">q1_range</span><span class="p">,</span> <span class="n">q2_range</span><span class="p">,</span> <span class="n">condition_map</span>

<span class="c1"># Create and plot singularity map</span>
<span class="n">q1_vals</span><span class="p">,</span> <span class="n">q2_vals</span><span class="p">,</span> <span class="n">cond_map</span> <span class="o">=</span> <span class="n">create_singularity_map</span><span class="p">(</span>
    <span class="n">singularity_analyzer</span><span class="p">,</span>
    <span class="p">[(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)],</span>
    <span class="n">resolution</span><span class="o">=</span><span class="mi">50</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">q1_vals</span><span class="p">,</span> <span class="n">q2_vals</span><span class="p">,</span> <span class="n">cond_map</span><span class="p">,</span>
                 <span class="n">levels</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">q1_vals</span><span class="p">,</span> <span class="n">q2_vals</span><span class="p">,</span> <span class="n">cond_map</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
           <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;darkred&#39;</span><span class="p">],</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Joint 1 Angle (rad)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Joint 2 Angle (rad)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Singularity Map (Condition Number)&#39;</span><span class="p">)</span>

<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Condition Number&#39;</span><span class="p">)</span>

<span class="c1"># Add singularity contour labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="s1">&#39;Red: κ=100</span><span class="se">\n</span><span class="s1">Dark Red: κ=1000&#39;</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;wheat&#39;</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="trajectory-singularity-analysis">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Trajectory Singularity Analysis</a><a class="headerlink" href="#trajectory-singularity-analysis" title="Link to this heading"></a></h3>
<p>Analyze singularities along planned trajectories:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analyze_trajectory_singularities</span><span class="p">(</span><span class="n">analyzer</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyze singularities along a trajectory.&quot;&quot;&quot;</span>

    <span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">trajectory</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">time_steps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">time_steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>

    <span class="c1"># Compute metrics along trajectory</span>
    <span class="n">condition_numbers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">singular_points</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">manipulability_measures</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trajectory</span><span class="p">):</span>
        <span class="c1"># Condition number</span>
        <span class="n">cond_num</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">condition_number</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="n">condition_numbers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cond_num</span><span class="p">)</span>

        <span class="c1"># Singularity detection</span>
        <span class="n">is_singular</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">singularity_analysis</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="n">singular_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">is_singular</span><span class="p">)</span>

        <span class="c1"># Manipulability measure</span>
        <span class="n">J</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">serial_manipulator</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="n">manipulability</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">J</span> <span class="o">@</span> <span class="n">J</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
        <span class="n">manipulability_measures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">manipulability</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">time_steps</span><span class="p">,</span>
        <span class="s1">&#39;condition_numbers&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">condition_numbers</span><span class="p">),</span>
        <span class="s1">&#39;singular_points&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">singular_points</span><span class="p">),</span>
        <span class="s1">&#39;manipulability&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">manipulability_measures</span><span class="p">)</span>
    <span class="p">}</span>

<span class="k">def</span> <span class="nf">plot_trajectory_analysis</span><span class="p">(</span><span class="n">analysis_results</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot trajectory singularity analysis results.&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">time</span> <span class="o">=</span> <span class="n">analysis_results</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>

    <span class="c1"># Condition number plot</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">analysis_results</span><span class="p">[</span><span class="s1">&#39;condition_numbers&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Warning (κ=100)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Critical (κ=1000)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Condition Number&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Trajectory Singularity Analysis&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Singular points</span>
    <span class="n">singular_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">analysis_results</span><span class="p">[</span><span class="s1">&#39;singular_points&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">singular_indices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">singular_indices</span><span class="p">],</span>
                       <span class="n">analysis_results</span><span class="p">[</span><span class="s1">&#39;condition_numbers&#39;</span><span class="p">][</span><span class="n">singular_indices</span><span class="p">],</span>
                       <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Singular Points&#39;</span><span class="p">)</span>

    <span class="c1"># Manipulability measure</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">analysis_results</span><span class="p">[</span><span class="s1">&#39;manipulability&#39;</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Manipulability Measure&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Velocity scaling factor (inverse condition number)</span>
    <span class="n">velocity_scaling</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">analysis_results</span><span class="p">[</span><span class="s1">&#39;condition_numbers&#39;</span><span class="p">]</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">velocity_scaling</span><span class="p">,</span> <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Max Velocity Scaling&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Trajectory Parameter&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="real-time-singularity-monitoring">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Real-Time Singularity Monitoring</a><a class="headerlink" href="#real-time-singularity-monitoring" title="Link to this heading"></a></h3>
<p>Implement real-time singularity monitoring for robot control:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="k">class</span> <span class="nc">SingularityMonitor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Real-time singularity monitoring system.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analyzer</span><span class="p">,</span> <span class="n">warning_threshold</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">critical_threshold</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">analyzer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">warning_threshold</span> <span class="o">=</span> <span class="n">warning_threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">critical_threshold</span> <span class="o">=</span> <span class="n">critical_threshold</span>

        <span class="c1"># Monitoring state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_monitoring</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitor_thread</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Data storage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">condition_history</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_history</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alerts</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">start_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update_rate</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start real-time monitoring.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_monitoring</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitor_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span>
            <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_monitor_loop</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">update_rate</span><span class="p">,)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitor_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Singularity monitoring started at </span><span class="si">{</span><span class="n">update_rate</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stop_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop monitoring.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_monitoring</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor_thread</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">monitor_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Singularity monitoring stopped&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_monitor_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update_rate</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Main monitoring loop.&quot;&quot;&quot;</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">update_rate</span>

        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_monitoring</span><span class="p">:</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

            <span class="c1"># Get current robot configuration (placeholder)</span>
            <span class="n">current_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_current_configuration</span><span class="p">()</span>

            <span class="c1"># Analyze singularity</span>
            <span class="n">condition_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">condition_number</span><span class="p">(</span><span class="n">current_config</span><span class="p">)</span>

            <span class="c1"># Store data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">condition_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">condition_num</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>

            <span class="c1"># Check thresholds</span>
            <span class="k">if</span> <span class="n">condition_num</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">critical_threshold</span><span class="p">:</span>
                <span class="n">alert</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span>
                    <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;CRITICAL&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;condition_number&#39;</span><span class="p">:</span> <span class="n">condition_num</span><span class="p">,</span>
                    <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="n">current_config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="p">}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CRITICAL: Condition number = </span><span class="si">{</span><span class="n">condition_num</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">condition_num</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">warning_threshold</span><span class="p">:</span>
                <span class="n">alert</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span>
                    <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;condition_number&#39;</span><span class="p">:</span> <span class="n">condition_num</span><span class="p">,</span>
                    <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="n">current_config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="p">}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WARNING: Condition number = </span><span class="si">{</span><span class="n">condition_num</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Maintain update rate</span>
            <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
            <span class="n">sleep_time</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dt</span> <span class="o">-</span> <span class="n">elapsed</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_current_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current robot configuration (placeholder).&quot;&quot;&quot;</span>
        <span class="c1"># This would interface with actual robot hardware</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span>
            <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.15</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span>
            <span class="mf">0.4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.08</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span>
            <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.12</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span>
            <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span>
            <span class="mf">0.05</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="p">])</span>
</pre></div>
</div>
</section>
</section>
<section id="performance-optimization">
<h2><a class="toc-backref" href="#id18" role="doc-backlink">Performance Optimization</a><a class="headerlink" href="#performance-optimization" title="Link to this heading"></a></h2>
<section id="computational-efficiency-tips">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">Computational Efficiency Tips</a><a class="headerlink" href="#computational-efficiency-tips" title="Link to this heading"></a></h3>
<p><strong>1. Jacobian Caching</strong></p>
<p>Cache Jacobian computations for repeated configurations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CachedSingularityAnalyzer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Singularity analyzer with Jacobian caching.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">serial_manipulator</span><span class="p">,</span> <span class="n">cache_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">Singularity</span><span class="p">(</span><span class="n">serial_manipulator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jacobian_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache_size</span> <span class="o">=</span> <span class="n">cache_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache_hits</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache_misses</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_config_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thetalist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create hashable key for configuration.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">thetalist</span> <span class="o">/</span> <span class="n">precision</span><span class="p">)</span> <span class="o">*</span> <span class="n">precision</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_jacobian</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thetalist</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get Jacobian with caching.&quot;&quot;&quot;</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_key</span><span class="p">(</span><span class="n">thetalist</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">jacobian_cache</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cache_hits</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">jacobian_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="c1"># Compute Jacobian</span>
        <span class="n">J</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">serial_manipulator</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">thetalist</span><span class="p">)</span>

        <span class="c1"># Manage cache size</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jacobian_cache</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_size</span><span class="p">:</span>
            <span class="c1"># Remove oldest entry (simple FIFO)</span>
            <span class="n">oldest_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jacobian_cache</span><span class="p">))</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">jacobian_cache</span><span class="p">[</span><span class="n">oldest_key</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">jacobian_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">J</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache_misses</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">J</span>
</pre></div>
</div>
<p><strong>2. Batch Processing</strong></p>
<p>Process multiple configurations efficiently:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">batch_singularity_analysis</span><span class="p">(</span><span class="n">analyzer</span><span class="p">,</span> <span class="n">configurations</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Efficiently analyze multiple configurations.&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;condition_numbers&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;singular_flags&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;manipulability&#39;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">configurations</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">):</span>
        <span class="n">batch</span> <span class="o">=</span> <span class="n">configurations</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">batch_size</span><span class="p">]</span>

        <span class="c1"># Process batch</span>
        <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">:</span>
            <span class="c1"># Condition number</span>
            <span class="n">cond_num</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">condition_number</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
            <span class="n">results</span><span class="p">[</span><span class="s1">&#39;condition_numbers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cond_num</span><span class="p">)</span>

            <span class="c1"># Singularity flag</span>
            <span class="n">singular</span> <span class="o">=</span> <span class="n">cond_num</span> <span class="o">&gt;</span> <span class="mi">1000</span>  <span class="c1"># Threshold</span>
            <span class="n">results</span><span class="p">[</span><span class="s1">&#39;singular_flags&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">singular</span><span class="p">)</span>

            <span class="c1"># Manipulability</span>
            <span class="n">J</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">serial_manipulator</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
            <span class="n">manip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">J</span> <span class="o">@</span> <span class="n">J</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
            <span class="n">results</span><span class="p">[</span><span class="s1">&#39;manipulability&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">manip</span><span class="p">)</span>

        <span class="c1"># Progress update</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processed </span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">batch_size</span><span class="p">,</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">configurations</span><span class="p">))</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">configurations</span><span class="p">)</span><span class="si">}</span><span class="s2"> configurations&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>
</div>
</section>
</section>
<section id="troubleshooting-guide">
<h2><a class="toc-backref" href="#id20" role="doc-backlink">Troubleshooting Guide</a><a class="headerlink" href="#troubleshooting-guide" title="Link to this heading"></a></h2>
<section id="common-issues-and-solutions">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Common Issues and Solutions</a><a class="headerlink" href="#common-issues-and-solutions" title="Link to this heading"></a></h3>
<p><strong>1. Numerical Instability</strong></p>
<p>Problem: Condition numbers become infinite or NaN</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">robust_condition_number</span><span class="p">(</span><span class="n">analyzer</span><span class="p">,</span> <span class="n">thetalist</span><span class="p">,</span> <span class="n">max_condition</span><span class="o">=</span><span class="mf">1e12</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Robust condition number computation with error handling.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">J</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">serial_manipulator</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">thetalist</span><span class="p">)</span>

        <span class="c1"># Check for NaN or infinite values</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">J</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">max_condition</span>

        <span class="c1"># SVD-based condition number</span>
        <span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">J</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Filter out very small singular values</span>
        <span class="n">s_filtered</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">s</span> <span class="o">&gt;</span> <span class="mf">1e-15</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_filtered</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">max_condition</span>

        <span class="n">condition</span> <span class="o">=</span> <span class="n">s_filtered</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">s_filtered</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">max_condition</span><span class="p">)</span>

    <span class="k">except</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">LinAlgError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">max_condition</span>
</pre></div>
</div>
<p><strong>2. Performance Issues</strong></p>
<p>Problem: Slow computation for large workspaces</p>
<p>Solutions:
- Use smaller sample sizes for initial exploration
- Enable CUDA acceleration if available
- Cache Jacobian computations for repeated configurations
- Use parallel processing for batch analysis</p>
<p><strong>3. Memory Issues</strong></p>
<p>Problem: Out of memory for large datasets</p>
<p>Solutions:
- Process data in smaller chunks
- Use streaming analysis to disk
- Reduce precision of stored data
- Clear intermediate variables regularly</p>
<p><strong>4. Visualization Issues</strong></p>
<p>Problem: Poor visualization performance or cluttered plots</p>
<p>Solutions:
- Reduce number of plotted points
- Use adaptive sampling strategies
- Implement level-of-detail rendering
- Save plots to files instead of displaying interactively</p>
</section>
</section>
<section id="validation-and-testing">
<h2><a class="toc-backref" href="#id22" role="doc-backlink">Validation and Testing</a><a class="headerlink" href="#validation-and-testing" title="Link to this heading"></a></h2>
<section id="unit-testing-framework">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">Unit Testing Framework</a><a class="headerlink" href="#unit-testing-framework" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">unittest</span>

<span class="k">class</span> <span class="nc">TestSingularityAnalysis</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Unit tests for singularity analysis module.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up test fixtures.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">ManipulaPy.urdf_processor</span> <span class="kn">import</span> <span class="n">URDFToSerialManipulator</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">urdf_processor</span> <span class="o">=</span> <span class="n">URDFToSerialManipulator</span><span class="p">(</span><span class="s2">&quot;test_robot.urdf&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">robot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">urdf_processor</span><span class="o">.</span><span class="n">serial_manipulator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">Singularity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">robot</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_condition_number_positive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that condition numbers are always positive.&quot;&quot;&quot;</span>
        <span class="n">test_configs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">])</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">test_configs</span><span class="p">:</span>
            <span class="n">condition_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">condition_number</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="n">condition_num</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Condition number must be positive&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">condition_num</span><span class="p">),</span> <span class="s2">&quot;Condition number must be finite&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="best-practices">
<h2><a class="toc-backref" href="#id24" role="doc-backlink">Best Practices</a><a class="headerlink" href="#best-practices" title="Link to this heading"></a></h2>
<section id="singularity-aware-robot-programming">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">Singularity-Aware Robot Programming</a><a class="headerlink" href="#singularity-aware-robot-programming" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>Always check condition numbers</strong> before executing trajectories</p></li>
<li><p><strong>Use manipulability measures</strong> for trajectory optimization</p></li>
<li><p><strong>Implement singularity avoidance</strong> in motion planning</p></li>
<li><p><strong>Monitor real-time singularity metrics</strong> during operation</p></li>
<li><p><strong>Validate analysis results</strong> with known test cases</p></li>
</ol>
</section>
<section id="integration-guidelines">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">Integration Guidelines</a><a class="headerlink" href="#integration-guidelines" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Trajectory Planning</strong>: Integrate singularity analysis into path optimization</p></li>
<li><p><strong>Control Systems</strong>: Use condition numbers for adaptive control gains</p></li>
<li><p><strong>Safety Systems</strong>: Implement singularity-based motion limits</p></li>
<li><p><strong>Performance Optimization</strong>: Cache computations for repeated analyses</p></li>
</ul>
</section>
</section>
<section id="see-also">
<h2><a class="toc-backref" href="#id27" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="Kinematics.html"><span class="doc">Kinematics User Guide</span></a> — Forward and Inverse Kinematics</p></li>
<li><p><a class="reference internal" href="Trajectory_Planning.html"><span class="doc">Trajectory Planning User Guide</span></a> — Path Planning with Singularity Avoidance</p></li>
<li><p><a class="reference internal" href="Control.html"><span class="doc">Control Module User Guide</span></a> — Singularity-Robust Control Strategies</p></li>
<li><p><a class="reference internal" href="../api/singularity.html"><span class="doc">Singularity API Reference</span></a> — Complete API Reference</p></li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/routines.linalg.html">NumPy Linear Algebra Documentation</a></p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/spatial.html">SciPy Spatial Documentation</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Simulation.html" class="btn btn-neutral float-left" title="Simulation Module User Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Collision_Checker.html" class="btn btn-neutral float-right" title="Collision Checker Module User Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Mohamed Aboelnar.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>