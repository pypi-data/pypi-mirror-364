# ruff: noqa
# fmt: off
# mypy: disable-error-code="top-level-await, no-redef"
#%%
# --8<-- [start:script0]
from fr24 import FR24, FR24Cache

async def my_list() -> None:
    async with FR24() as fr24:
        result = await fr24.flight_list.fetch(reg="B-LRA")
        print(result.to_polars())
        result.write_table(FR24Cache.default())

await my_list()
# --8<-- [end:script0]
#%%
"""
# --8<-- [start:df0]
shape: (10, 15)
┌───────────┬────────┬──────────┬─────────┬───┬─────────────┬────────────┬────────────┬────────────┐
│ flight_id ┆ number ┆ callsign ┆ icao24  ┆ … ┆ ATOD        ┆ STOA       ┆ ETOA       ┆ ATOA       │
│ ---       ┆ ---    ┆ ---      ┆ ---     ┆   ┆ ---         ┆ ---        ┆ ---        ┆ ---        │
│ u64       ┆ str    ┆ str      ┆ u32     ┆   ┆ datetime[ms ┆ datetime[m ┆ datetime[m ┆ datetime[m │
│           ┆        ┆          ┆         ┆   ┆ , UTC]      ┆ s, UTC]    ┆ s, UTC]    ┆ s, UTC]    │
╞═══════════╪════════╪══════════╪═════════╪═══╪═════════════╪════════════╪════════════╪════════════╡
│ 952283415 ┆ CX382  ┆ CPA382   ┆ 7867035 ┆ … ┆ 2025-01-17  ┆ 2025-01-17 ┆ null       ┆ 2025-01-17 │
│           ┆        ┆          ┆         ┆   ┆ 11:14:41    ┆ 22:25:00   ┆            ┆ 22:15:37   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 952264050 ┆ CX383  ┆ CPA383   ┆ 7867035 ┆ … ┆ null        ┆ null       ┆ null       ┆ null       │
│ 952125211 ┆ CX383  ┆ CPA383   ┆ 7867035 ┆ … ┆ 2025-01-16  ┆ 2025-01-17 ┆ null       ┆ 2025-01-17 │
│           ┆        ┆          ┆         ┆   ┆ 17:57:05    ┆ 06:30:00   ┆            ┆ 06:53:54   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951961210 ┆ CX710  ┆ CPA710   ┆ 7867035 ┆ … ┆ 2025-01-16  ┆ 2025-01-16 ┆ null       ┆ 2025-01-16 │
│           ┆        ┆          ┆         ┆   ┆ 00:15:55    ┆ 03:55:00   ┆            ┆ 03:38:15   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951777224 ┆ CX735  ┆ CPA735   ┆ 7867035 ┆ … ┆ 2025-01-15  ┆ 2025-01-15 ┆ null       ┆ 2025-01-15 │
│           ┆        ┆          ┆         ┆   ┆ 06:44:49    ┆ 10:25:00   ┆            ┆ 10:31:32   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951575574 ┆ CX372  ┆ CPA372   ┆ 7867035 ┆ … ┆ 2025-01-14  ┆ 2025-01-14 ┆ null       ┆ 2025-01-14 │
│           ┆        ┆          ┆         ┆   ┆ 10:48:22    ┆ 22:55:00   ┆            ┆ 23:04:26   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951418869 ┆ CX315  ┆ CPA315   ┆ 7867035 ┆ … ┆ 2025-01-13  ┆ 2025-01-14 ┆ null       ┆ 2025-01-14 │
│           ┆        ┆          ┆         ┆   ┆ 17:21:14    ┆ 07:30:00   ┆            ┆ 07:00:28   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951229708 ┆ CX624  ┆ CPA624   ┆ 7867035 ┆ … ┆ 2025-01-12  ┆ 2025-01-13 ┆ null       ┆ 2025-01-13 │
│           ┆        ┆          ┆         ┆   ┆ 20:15:14    ┆ 01:30:00   ┆            ┆ 00:59:37   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951146643 ┆ CX623  ┆ CPA623   ┆ 7867035 ┆ … ┆ 2025-01-12  ┆ 2025-01-12 ┆ null       ┆ 2025-01-12 │
│           ┆        ┆          ┆         ┆   ┆ 12:57:58    ┆ 18:55:00   ┆            ┆ 18:23:19   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951012767 ┆ CX714  ┆ CPA714   ┆ 7867035 ┆ … ┆ 2025-01-11  ┆ 2025-01-11 ┆ null       ┆ 2025-01-11 │
│           ┆        ┆          ┆         ┆   ┆ 18:55:20    ┆ 21:10:00   ┆            ┆ 22:05:36   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
└───────────┴────────┴──────────┴─────────┴───┴─────────────┴────────────┴────────────┴────────────┘
# --8<-- [end:df0]
"""
# %%
# --8<-- [start:script1]
from fr24 import FR24, FR24Cache

cache = FR24Cache.default()

async def my_full_list() -> None:
    async with FR24() as fr24:
        results = fr24.flight_list.new_result_collection()  # (1)!
        async for result in fr24.flight_list.fetch_all(reg="B-LRA"):
            results.append(result)  # (2)!
            if input() == "x":
                break
            results.write_table(cache)
        print(results.to_polars()) # (3)!

await my_full_list()
# --8<-- [end:script1]
#%%
"""
# --8<-- [start:df1]
shape: (22, 15)
┌───────────┬────────┬──────────┬─────────┬───┬─────────────┬────────────┬────────────┬────────────┐
│ flight_id ┆ number ┆ callsign ┆ icao24  ┆ … ┆ ATOD        ┆ STOA       ┆ ETOA       ┆ ATOA       │
│ ---       ┆ ---    ┆ ---      ┆ ---     ┆   ┆ ---         ┆ ---        ┆ ---        ┆ ---        │
│ u64       ┆ str    ┆ str      ┆ u32     ┆   ┆ datetime[ms ┆ datetime[m ┆ datetime[m ┆ datetime[m │
│           ┆        ┆          ┆         ┆   ┆ , UTC]      ┆ s, UTC]    ┆ s, UTC]    ┆ s, UTC]    │
╞═══════════╪════════╪══════════╪═════════╪═══╪═════════════╪════════════╪════════════╪════════════╡
│ 952283415 ┆ CX382  ┆ CPA382   ┆ 7867035 ┆ … ┆ 2025-01-17  ┆ 2025-01-17 ┆ null       ┆ 2025-01-17 │
│           ┆        ┆          ┆         ┆   ┆ 11:14:41    ┆ 22:25:00   ┆            ┆ 22:15:37   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 952264050 ┆ CX383  ┆ CPA383   ┆ 7867035 ┆ … ┆ null        ┆ null       ┆ null       ┆ null       │
│ 952125211 ┆ CX383  ┆ CPA383   ┆ 7867035 ┆ … ┆ 2025-01-16  ┆ 2025-01-17 ┆ null       ┆ 2025-01-17 │
│           ┆        ┆          ┆         ┆   ┆ 17:57:05    ┆ 06:30:00   ┆            ┆ 06:53:54   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951961210 ┆ CX710  ┆ CPA710   ┆ 7867035 ┆ … ┆ 2025-01-16  ┆ 2025-01-16 ┆ null       ┆ 2025-01-16 │
│           ┆        ┆          ┆         ┆   ┆ 00:15:55    ┆ 03:55:00   ┆            ┆ 03:38:15   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951777224 ┆ CX735  ┆ CPA735   ┆ 7867035 ┆ … ┆ 2025-01-15  ┆ 2025-01-15 ┆ null       ┆ 2025-01-15 │
│           ┆        ┆          ┆         ┆   ┆ 06:44:49    ┆ 10:25:00   ┆            ┆ 10:31:32   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ …         ┆ …      ┆ …        ┆ …       ┆ … ┆ …           ┆ …          ┆ …          ┆ …          │
│ 951229708 ┆ CX624  ┆ CPA624   ┆ 7867035 ┆ … ┆ 2025-01-12  ┆ 2025-01-13 ┆ null       ┆ 2025-01-13 │
│           ┆        ┆          ┆         ┆   ┆ 20:15:14    ┆ 01:30:00   ┆            ┆ 00:59:37   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951146643 ┆ CX623  ┆ CPA623   ┆ 7867035 ┆ … ┆ 2025-01-12  ┆ 2025-01-12 ┆ null       ┆ 2025-01-12 │
│           ┆        ┆          ┆         ┆   ┆ 12:57:58    ┆ 18:55:00   ┆            ┆ 18:23:19   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951012767 ┆ CX714  ┆ CPA714   ┆ 7867035 ┆ … ┆ 2025-01-11  ┆ 2025-01-11 ┆ null       ┆ 2025-01-11 │
│           ┆        ┆          ┆         ┆   ┆ 18:55:20    ┆ 21:10:00   ┆            ┆ 22:05:36   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 950956719 ┆ CX715  ┆ CPA715   ┆ 7867035 ┆ … ┆ 2025-01-11  ┆ 2025-01-11 ┆ null       ┆ 2025-01-11 │
│           ┆        ┆          ┆         ┆   ┆ 13:03:44    ┆ 16:25:00   ┆            ┆ 16:29:15   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 950873921 ┆ CX162  ┆ CPA162   ┆ 7867035 ┆ … ┆ 2025-01-11  ┆ 2025-01-11 ┆ null       ┆ 2025-01-11 │
│           ┆        ┆          ┆         ┆   ┆ 01:09:49    ┆ 09:30:00   ┆            ┆ 09:41:27   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
└───────────┴────────┴──────────┴─────────┴───┴─────────────┴────────────┴────────────┴────────────┘

# --8<-- [end:df1]
"""
