UPDATE {{ sink_table_identifier_artifact }} t
	SET {{ sink_source_update_artifact }}
	{{ ',' ~ lu_sink_source_update_artifact if lu_sink_source_update_artifact else '' }}
	,_DMR = CURRENT_TIMESTAMP()
FROM (
		SELECT {{source_insert_artifact }}
		FROM {{ source_table_identifier_artifact }} s
		INNER JOIN {{ sink_table_identifier_artifact }} t ON t.BK = s.BK {{ lu_sink_source_join_artifact if lu_sink_source_join_artifact else '' }} AND ({{ sink_source_field_comparison_artifact }})
	) s
	WHERE t.BK = s.BK
	{%- if include_dq2 -%}
	AND s._isConvertError = 0
	{%- elif include_dq1 -%}
	AND s._VALID_FG = 1
	{%- else %}
	{%- endif %};
