{% if tenant -%}
CONCAT('{{ tenant }}-',
{%- elif bks|length > 1 -%}
CONCAT(
{%- endif -%}
{% for bk_artifact in bks -%}
{% if bk_artifact.startswith('!') -%}
IFNULL(TRIM(UPPER({{ bk_artifact[1:] }})), '#'){{ ", '-'," if not loop.last else ""}}
{%- else -%}
IFNULL(TRIM(UPPER(s.{{ bk_artifact }})), '#'){{ ", '-'," if not loop.last else ""}}
{%- endif -%}
{%- endfor -%}
{{')' if (bks|length > 1) or (tenant) else '' }}
