{% if tenant -%}
CONCAT('{{ tenant }}-',
{% elif bks|length > 1 -%}
CONCAT(
{%- endif -%}
{% for bk_artifact in bks -%}
{% if bk_artifact.startswith('!') -%}
ISNULL(LTRIM(RTRIM(UPPER({{ bk_artifact[1:] }}))), '#'){{ ", '-'," if not loop.last else ""}}
{% else -%}
ISNULL(LTRIM(RTRIM(UPPER(s.{{ bk_artifact }}))), '#'){{ ", '-'," if not loop.last else ""}}
{%- endif -%}
{%- endfor -%}
{{')' if (bks|length > 1) or (tenant) else '' }}
