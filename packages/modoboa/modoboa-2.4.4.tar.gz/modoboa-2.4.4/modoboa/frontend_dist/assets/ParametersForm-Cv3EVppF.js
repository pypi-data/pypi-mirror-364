import{j as C,b as P,n as S,h as E,g as v,L as x,m as u,a as m,w as i,F as f,G as y,o as s,c as d,J as N,l as I,t as h,q as j,e as L,f as z}from"./index-CxS_NEhX.js";import{_ as G}from"./HtmlEditor-D9iSAPvX.js";import{V as O,a as W,b as $,c as q}from"./VTabs-Bdut8SuQ.js";import{V as A}from"./VAvatar-BWz36bzo.js";import{V as D}from"./VContainer-CXGjDFr-.js";import{b as H,V as J}from"./VCard-C21tXVcv.js";import{V as M}from"./VSwitch-DKdPACrz.js";import{V as K}from"./VSelect-C8ZuOdaG.js";import{V as Q}from"./VTextarea-FMcKLtXm.js";import{V as R}from"./VTextField-BHmHk0IU.js";const X={key:0},Y={class:"m-label"},Z={__name:"ParametersForm",props:{app:{type:String,default:""},structure:{type:Array,default:null},values:{type:Object,default:null},saveFunction:{type:Function,default:null}},emits:["success"],setup(k,{emit:F}){const c=k,U=F,{$gettext:g}=P(),{displayNotification:_}=S(),b=E(()=>c.structure.filter(o=>w(o))),V=v(0),n=v({}),l=v({}),p=v([]);x(()=>c.values,o=>{o&&(l.value={...o})}),x(l,()=>{p.value=[]});function w(o){if(o.display==="")return!0;let r=!0;return o.display.split("&").forEach(a=>{let[e,t]=a.split("=");(t==="true"||t==="false")&&(t=!!t),r&=l.value[e]===t}),r}function T(o){return o.filter(r=>w(r))}async function B(){n.value={},p.value=[];try{await c.saveFunction(c.app,l.value),_({msg:g("Parameters updated")}),U("success",l.value)}catch(o){_({msg:g("Could not save parameters"),type:"error"}),n.value=o.response.data,Object.keys(n.value).forEach(r=>{for(let a=0;a<c.structure.length;a++)c.structure[a].parameters.filter(t=>t.name===r).length>0&&p.value.push(a)})}}return(o,r)=>(s(),u(f,null,[m(O,{modelValue:V.value,"onUpdate:modelValue":r[0]||(r[0]=a=>V.value=a),"bg-color":"white"},{default:i(()=>[(s(!0),u(f,null,y(b.value,(a,e)=>(s(),d($,{key:e,color:"primary",class:N(p.value.includes(e)?"error_tab":"")},{default:i(()=>[I(h(a.label),1)]),_:2},1032,["class"]))),128))]),_:1},8,["modelValue"]),m(W,{modelValue:V.value,"onUpdate:modelValue":r[1]||(r[1]=a=>V.value=a)},{default:i(()=>[(s(!0),u(f,null,y(b.value,a=>(s(),d(q,{key:a.label},{default:i(()=>[m(D,{fluid:"",class:"pa-0"},{default:i(()=>[m(H,null,{default:i(()=>[m(J,null,{default:i(()=>[(s(!0),u(f,null,y(T(a.parameters),e=>(s(),u("div",{key:e.name,class:"my-4"},[e.widget==="SeparatorField"?(s(),u("h2",X,h(e.label),1)):e.widget==="BooleanField"?(s(),u(f,{key:1},[e.widget==="BooleanField"?(s(),d(M,{key:0,modelValue:l.value[e.name],"onUpdate:modelValue":t=>l.value[e.name]=t,label:e.label,hint:e.help_text,error:n.value[e.name]!==void 0,color:"primary",density:"compact","error-messages":n.value[e.name],"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","hint","error","error-messages"])):j("",!0)],64)):(s(),u(f,{key:2},[L("label",Y,h(e.label),1),e.widget==="ChoiceField"?(s(),d(K,{key:0,modelValue:l.value[e.name],"onUpdate:modelValue":t=>l.value[e.name]=t,items:e.choices,"item-title":"text",hint:e.help_text,"persistent-hint":"",density:"compact",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items","hint"])):e.widget==="TextareaField"?(s(),d(Q,{key:1,modelValue:l.value[e.name],"onUpdate:modelValue":t=>l.value[e.name]=t,hint:e.help_text,"persistent-hint":"",error:n.value[e.name]!==void 0,"error-messages":n.value[e.name],type:e.widget==="PasswordField"?"password":"text",density:"compact",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","hint","error","error-messages","type"])):e.widget==="HTMLField"?(s(),d(z(G),{key:2,modelValue:l.value[e.name],"onUpdate:modelValue":t=>l.value[e.name]=t},null,8,["modelValue","onUpdate:modelValue"])):(s(),d(R,{key:3,modelValue:l.value[e.name],"onUpdate:modelValue":t=>l.value[e.name]=t,hint:e.help_text,"persistent-hint":"",error:n.value[e.name]!==void 0,"error-messages":n.value[e.name],type:e.widget==="PasswordField"?"password":"text",density:"compact",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","hint","error","error-messages","type"]))],64))]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"]),m(A,{icon:"mdi-content-save",class:"ma-5",position:"fixed",location:"bottom right",color:"green",size:"large",onClick:B})],64))}},de=C(Z,[["__scopeId","data-v-a4919ac7"]]);export{de as P};
