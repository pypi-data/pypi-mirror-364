"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[1783],{71783:(t,e,i)=>{i.r(e),i.d(e,{ScreenCapture:()=>h,default:()=>a});var o=i(9387),n=i(57583),s=i.n(n),r=i(18683);function d(t,e,i){return(e=function(t){var e=function(t){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h extends o.Component{constructor(...t){super(...t),d(this,"state",{on:!1,startX:0,startY:0,endX:0,endY:0,crossHairsTop:0,crossHairsLeft:0,isMouseDown:!1,windowWidth:0,windowHeight:0,borderWidth:0,cropPositionTop:0,cropPositionLeft:0,cropWidth:0,cropHeigth:0,imageURL:""}),d(this,"handleWindowResize",()=>{const t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;this.setState({windowWidth:t,windowHeight:e})}),d(this,"componentDidMount",()=>{this.handleWindowResize(),window.addEventListener("resize",this.handleWindowResize)}),d(this,"componentWillUnmount",()=>{window.removeEventListener("resize",this.handleWindowResize)}),d(this,"handStartCapture",()=>this.setState({on:!0})),d(this,"handleMouseMove",t=>{const{isMouseDown:e,windowWidth:i,windowHeight:o,startX:n,startY:s,borderWidth:r}=this.state;let d=s,h=n;const a=t.clientX,c=t.clientY,p=c>=s,l=c<=s,u=a>=n,w=a<=n;let m=r,x=0,f=0;e&&(p&&u&&(m=`${s}px ${i-a}px ${o-c}px ${n}px`,x=a-n,f=c-s),p&&w&&(m=`${s}px ${i-n}px ${o-c}px ${a}px`,x=n-a,f=c-s,h=a),l&&u&&(m=`${c}px ${i-a}px ${o-s}px ${n}px`,x=a-n,f=s-c,d=c),l&&w&&(m=`${c}px ${i-n}px ${o-s}px ${a}px`,x=n-a,f=s-c,h=a,d=c)),x*=window.devicePixelRatio,f*=window.devicePixelRatio,this.setState({crossHairsTop:t.clientY,crossHairsLeft:t.clientX,borderWidth:m,cropWidth:x,cropHeigth:f,cropPositionTop:d,cropPositionLeft:h})}),d(this,"handleMouseDown",t=>{const e=t.clientX,i=t.clientY;this.setState(t=>({startX:e,startY:i,cropPositionTop:i,cropPositionLeft:e,isMouseDown:!0,borderWidth:`${t.windowWidth}px ${t.windowHeight}px`}))}),d(this,"handleMouseUp",()=>{this.handleClickTakeScreenShot(),this.setState({on:!1,isMouseDown:!1,borderWidth:0})}),d(this,"handleClickTakeScreenShot",()=>{const{windowWidth:t,windowHeight:e,cropPositionTop:i,cropPositionLeft:o,cropWidth:n,cropHeigth:r}=this.state,d=document.querySelector("body");if(d){let h=window.devicePixelRatio;s()(d,{width:t,height:e,scale:h}).then(t=>{const e=document.createElement("canvas"),s=e.getContext("2d");if(e.width=n,e.height=r,s&&s.drawImage(t,o*h,i*h,n*h,r*h,0,0,n*h,r*h),e){const t="image/png",i=1,o=e.toDataURL(t,i);this.props.onEndCapture(o)}})}this.setState({crossHairsTop:0,crossHairsLeft:0})}),d(this,"renderChild",()=>{const{children:t}=this.props,e={onStartCapture:this.handStartCapture};return"function"==typeof t?t(e):t})}render(){const{on:t,crossHairsTop:e,crossHairsLeft:i,borderWidth:o,isMouseDown:n}=this.state;return t?(0,r.jsxs)("div",{onMouseMove:this.handleMouseMove,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,children:[this.renderChild(),(0,r.jsx)("div",{className:`overlay ${n&&"highlighting"}`,style:{borderWidth:`${o}`}}),(0,r.jsx)("div",{className:"crosshairs",style:{left:i+"px",top:e+"px"}})]}):this.renderChild()}}const a=h}}]);