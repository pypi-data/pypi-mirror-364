<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RemoteRunLib Dashboard</title>
    <!-- FontAwesome CDN for icons -->
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        crossorigin="anonymous">
    <!-- Socket.IO client for live logs -->

    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-server"></i> RemoteRunLib</h2>
            </div>
            <ul class="nav-menu">
                <li class="nav-item active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </li>
                <li class="nav-item" data-section="machines">
                    <i class="fas fa-desktop"></i>
                    <span>Machines</span>
                </li>
                <li class="nav-item" data-section="commands">
                    <i class="fas fa-terminal"></i>
                    <span>Execute Commands</span>
                </li>
                <li class="nav-item" data-section="python">
                    <i class="fab fa-python"></i>
                    <span>Python Scripts</span>
                </li>
                <li class="nav-item" data-section="ansible">
                    <i class="fas fa-cogs"></i>
                    <span>Ansible Playbooks</span>
                </li>
                <li class="nav-item" data-section="terraform">
                    <i class="fas fa-cloud"></i>
                    <span>Terraform</span>
                </li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <h1 id="page-title">Dashboard</h1>
                <div class="header-actions">
                    <!-- Dynamic header actions will be populated here -->
                </div>
            </header>

            <!-- Dashboard Section -->
            <section id="dashboard-section" class="content-section active">
                <div class="dashboard-container">
                    <!-- Dashboard Stats -->
                    <div class="dashboard-stats">
                        <div class="stat-card">
                            <div class="stat-icon success">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="successful-executions">0</h3>
                                <p>Successful Executions</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon error">
                                <i class="fas fa-times-circle"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="failed-executions">0</h3>
                                <p>Failed Executions</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon info">
                                <i class="fas fa-server"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="active-machines">0</h3>
                                <p>Active Machines</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon warning">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="recent-executions">0</h3>
                                <p>Last 24h Executions</p>
                            </div>
                        </div>
                    </div>

                    <!-- Filters and Controls -->
                    <div class="dashboard-controls">
                        <div class="filter-group">
                            <label for="machine-filter">Filter by Machine:</label>
                            <select id="machine-filter" class="form-control">
                                <option value="">All Machines</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="type-filter">Filter by Type:</label>
                            <select id="type-filter" class="form-control">
                                <option value="">All Types</option>
                                <option value="command">Commands</option>
                                <option value="python">Python Scripts</option>
                                <option value="ansible">Ansible Playbooks</option>
                                <option value="terraform">Terraform</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="status-filter">Filter by Status:</label>
                            <select id="status-filter" class="form-control">
                                <option value="">All Status</option>
                                <option value="success">Success</option>
                                <option value="failed">Failed</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-secondary" id="refresh-dashboard-btn">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    </div>

                    <!-- Execution History -->
                    <div class="execution-history">
                        <div class="history-header">
                            <h3><i class="fas fa-history"></i> Execution History</h3>
                            <div class="history-controls">
                                <button class="btn btn-sm btn-secondary" id="clear-history-btn">
                                    <i class="fas fa-trash"></i> Clear History
                                </button>
                            </div>
                        </div>
                        <div class="execution-list" id="execution-list">
                            <!-- Execution items will be populated here -->
                            <div class="empty-state">
                                <i class="fas fa-inbox"></i>
                                <p>No executions found</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Machines Section -->
            <section id="machines-section" class="content-section">
                <div class="machines-grid" id="machines-grid">
                    <!-- Machine cards will be populated here -->
                </div>
            </section>

            <!-- Commands Section -->
            <section id="commands-section" class="content-section">
                <div class="command-panel">
                    <div class="form-group">
                        <label for="command-machine-select">Select Machine:</label>
                        <select id="command-machine-select" class="form-control">
                            <option value="">Choose a machine...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="command-input">Command:</label>
                        <textarea id="command-input" class="form-control" placeholder="Enter command to execute..."
                            rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="command-timeout">Timeout (seconds):</label>
                        <input type="number" id="command-timeout" class="form-control" value="30" min="1" max="3600">
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-success" id="execute-command-btn">
                            <i class="fas fa-play"></i> Execute
                        </button>
                        <button class="btn btn-secondary" id="clear-command-btn">
                            <i class="fas fa-eraser"></i> Clear
                        </button>
                    </div>
                </div>
            </section>

            <!-- Python Scripts Section -->
            <section id="python-section" class="content-section">
                <div class="script-panel">
                    <div class="form-group">
                        <label for="python-machine-select">Select Machine:</label>
                        <select id="python-machine-select" class="form-control">
                            <option value="">Choose a machine...</option>
                        </select>
                    </div>
                    <div class="file-upload-section">
                        <div class="upload-tabs">
                            <button class="tab-btn active" data-tab="upload">Upload File</button>
                            <button class="tab-btn" data-tab="existing">Existing Files</button>
                            <button class="tab-btn" data-tab="editor">Script Editor</button>
                        </div>
                        <div class="tab-content">
                            <div id="upload-tab" class="tab-pane active">
                                <div class="drop-zone" id="python-drop-zone">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <p>Drag & drop Python files here or click to browse</p>
                                    <input type="file" id="python-file-input" accept=".py" multiple hidden>
                                </div>
                            </div>
                            <div id="existing-tab" class="tab-pane">
                                <div class="file-list" id="python-file-list">
                                    <!-- Existing files will be listed here -->
                                </div>
                            </div>
                            <div id="editor-tab" class="tab-pane">
                                <div class="code-editor-container">
                                    <div class="editor-header">
                                        <div class="editor-tabs">
                                            <div class="editor-tab active">
                                                <i class="fab fa-python"></i>
                                                <span id="python-tab-name">script.py</span>
                                                <button class="tab-close">×</button>
                                            </div>
                                        </div>
                                        <div class="editor-controls">
                                            <button class="editor-btn" title="Format Code"><i
                                                    class="fas fa-magic"></i></button>
                                            <button class="editor-btn" title="Find & Replace"><i
                                                    class="fas fa-search"></i></button>
                                        </div>
                                    </div>
                                    <div class="code-editor-wrapper">
                                        <div class="line-numbers" id="python-line-numbers"></div>
                                        <textarea id="python-editor" class="code-editor"
                                            placeholder="# Write your Python script here..."
                                            spellcheck="false"></textarea>
                                    </div>
                                </div>
                                <div class="editor-actions">
                                    <input type="text" id="python-filename" class="form-control"
                                        placeholder="script_name.py">
                                    <button class="btn btn-primary" id="save-python-btn">
                                        <i class="fas fa-save"></i> Save
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-success" id="run-python-btn">
                            <i class="fas fa-play"></i> Run
                        </button>
                        <button class="btn btn-secondary" id="clear-python-btn">
                            <i class="fas fa-eraser"></i> Clear
                        </button>
                    </div>
                </div>
            </section>

            <!-- Ansible Section -->
            <section id="ansible-section" class="content-section">
                <div class="script-panel">
                    <div class="form-group">
                        <label for="ansible-machine-select">Select Machine:</label>
                        <select id="ansible-machine-select" class="form-control">
                            <option value="">Choose a machine...</option>
                        </select>
                    </div>
                    <div class="ansible-mode-toggle">
                        <button class="mode-btn active" data-mode="adhoc">Ad-hoc Command</button>
                        <button class="mode-btn" data-mode="playbook">Playbook</button>
                    </div>
                    <div id="adhoc-mode" class="mode-content active">
                        <div class="form-group">
                            <label for="ansible-module">Module:</label>
                            <select id="ansible-module" class="form-control">
                                <option value="command">command</option>
                                <option value="shell">shell</option>
                                <option value="copy">copy</option>
                                <option value="file">file</option>
                                <option value="service">service</option>
                                <option value="yum">yum</option>
                                <option value="apt">apt</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="ansible-args">Arguments:</label>
                            <textarea id="ansible-args" class="form-control" placeholder="Module arguments..."
                                rows="3"></textarea>
                        </div>
                    </div>
                    <div id="playbook-mode" class="mode-content">
                        <div class="file-upload-section">
                            <div class="upload-tabs">
                                <button class="tab-btn active" data-tab="upload-ansible">Upload Playbook</button>
                                <button class="tab-btn" data-tab="existing-ansible">Existing Playbooks</button>
                                <button class="tab-btn" data-tab="editor-ansible">Playbook Editor</button>
                            </div>
                            <div class="tab-content">
                                <div id="upload-ansible-tab" class="tab-pane active">
                                    <div class="drop-zone" id="ansible-drop-zone">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                        <p>Drag & drop Ansible playbooks here or click to browse</p>
                                        <input type="file" id="ansible-file-input" accept=".yml,.yaml" multiple hidden>
                                    </div>
                                </div>
                                <div id="existing-ansible-tab" class="tab-pane">
                                    <div class="file-list" id="ansible-file-list">
                                        <!-- Existing playbooks will be listed here -->
                                    </div>
                                </div>
                                <div id="editor-ansible-tab" class="tab-pane">
                                    <div class="code-editor-container">
                                        <div class="editor-header">
                                            <div class="editor-tabs">
                                                <div class="editor-tab active">
                                                    <i class="fas fa-file-code"></i>
                                                    <span id="ansible-tab-name">playbook.yml</span>
                                                    <button class="tab-close">×</button>
                                                </div>
                                            </div>
                                            <div class="editor-controls">
                                                <button class="editor-btn" title="Format YAML"><i
                                                        class="fas fa-magic"></i></button>
                                                <button class="editor-btn" title="Validate YAML"><i
                                                        class="fas fa-check"></i></button>
                                            </div>
                                        </div>
                                        <div class="code-editor-wrapper">
                                            <div class="line-numbers" id="ansible-line-numbers"></div>
                                            <textarea id="ansible-editor" class="code-editor"
                                                placeholder="# Write your Ansible playbook YAML here..."
                                                spellcheck="false"></textarea>
                                        </div>
                                    </div>
                                    <div class="editor-actions">
                                        <input type="text" id="ansible-filename" class="form-control"
                                            placeholder="playbook.yml">
                                        <button class="btn btn-primary" id="save-ansible-editor-btn">
                                            <i class="fas fa-save"></i> Save
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-success" id="run-ansible-btn">
                            <i class="fas fa-play"></i> Run
                        </button>
                        <button class="btn btn-primary" id="save-ansible-btn">
                            <i class="fas fa-save"></i> Save
                        </button>
                    </div>
                </div>
            </section>

            <!-- Terraform Section -->
            <section id="terraform-section" class="content-section">
                <div class="script-panel">
                    <div class="form-group">
                        <label for="terraform-machine-select">Select Machine:</label>
                        <select id="terraform-machine-select" class="form-control">
                            <option value="">Choose a machine...</option>
                        </select>
                    </div>
                    <div class="file-upload-section">
                        <div class="upload-tabs">
                            <button class="tab-btn active" data-tab="upload-tf">Upload Files</button>
                            <button class="tab-btn" data-tab="existing-tf">Existing Files</button>
                            <button class="tab-btn" data-tab="editor-tf">Config Editor</button>
                        </div>
                        <div class="tab-content">
                            <div id="upload-tf-tab" class="tab-pane active">
                                <div class="drop-zone" id="terraform-drop-zone">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <p>Drag & drop Terraform files here or click to browse</p>
                                    <input type="file" id="terraform-file-input" accept=".tf,.tfvars" multiple hidden>
                                </div>
                            </div>
                            <div id="existing-tf-tab" class="tab-pane">
                                <div class="file-list" id="terraform-file-list">
                                    <!-- Existing files will be listed here -->
                                </div>
                            </div>
                            <div id="editor-tf-tab" class="tab-pane">
                                <div class="code-editor-container">
                                    <div class="editor-header">
                                        <div class="editor-tabs">
                                            <div class="editor-tab active">
                                                <i class="fas fa-cloud"></i>
                                                <span id="terraform-tab-name">main.tf</span>
                                                <button class="tab-close">×</button>
                                            </div>
                                        </div>
                                        <div class="editor-controls">
                                            <button class="editor-btn" title="Format HCL"><i
                                                    class="fas fa-magic"></i></button>
                                            <button class="editor-btn" title="Validate Config"><i
                                                    class="fas fa-check"></i></button>
                                        </div>
                                    </div>
                                    <div class="code-editor-wrapper">
                                        <div class="line-numbers" id="terraform-line-numbers"></div>
                                        <textarea id="terraform-editor" class="code-editor"
                                            placeholder="# Write your Terraform configuration here..."
                                            spellcheck="false"></textarea>
                                    </div>
                                </div>
                                <div class="editor-actions">
                                    <input type="text" id="terraform-filename" class="form-control"
                                        placeholder="main.tf">
                                    <button class="btn btn-primary" id="save-terraform-btn">
                                        <i class="fas fa-save"></i> Save
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="terraform-actions">
                        <button class="btn btn-info" id="terraform-plan-btn">
                            <i class="fas fa-search"></i> Plan
                        </button>
                        <button class="btn btn-success" id="terraform-apply-btn">
                            <i class="fas fa-play"></i> Apply
                        </button>
                        <button class="btn btn-warning" id="terraform-destroy-btn">
                            <i class="fas fa-trash"></i> Destroy
                        </button>
                        <button class="btn btn-secondary" id="clear-terraform-btn">
                            <i class="fas fa-eraser"></i> Clear
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Live Logs Panel -->
        <div class="logs-panel" id="logs-panel">
            <div class="logs-header">
                <h3><i class="fas fa-list-alt"></i> Live Logs</h3>
                <div class="logs-controls">
                    <button class="btn btn-sm btn-secondary" id="clear-logs-btn" title="Clear Logs">
                        <i class="fas fa-eraser"></i>
                    </button>
                    <button class="btn btn-sm btn-secondary" id="maximize-logs-btn" title="Maximize">
                        <i class="fas fa-expand"></i>
                    </button>
                    <button class="btn btn-sm btn-secondary" id="minimize-logs-btn" title="Minimize"
                        style="display: none;">
                        <i class="fas fa-compress"></i>
                    </button>
                    <button class="btn btn-sm btn-secondary" id="toggle-logs-btn" title="Collapse">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
            </div>
            <div class="logs-content" id="logs-content">
                <div class="log-entry">
                    <span class="log-timestamp">[2024-01-20 10:30:00]</span>
                    <span class="log-level info">INFO</span>
                    <span class="log-message">System ready</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Add Machine Modal -->
    <div class="modal" id="add-machine-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Machine</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-machine-form">
                    <input type="hidden" id="machine-id">
                    <div class="form-group">
                        <label for="machine-name">Machine Name:</label>
                        <input type="text" id="machine-name" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="machine-host">Host/IP:</label>
                        <input type="text" id="machine-host" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="machine-port">Port:</label>
                        <input type="number" id="machine-port" class="form-control" value="22">
                    </div>
                    <div class="form-group">
                        <label for="machine-username">Username:</label>
                        <input type="text" id="machine-username" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="machine-auth-type">Authentication:</label>
                        <select id="machine-auth-type" class="form-control">
                            <option value="password">Password</option>
                            <option value="key">SSH Key</option>
                        </select>
                    </div>
                    <div class="form-group" id="password-group">
                        <label for="machine-password">Password:</label>
                        <input type="password" id="machine-password" class="form-control">
                    </div>
                    <div class="form-group hidden" id="key-group">
                        <label for="machine-key">SSH Key Path:</label>
                        <input type="text" id="machine-key" class="form-control" placeholder="/path/to/private/key">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-machine-btn">Cancel</button>
                <button class="btn btn-info" id="test-connection-btn">Test Connection</button>
                <button class="btn btn-primary" id="save-machine-btn">Save Machine</button>
            </div>
        </div>
    </div>

    <!-- Execution Details Modal -->
    <div class="modal" id="execution-details-modal">
        <div class="modal-content execution-modal">
            <div class="modal-header">
                <h3 id="execution-modal-title">Execution Details</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="execution-details">
                    <div class="detail-section">
                        <h4><i class="fas fa-info-circle"></i> Execution Info</h4>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <label>Machine:</label>
                                <span id="detail-machine"></span>
                            </div>
                            <div class="detail-item">
                                <label>Type:</label>
                                <span id="detail-type"></span>
                            </div>
                            <div class="detail-item">
                                <label>Status:</label>
                                <span id="detail-status"></span>
                            </div>
                            <div class="detail-item">
                                <label>Duration:</label>
                                <span id="detail-duration"></span>
                            </div>
                            <div class="detail-item">
                                <label>Started:</label>
                                <span id="detail-started"></span>
                            </div>
                            <div class="detail-item">
                                <label>Completed:</label>
                                <span id="detail-completed"></span>
                            </div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4><i class="fas fa-code"></i> Command/Script</h4>
                        <div class="code-display">
                            <pre id="detail-command"></pre>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4><i class="fas fa-terminal"></i> Output</h4>
                        <div class="output-display">
                            <pre id="detail-output"></pre>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4><i class="fas fa-list-alt"></i> Logs</h4>
                        <div class="logs-display">
                            <div id="detail-logs"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="close-execution-details-btn">Close</button>
                <!-- <button class="btn btn-primary" id="rerun-execution-btn">
                    <i class="fas fa-redo"></i> Re-run
                </button> -->
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Processing...</p>
        </div>
    </div>

    <script src="script.js" defer></script>
</body>

</html>