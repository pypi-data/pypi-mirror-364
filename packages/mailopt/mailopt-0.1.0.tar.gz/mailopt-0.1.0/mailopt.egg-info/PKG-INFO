Metadata-Version: 2.4
Name: mailopt
Version: 0.1.0
Summary: CLI Python pour automatiser et optimiser les workflows email/front-end
Home-page: https://github.com/vml-marketing-mail/mailopt
Author: Souleymane SALL
Author-email: souleymanesallvml@gmail.com
Project-URL: Bug Reports, https://github.com/vml-marketing-mail/mailopt/issues
Project-URL: Source, https://github.com/vml-marketing-mail/mailopt
Project-URL: Documentation, https://github.com/vml-marketing-mail/mailopt#readme
Keywords: email,cli,automation,optimization,frontend,workflow
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: Topic :: Software Development :: Build Tools
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Internet :: WWW/HTTP
Classifier: Topic :: Communications :: Email
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Operating System :: OS Independent
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: click>=8.0.0
Requires-Dist: beautifulsoup4>=4.9.0
Requires-Dist: lxml>=4.6.0
Requires-Dist: importlib_metadata>=4.0.0; python_version < "3.8"
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: flake8>=5.0.0; extra == "dev"
Requires-Dist: pylint>=2.15.0; extra == "dev"
Requires-Dist: black>=22.0.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Requires-Dist: bandit>=1.7.0; extra == "dev"
Requires-Dist: safety>=2.0.0; extra == "dev"
Provides-Extra: test
Requires-Dist: pytest>=7.0.0; extra == "test"
Requires-Dist: pytest-cov>=4.0.0; extra == "test"
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: keywords
Dynamic: project-url
Dynamic: provides-extra
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# MailOpt

[![CI](https://github.com/your-username/mailopt/workflows/CI/badge.svg)](https://github.com/your-username/mailopt/actions)
[![Coverage](https://codecov.io/gh/your-username/mailopt/branch/master/graph/badge.svg)](https://codecov.io/gh/your-username/mailopt)
[![PyPI](https://img.shields.io/pypi/v/mailopt.svg)](https://pypi.org/project/mailopt/)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](https://opensource.org/licenses/MIT)

**CLI Python pour automatiser et optimiser les workflows email/front-end**

## Table des mati√®res

- [Motivation & Contexte](#motivation--contexte)
- [Fonctionnalit√©s cl√©s](#fonctionnalit√©s-cl√©s)
- [Installation](#installation)
- [Usage rapide](#usage-rapide)
- [D√©tail des commandes](#d√©tail-des-commandes)
- [Configuration](#configuration)
- [Extensibilit√© & Plugins](#extensibilit√©--plugins)
- [D√©veloppement & Tests](#d√©veloppement--tests)
- [Outils de d√©veloppement](#outils-de-d√©veloppement)
- [CI/CD](#cicd)
- [Workflow Git & Contribuer](#workflow-git--contribuer)
- [Roadmap & Perspectives](#roadmap--perspectives)
- [Licence](#licence)
- [Contacts & Liens](#contacts--liens)

## Motivation & Contexte

### Pourquoi cr√©er mailopt ?

Le d√©veloppement d'emails implique de nombreuses t√¢ches r√©p√©titives et chronophages qui fragmentent le workflow des d√©veloppeurs. `mailopt` na√Æt du besoin d'unifier et d'automatiser ces processus pour permettre aux √©quipes de se concentrer sur la cr√©ation de contenu de qualit√©.

### Probl√®mes r√©solus

- **Inlining CSS manuel** ‚Üí Automatisation compl√®te avec `mailopt inline`
- **Validation d'assets** ‚Üí V√©rification automatique des images et liens
- **Tests de compatibilit√©** ‚Üí Int√©gration Litmus et captures d'√©cran
- **Optimisation manuelle** ‚Üí Minification et optimisation automatiques
- **Workflow fragment√©** ‚Üí Unification de tous les outils d'optimisation email

## Fonctionnalit√©s cl√©s

### Commandes c≈ìur

| Commande                              | Description                                               |
| ------------------------------------- | --------------------------------------------------------- |
| **`mailopt new <dir>`**               | G√©n√®re la structure de base d'un projet email/site        |
| **`mailopt inline <dir>`**            | Inline CSS pour templates email-safe                      |
| **`mailopt check-images <dir>`**      | V√©rifie existence & casse des images r√©f√©renc√©es          |
| **`mailopt embed-images <dir>`**      | Encode en Base64 / upload CDN et remplace balises `<img>` |
| **`mailopt check-links <dir>`**       | Head-request et rapport sur les liens `<a>`               |
| **`mailopt find-orphans <dir>`**      | Liste fichiers assets non utilis√©s                        |
| **`mailopt lint-names <dir>`**        | V√©rifie conventions de nommage                            |
| **`mailopt unused-css <dir>`**        | D√©tecte s√©lecteurs CSS non utilis√©s                       |
| **`mailopt minify <dir>`**            | Concat√®ne & minifie CSS/JS selon manifest                 |
| **`mailopt audit <dir>`**             | Audit d'accessibilit√© & rapport spam-score                |
| **`mailopt snapshot <dir>`**          | G√©n√®re captures (desktop/mobile) via Playwright           |
| **`mailopt merge-tags <csv> <tmpl>`** | G√©n√®re HTML personnalis√©s depuis CSV                      |
| **`mailopt litmus <dir>`**            | Lance les tests email sur Litmus via l'API                |

## Installation

### Pr√©requis

- Python ‚â• 3.10
- pip

### Installation

```bash
# Cloner le repository
git clone https://github.com/your-username/mailopt.git
cd mailopt

# Cr√©er un environnement virtuel
python -m venv venv

# Activer l'environnement virtuel
# Windows
venv\Scripts\activate
# macOS/Linux
source venv/bin/activate

# Installation avec toutes les d√©pendances
pip install -r requirements.txt

# Ou installation en mode d√©veloppement
pip install -r requirements-dev.txt
pip install -e .

# Ou depuis PyPI (quand publi√©)
pip install mailopt
```

## Usage rapide

### Exemples de base

```bash
# Cr√©er un nouveau projet email
mailopt new ./my-email

# Inliner le CSS pour compatibilit√© email
mailopt inline ./my-email

# V√©rifier les images avec correction automatique
mailopt check-images ./my-email --fix
```

### Flags g√©n√©raux

```bash
mailopt --help      # Aide g√©n√©rale
mailopt --version   # Version du CLI
mailopt <command> --help  # Aide pour une commande sp√©cifique
```

## D√©tail des commandes

### `mailopt check-images <dir> [--fix]`

**Objectif :** V√©rifie existence & casse des images r√©f√©renc√©es

**Options :**

- `--fix` : Corriger automatiquement les probl√®mes d√©tect√©s
- `--verbose` : Affichage d√©taill√©
- `--suggest-formats` : Sugg√©rer des formats optimis√©s

**Exemple :**

```bash
mailopt check-images ./email.html --fix --verbose
```

**Fonctionnalit√©s :**

- D√©tecte toutes les balises `<img src="...">` locales
- V√©rifie que les images existent dans `images/` ou `img/`
- Corrige automatiquement les probl√®mes de casse
- Cr√©e une sauvegarde `.bak` lors des corrections
- Ignore les URLs externes (http://, https://, //)

## Configuration

### Format de `mailopt.config.yaml`

```yaml
# mailopt.config.yaml
defaults:
  image_quality: 85
  output_format: webp
  preserve_metadata: false
  email_clients: [outlook, gmail, apple-mail, thunderbird]

commands:
  check_images:
    max_width: 1200
    max_height: 800
    allowed_formats: [jpg, png, webp]
    check_case_sensitivity: true

paths:
  templates: ./templates/
  assets: ./assets/
  output: ./dist/
  reports: ./reports/
```

## Extensibilit√© & Plugins

### Architecture plugin via entry_points

`mailopt` utilise un syst√®me de plugins bas√© sur les `entry_points` de Python pour charger automatiquement les commandes.

### Ajouter sa propre commande

1. **Cr√©er un fichier de commande** dans `mailopt/commands/` :

```python
# mailopt/commands/my_command.py
import click
from mailopt import utils

@click.command()
@click.option('--name', default='world', help='Nom √† saluer')
def my_command(name):
    """Ma commande personnalis√©e."""
    click.echo(f"Bonjour, {name}!")
    # Votre logique ici
```

2. **Enregistrer la commande** dans `setup.py` :

```python
# setup.py
entry_points={
    'console_scripts': [
        'mailopt=mailopt.cli:main',
    ],
    'mailopt.commands': [
        'my-command=mailopt.commands.my_command:my_command',
    ],
}
```

3. **Utiliser votre commande** :

```bash
mailopt my-command --name "D√©veloppeur"
```

## D√©veloppement & Tests

### Structure du repo

```
mailopt/
‚îú‚îÄ‚îÄ setup.py              # Metadata & entry_points
‚îú‚îÄ‚îÄ pyproject.toml        # Build system
‚îú‚îÄ‚îÄ requirements.txt      # Toutes les d√©pendances
‚îú‚îÄ‚îÄ requirements-dev.txt  # D√©pendances de d√©veloppement
‚îú‚îÄ‚îÄ README.md             # Documentation
‚îú‚îÄ‚îÄ .gitignore            # Fichiers √† ignorer par Git
‚îú‚îÄ‚îÄ mailopt/              # Code source
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ cli.py            # Point d'entr√©e (click.group)
‚îÇ   ‚îú‚îÄ‚îÄ utils.py          # Fonctions utilitaires partag√©es
‚îÇ   ‚îî‚îÄ‚îÄ commands/         # Sous-commandes
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ images.py     # Exemple: check-images
‚îú‚îÄ‚îÄ tests/                # Tests unitaires (pytest)
‚îÇ   ‚îî‚îÄ‚îÄ test_images.py
‚îî‚îÄ‚îÄ venv/                 # Environnement virtuel (ignor√© par Git)
```

### Fichiers de d√©pendances

- **`requirements.txt`** : Toutes les d√©pendances (core + dev)
- **`requirements-dev.txt`** : D√©pendances de d√©veloppement uniquement
- **`setup.py`** : Configuration du package avec entry points

### Fichiers et dossiers ignor√©s

Le projet utilise un `.gitignore` simple qui exclut :

- **`*.egg-info/`** : M√©tadonn√©es g√©n√©r√©es par setuptools lors de l'installation
- **`venv/`** : Environnement virtuel Python
- **`__pycache__/`** : Cache Python compil√©
- **`.pytest_cache/`** : Cache des tests pytest
- **`*.bak`** : Fichiers de sauvegarde cr√©√©s par mailopt
- **Fichiers IDE** : `.vscode/`, `.idea/`, etc.
- **Fichiers syst√®me** : `.DS_Store`, `Thumbs.db`

### Le dossier `mailopt.egg-info`

Le dossier `mailopt.egg-info/` est **automatiquement g√©n√©r√©** par setuptools lors de l'installation du package avec `pip install -e .`. Il contient :

- **M√©tadonn√©es du package** : version, auteur, description
- **Liste des fichiers** : fichiers inclus dans le package
- **Entry points** : commandes CLI enregistr√©es
- **D√©pendances** : packages requis

**Pourquoi l'ignorer ?**

- G√©n√©r√© automatiquement, pas besoin de versionner
- Sp√©cifique √† l'environnement d'installation
- Peut causer des conflits entre d√©veloppeurs
- Reconstruit automatiquement lors de l'installation

### Lancer les tests

```bash
# Tous les tests
pytest tests/

# Avec couverture
pytest --cov=mailopt tests/

# Tests sp√©cifiques
pytest tests/test_images.py -v

# Tests avec marqueurs
pytest -m "not slow"  # Exclure les tests lents
pytest -m integration # Tests d'int√©gration uniquement
```

## Outils de d√©veloppement

### Formateurs de code

#### **Black** - Formateur de code automatique

```bash
# Installer Black
pip install black

# Formater le code
black mailopt/ tests/

# V√©rifier le formatage (sans modifier)
black --check mailopt/ tests/

# Configuration dans pyproject.toml
[tool.black]
line-length = 88
target-version = ['py310']
include = '\.pyi?$'
extend-exclude = '''
/(
  # directories
  \.eggs
  | \.git
  | \.hg
  | \.mypy_cache
  | \.tox
  | \.venv
  | build
  | dist
)/
'''
```

#### **isort** - Organisation des imports

```bash
# Installer isort
pip install isort

# Organiser les imports
isort mailopt/ tests/

# Configuration dans pyproject.toml
[tool.isort]
profile = "black"
multi_line_output = 3
line_length = 88
```

### Linters et analyseurs

#### **Flake8** - Linter PEP8

```bash
# Installer Flake8
pip install flake8

# Linter le code
flake8 mailopt/ tests/

# Configuration dans .flake8
[flake8]
max-line-length = 88
extend-ignore = E203, W503
exclude = .git,__pycache__,build,dist,*.egg-info
```

#### **Pylint** - Analyseur statique avanc√©

```bash
# Installer Pylint
pip install pylint

# Analyser le code
pylint mailopt/

# G√©n√©rer un rapport
pylint mailopt/ --output-format=json > pylint-report.json

# Configuration dans .pylintrc
[MASTER]
disable=
    C0114, # missing-module-docstring
    C0115, # missing-class-docstring
    C0116  # missing-function-docstring
```

#### **MyPy** - V√©rificateur de types statiques

```bash
# Installer MyPy
pip install mypy

# V√©rifier les types
mypy mailopt/ --ignore-missing-imports

# Configuration dans pyproject.toml
[tool.mypy]
python_version = "3.10"
warn_return_any = true
warn_unused_configs = true
disallow_untyped_defs = true
```

### Tests et couverture

#### **Pytest** - Framework de tests

```bash
# Installer Pytest
pip install pytest pytest-cov pytest-mock

# Lancer les tests
pytest tests/ -v

# Avec couverture
pytest --cov=mailopt --cov-report=html tests/

# Tests en parall√®le
pytest -n auto tests/

# Configuration dans pytest.ini
[tool:pytest]
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
addopts = -v --tb=short --strict-markers
markers =
    slow: marks tests as slow
    integration: marks tests as integration tests
```

#### **Coverage.py** - Mesure de couverture

```bash
# Installer Coverage
pip install coverage

# Mesurer la couverture
coverage run -m pytest tests/
coverage report
coverage html  # G√©n√®re un rapport HTML

# Configuration dans .coveragerc
[run]
source = mailopt
omit =
    */tests/*
    */venv/*
    setup.py
```

### Outils de build et publication

#### **Build** - Construction de packages

```bash
# Installer Build
pip install build

# Construire le package
python -m build

# V√©rifier le package
twine check dist/*
```

#### **Twine** - Publication sur PyPI

```bash
# Installer Twine
pip install twine

# Publier sur TestPyPI
twine upload --repository testpypi dist/*

# Publier sur PyPI
twine upload dist/*
```

### Outils de s√©curit√©

#### **Bandit** - D√©tection de vuln√©rabilit√©s

```bash
# Installer Bandit
pip install bandit

# Analyser la s√©curit√©
bandit -r mailopt/

# Configuration dans .bandit
[bandit]
exclude_dirs = tests
skips = B101, B601
```

#### **Safety** - V√©rification des d√©pendances

```bash
# Installer Safety
pip install safety

# V√©rifier les vuln√©rabilit√©s (commande d√©pr√©ci√©e)
safety check

# V√©rifier avec la nouvelle commande (recommand√©)
# Note: N√©cessite un compte Safety CLI (gratuit)
safety scan

# Premi√®re utilisation: Safety demandera de cr√©er un compte
# Suivez les instructions pour vous enregistrer
```

### Workflow complet de d√©veloppement

#### **Script de pr√©-commit**

```bash
#!/bin/bash
# .git/hooks/pre-commit

echo "üîç V√©rification du code..."

# Formater le code
black mailopt/ tests/
isort mailopt/ tests/

# Linter
flake8 mailopt/ tests/
pylint mailopt/ --score=8.0

# V√©rifier les types
mypy mailopt/ --ignore-missing-imports

# Tests rapides
pytest tests/ -x --tb=short

echo "‚úÖ Pr√©-commit termin√© avec succ√®s!"
```

#### **Script de CI complet**

```bash
#!/bin/bash
# scripts/ci.sh

set -e

echo "üöÄ D√©marrage du CI..."

# Installer les d√©pendances
pip install -e ".[dev,test]"

# Formater et v√©rifier
black --check mailopt/ tests/
isort --check-only mailopt/ tests/

# Linter
flake8 mailopt/ tests/
pylint mailopt/ --score=8.0

# V√©rifier les types
mypy mailopt/ --ignore-missing-imports

# Tests avec couverture
pytest --cov=mailopt --cov-report=xml tests/

# S√©curit√©
bandit -r mailopt/
safety check

# Build
python -m build
twine check dist/*

echo "‚úÖ CI termin√© avec succ√®s!"
```

### Configuration des outils

#### **pyproject.toml** - Configuration centralis√©e

```toml
[build-system]
requires = ["setuptools>=45", "wheel"]
build-backend = "setuptools.build_meta"

[tool.black]
line-length = 88
target-version = ['py310']

[tool.isort]
profile = "black"
line_length = 88

[tool.mypy]
python_version = "3.10"
warn_return_any = true
disallow_untyped_defs = true

[tool.pytest.ini_options]
testpaths = ["tests"]
python_files = ["test_*.py"]
addopts = "-v --tb=short"
markers = [
    "slow: marks tests as slow",
    "integration: marks tests as integration tests",
]
```

#### **.pre-commit-config.yaml** - Hooks automatiques

```yaml
repos:
  - repo: https://github.com/psf/black
    rev: 23.3.0
    hooks:
      - id: black
        language_version: python3.10

  - repo: https://github.com/pycqa/isort
    rev: 5.12.0
    hooks:
      - id: isort

  - repo: https://github.com/pycqa/flake8
    rev: 6.0.0
    hooks:
      - id: flake8

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.3.0
    hooks:
      - id: mypy
        additional_dependencies: [types-requests]
```

## CI/CD

### Workflow GitHub Actions

```yaml
# .github/workflows/ci.yml
name: CI

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: [3.10, 3.11, 3.12]

    steps:
      - uses: actions/checkout@v3
      - name: Set up Python ${{ matrix.python-version }}
        uses: actions/setup-python@v4
        with:
          python-version: ${{ matrix.python-version }}
      - name: Install dependencies
        run: |
          pip install -e .
          pip install pytest pytest-cov flake8 pylint
      - name: Run tests
        run: pytest --cov=mailopt tests/
      - name: Run linter
        run: |
          flake8 mailopt/ tests/
          pylint mailopt/
```

### Pr√©-commit hook

```bash
#!/bin/bash
# .git/hooks/pre-commit

# V√©rifier les noms de fichiers
mailopt lint-names . --fix

# Trouver les fichiers orphelins
mailopt find-orphans ./assets --dry-run

# Tests rapides
pytest tests/ -x
```

## Workflow Git & Contribuer

### Branche feature

```bash
# Cr√©er une branche feature
git checkout -b feat/amazing-feature

# Commits atomiques
git commit -m "feat: add amazing feature"
git commit -m "test: add tests for amazing feature"
git commit -m "docs: update documentation for amazing feature"
```

### Mod√®le de message de commit (Conventional Commits)

```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

**Types :**

- `feat` : Nouvelle fonctionnalit√©
- `fix` : Correction de bug
- `docs` : Documentation
- `style` : Formatage
- `refactor` : Refactoring
- `test` : Tests
- `chore` : Maintenance

**Exemples :**

```bash
git commit -m "feat(inline): add CSS minification option"
git commit -m "fix(check-images): handle case-sensitive file systems"
git commit -m "docs: update installation instructions"
```

## Roadmap & Perspectives

### Fonctionnalit√©s √† venir

- **Int√©gration Litmus avanc√©e** : Tests automatis√©s sur tous les clients email
- **Merge-tags avanc√©** : Support de templates complexes et conditions
- **API REST** : Interface web pour les √©quipes non-techniques
- **Int√©gration CI/CD** : Plugins pour GitHub Actions, GitLab CI
- **Support multi-langues** : Interface en fran√ßais, anglais, espagnol
- **Mode watch** : Surveillance en temps r√©el des fichiers
- **Rapports avanc√©s** : Graphiques et m√©triques d√©taill√©es

### Appel √† contributions

Bien que le projet soit actuellement maintenu par un seul d√©veloppeur, nous encourageons les contributions de la communaut√© email development. Les domaines prioritaires :

- Tests de compatibilit√© email
- Optimisation d'images
- Accessibilit√©
- Documentation
- Int√©grations tierces

## Licence

Ce projet est sous licence MIT - voir le fichier [LICENSE](LICENSE) pour les d√©tails.

**MIT License** - Licence permissive permettant :

- Usage commercial
- Modification
- Distribution
- Usage priv√©

Avec protection de responsabilit√© pour les auteurs.

## Contacts & Liens

### Issues & Discussions

- **Issues** : [GitHub Issues](https://github.com/your-username/mailopt/issues)
- **Discussions** : [GitHub Discussions](https://github.com/your-username/mailopt/discussions)
- **Wiki** : [Documentation d√©taill√©e](https://github.com/your-username/mailopt/wiki)

### Mainteneurs

- **D√©veloppeur principal** : [@your-username](https://github.com/your-username)

### Liens utiles

- **PyPI** : [pypi.org/project/mailopt](https://pypi.org/project/mailopt/)
- **Documentation** : [mailopt.readthedocs.io](https://mailopt.readthedocs.io/)
- **Changelog** : [CHANGELOG.md](CHANGELOG.md)

---

**Fait avec ‚ù§Ô∏è pour la communaut√© email development**
